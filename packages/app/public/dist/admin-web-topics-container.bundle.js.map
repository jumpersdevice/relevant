{"version":3,"sources":["webpack:///./src/modules/tag/tag.actions.js","webpack:///./src/modules/admin/web/topics.container.js"],"names":["styles","Alert","alert","reqOptions","a","storage","getToken","tk","credentials","headers","Accept","Authorization","setDiscoverTags","data","type","types","payload","selectTag","tag","deselectTag","updateParentTag","setParentTags","getDiscoverTags","dispatch","fetch","process","API_SERVER","method","then","api","handleErrors","response","json","responseJSON","catch","err","message","searchTags","error","createTag","body","JSON","stringify","status","updateTag","getParentTags","TopicsAdmin","props","state","topic","emoji","handleChange","bind","this","actions","event","setState","target","name","value","e","active","main","split","filter","t","children","_id","categoryName","category","tags","parentTags","style","topicsContainerStyle","placeholder","onChange","onClick","newTag","map","newId","join","textDecoration","key","count","archiveTag","saveTag","Component","PropTypes","object","array","display","flexDirection","alignItems","connect","auth","bindActionCreators","tagActions"],"mappings":"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","file":"admin-web-topics-container.bundle.js","sourcesContent":["import * as types from 'core/actionTypes';\nimport { storage, api, alert } from 'app/utils';\n\nconst Alert = alert.Alert();\n\nconst reqOptions = async () => {\n  const tk = await storage.getToken();\n  return {\n    credentials: 'include',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${tk}`\n    }\n  };\n};\n\nexport function setDiscoverTags(data) {\n  return {\n    type: types.SET_DISCOVER_TAGS,\n    payload: data\n  };\n}\n\nexport function selectTag(tag) {\n  return {\n    type: 'SELECT_TAG',\n    payload: tag\n  };\n}\n\nexport function deselectTag(tag) {\n  return {\n    type: 'DESELECT_TAG',\n    payload: tag\n  };\n}\n\nexport function updateParentTag(tag) {\n  return {\n    type: types.UPDATE_PARENT_TAG,\n    payload: tag\n  };\n}\n\nexport function setParentTags(data) {\n  return {\n    type: types.SET_PARENT_TAGS,\n    payload: data\n  };\n}\n\nexport function getDiscoverTags() {\n  return dispatch => {\n    fetch(process.env.API_SERVER + '/api/tag?sort=count', {\n      credentials: 'include',\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n      .then(api.handleErrors)\n      .then(response => response.json())\n      .then(responseJSON => {\n        dispatch(setDiscoverTags(responseJSON));\n      })\n      .catch(err => Alert('Error getting tags ' + err.message));\n  };\n}\n\nexport function searchTags(tag) {\n  return dispatch => {\n    if (!tag || tag === '') {\n      return dispatch(setDiscoverTags([]));\n    }\n    return fetch(process.env.API_SERVER + '/api/tag/search/' + tag, {\n      credentials: 'include',\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n      .then(response => response.json())\n      .then(responseJSON => {\n        dispatch(setDiscoverTags(responseJSON));\n      })\n      .catch(error => {\n        Alert('Search error ', error);\n      });\n  };\n}\n\nexport function createTag(tag) {\n  return async dispatch =>\n    fetch(process.env.API_SERVER + '/api/tag', {\n      ...(await reqOptions()),\n      method: 'POST',\n      body: JSON.stringify(tag)\n    })\n      .then(response => response.json())\n      .then(responseJSON => {\n        dispatch(setParentTags([responseJSON]));\n      })\n      .catch(error => {\n        Alert('error creating tag ' + error);\n        return { status: false, data: error };\n      });\n}\n\nexport function updateTag(tag) {\n  return async dispatch =>\n    fetch(process.env.API_SERVER + '/api/tag/categories', {\n      ...(await reqOptions()),\n      method: 'PUT',\n      body: JSON.stringify(tag)\n    })\n      .then(response => response.json())\n      .then(responseJSON => {\n        dispatch(updateParentTag(responseJSON));\n      });\n}\n\nexport function getParentTags() {\n  return async dispatch => {\n    fetch(process.env.API_SERVER + '/api/tag/categories?active', {\n      method: 'GET',\n      ...(await reqOptions())\n    })\n      .then(response => response.json())\n      .then(responseJSON => {\n        dispatch(setParentTags(responseJSON));\n      })\n      .catch(error => Alert('parents error', error));\n  };\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport * as tagActions from 'modules/tag/tag.actions';\n\n// import styled from 'styled-components';\n\nlet styles;\n\nclass TopicsAdmin extends Component {\n  static propTypes = {\n    actions: PropTypes.object,\n    tags: PropTypes.array\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      topic: '',\n      emoji: ''\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.updateTag = this.updateTag.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.actions.getParentTags();\n  }\n\n  handleChange(event) {\n    this.setState({ [event.target.name]: event.target.value });\n  }\n\n  updateTag(e, tag) {\n    tag[e.target.name] = e.target.value;\n    this.props.actions.updateParentTag(tag);\n  }\n\n  archiveTag(tag) {\n    tag.active = !tag.active;\n    this.props.actions.updateTag(tag);\n  }\n\n  saveTag(tag) {\n    tag.main = tag.main.split(', ').filter(t => t !== '');\n    tag.children = tag.children.split(', ').filter(t => t !== '');\n    this.props.actions.updateTag(tag);\n  }\n\n  newTag() {\n    const tag = {\n      _id: this.state.topic + '_category_tag',\n      categoryName: this.state.topic,\n      category: true,\n      emoji: this.state.emoji\n    };\n    this.props.actions.createTag(tag);\n  }\n\n  render() {\n    let tags = this.props.tags.parentTags || [];\n    tags = [...tags.filter(tag => tag.active), ...tags.filter(tag => !tag.active)];\n\n    return (\n      <div style={styles.topicsContainerStyle}>\n        <input\n          type={'text'}\n          name={'topic'}\n          placeholder={'topic'}\n          value={this.state.topic}\n          onChange={this.handleChange}\n        />\n        <input\n          type={'text'}\n          name={'emoji'}\n          placeholder={'emoji'}\n          value={this.state.emoji}\n          onChange={this.handleChange}\n        />\n        <button onClick={() => this.newTag()}>Add new category</button>\n        {tags.map(tag => {\n          if (!tag.newId) tag.newId = tag._id;\n          if (tag.main && typeof tag.main !== 'string') {\n            tag.main = tag.main.join(', ');\n          }\n          if (tag.children && typeof tag.children !== 'string') {\n            tag.children = tag.children.join(', ');\n          }\n          return (\n            <div\n              style={tag.active ? null : { textDecoration: 'line-through' }}\n              key={tag._id}\n            >\n              {tag.emoji}\n              &nbsp;\n              <input\n                type={'text'}\n                name={'categoryName'}\n                placeholder={'topic'}\n                value={tag.categoryName}\n                onChange={e => this.updateTag(e, tag)}\n              />\n              <input\n                type={'text'}\n                name={'newId'}\n                placeholder={'_id'}\n                value={tag.newId}\n                onChange={e => this.updateTag(e, tag)}\n              />\n              <input\n                type={'text'}\n                name={'main'}\n                placeholder={'main'}\n                value={tag.main}\n                onChange={e => this.updateTag(e, tag)}\n              />\n              <input\n                type={'text'}\n                name={'children'}\n                placeholder={'children'}\n                value={tag.children}\n                onChange={e => this.updateTag(e, tag)}\n              />\n              &nbsp;\n              {tag.count}\n              &nbsp;\n              <button onClick={() => this.archiveTag(tag)}>remove</button>\n              <button onClick={() => this.saveTag(tag)}>save</button>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\n// const TopicsContainer = styled.div`\n//   display: flex;\n//   flex-direction: column;\n//   alignItems: center;\n// `;\n\nstyles = {\n  topicsContainerStyle: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center'\n  }\n};\n\nexport default connect(\n  state => ({\n    auth: state.auth,\n    tags: state.tags\n  }),\n  dispatch => ({\n    actions: bindActionCreators(tagActions, dispatch)\n  })\n)(TopicsAdmin);\n"],"sourceRoot":""}