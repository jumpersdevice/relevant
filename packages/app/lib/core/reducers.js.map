{"version":3,"sources":["../../src/core/reducers.js"],"names":["communityState","reducers","auth","posts","user","socket","form","formReducer","notif","error","animation","investments","invest","stats","comments","comment","navigation","createPost","tags","tooltip","subscriptions","admin","community","earnings","createReducer","asyncReducers","appReducer","injectReducer","store","name","asyncReducer","replaceReducer","initialState","rootReducer","state","action","type","payload","cachedCommunityState","authUser","users","_id","newState"],"mappings":"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","sourcesContent":["import { combineReducers } from 'redux';\nimport notif from 'modules/activity/activity.reducer';\nimport animation from 'modules/animation/animation.reducer';\nimport auth from 'modules/auth/auth.reducer';\nimport admin from 'modules/admin/admin.reducer';\nimport community from 'modules/community/community.reducer';\nimport createPost from 'modules/createPost/createPost.reducer';\nimport posts from 'modules/post/post.reducer';\nimport user from 'modules/user/user.reducer';\nimport invest from 'modules/post/invest.reducer';\nimport comment from 'modules/comment/comment.reducer';\nimport tags from 'modules/tag/tag.reducer';\nimport stats from 'modules/stats/stats.reducer';\nimport tooltip from 'modules/tooltip/tooltip.reducer';\nimport error from 'modules/ui/error.reducer';\nimport earnings from 'modules/wallet/earnings.reducer';\nimport navigation from 'modules/navigation/navigation.reducer';\nimport { reducer as formReducer } from 'redux-form';\nimport socket from './socket.reducer';\nimport subscriptions from './subscriptions.reducer';\n\nlet communityState = {};\n\nconst reducers = {\n  auth,\n  posts,\n  user,\n  socket,\n  form: formReducer,\n  notif,\n  error,\n  animation,\n  // TODO update\n  investments: invest,\n  stats,\n  // TODO update\n  comments: comment,\n  navigation,\n  createPost,\n  tags,\n  tooltip,\n  subscriptions,\n  admin,\n  community,\n  earnings\n};\n\nconst createReducer = (asyncReducers = {}) =>\n  combineReducers({ ...reducers, ...asyncReducers });\n\nlet appReducer = createReducer();\n\nexport function injectReducer(store, name, asyncReducer) {\n  if (store.asyncReducers[name]) {\n    return;\n  }\n  store.asyncReducers[name] = asyncReducer;\n  appReducer = createReducer(store.asyncReducers);\n  store.replaceReducer(appReducer);\n}\n\nconst initialState = {\n  posts: appReducer.posts,\n  user: appReducer.user,\n  stats: appReducer.stats\n};\n\n// Purpose of this reducer is to swap out community state\n// we swap out posts, user data and stats\nconst rootReducer = (state, action) => {\n  if (action.type === 'SET_COMMUNITY') {\n    const { community } = state.auth; // eslint-disable-line\n\n    if (community === action.payload) return appReducer(state, action);\n\n    const { posts, user, stats, earnings } = state; // eslint-disable-line\n    if (community) {\n      communityState = {\n        ...communityState,\n        [community]: {\n          posts,\n          user,\n          stats,\n          earnings\n        }\n      };\n    }\n\n    const cachedCommunityState = communityState[action.payload] || initialState;\n    const authUser =\n      (state.auth.user &&\n        cachedCommunityState.user &&\n        cachedCommunityState.user.users[state.auth.user._id] &&\n        cachedCommunityState.user.users[state.auth.user._id]) ||\n      state.auth.user;\n\n    const newState = {\n      ...state,\n      ...cachedCommunityState,\n      auth: { ...state.auth, community: action.payload, user: authUser }\n    };\n\n    return appReducer(newState, action);\n  }\n  return appReducer(state, action);\n};\n\nexport default rootReducer;\n"],"file":"reducers.js"}