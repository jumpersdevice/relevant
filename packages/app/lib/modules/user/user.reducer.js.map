{"version":3,"sources":["../../../src/modules/user/user.reducer.js"],"names":["initialState","error","users","handleToId","list","listByTopic","online","loading","garbage","search","auth","state","action","type","types","SET_USER_SEARCH","payload","length","SET_USERS","Object","keys","forEach","id","handle","_id","topic","currentList","slice","index","UPDATE_USER","relevance","pagerank","undefined"],"mappings":"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","sourcesContent":["import * as types from 'core/actionTypes';\n\nconst initialState = {\n  error: false,\n  users: {},\n  handleToId: {},\n  list: [],\n  listByTopic: {},\n  online: [],\n  loading: false,\n  garbage: [],\n  search: []\n};\n\nexport default function auth(state = initialState, action) {\n  switch (action.type) {\n    case types.SET_USER_SEARCH: {\n      return {\n        ...state,\n        search: action.payload.length ? action.payload : initialState.search\n      };\n    }\n\n    case types.SET_USERS: {\n      const users = {};\n      const handleToId = {};\n      if (!action.payload) return state;\n      Object.keys(action.payload).forEach(id => {\n        handleToId[action.payload[id].handle] = id;\n        users[id] = { ...state.users[id], ...action.payload[id] };\n      });\n      return {\n        ...state,\n        handleToId: {\n          ...state.handleToId,\n          ...handleToId\n        },\n        users: {\n          ...state.users,\n          ...users\n        }\n      };\n    }\n\n    case 'SET_SELECTED_USER_DATA': {\n      return {\n        ...state,\n        handleToId: {\n          ...state.handleToId,\n          [action.payload.handle]: action.payload._id\n        },\n        users: {\n          ...state.users,\n          [action.payload._id]: {\n            ...state.users[action.payload._id],\n            ...action.payload\n          }\n        }\n      };\n    }\n\n    case 'GET_USER_LIST': {\n      return { ...state, loading: true };\n    }\n\n    case 'SET_USER_LIST': {\n      const topic = action.payload.topic || 'all';\n      const currentList = state.list[topic] || [];\n      return {\n        ...state,\n        list: {\n          ...state.list,\n          [topic]: [\n            ...currentList.slice(0, action.payload.index),\n            ...action.payload.users\n          ]\n        },\n        loading: false\n      };\n    }\n\n    case types.UPDATE_USER: {\n      const id = action.payload._id;\n      // prevents legacy relevance field overwrites\n      // TODO should normalize this and store separately\n      let { relevance } = action.payload;\n      if ((!relevance || relevance.pagerank === undefined) && state.users[id]) {\n        relevance = state.users[id].relevance;\n      }\n      return {\n        ...state,\n        handleToId: {\n          ...state.handleToId,\n          [action.payload.handle]: action.payload._id\n        },\n        users: {\n          ...state.users,\n          [action.payload._id]: {\n            ...state.users[action.payload._id],\n            ...action.payload,\n            relevance\n          }\n        }\n      };\n    }\n\n    case 'CLEAR_USER_LIST': {\n      return { ...state, list: [] };\n    }\n\n    // case types.LOGOUT_USER: {\n    //   return { ...initialState };\n    // }\n\n    default:\n      return state;\n  }\n}\n"],"file":"user.reducer.js"}