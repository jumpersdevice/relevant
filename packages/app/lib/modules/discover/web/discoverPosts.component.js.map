{"version":3,"sources":["../../../../src/modules/discover/web/discoverPosts.component.js"],"names":["DiscoverPosts","props","load","bind","hasMore","sort","tag","data","posts","feed","topics","page","length","pageSize","map","id","post","repost","postIds","link","links","metaPost","commentId","comment","getData","renderDiscover","position","auth","community","p","Component","PropTypes","object","number","func","string"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport InfScroll from 'modules/listview/web/infScroll.component';\nimport PostComponent from 'modules/post/web/post.component';\nimport get from 'lodash/get';\n\nclass DiscoverPosts extends Component {\n  static propTypes = {\n    posts: PropTypes.object,\n    pageSize: PropTypes.number,\n    load: PropTypes.func,\n    sort: PropTypes.string,\n    tag: PropTypes.string,\n    auth: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.load = this.load.bind(this);\n    this.hasMore = true;\n  }\n\n  getData(sort, tag) {\n    let data;\n    if (sort === 'feed') {\n      data = this.props.posts.feed;\n    } else {\n      data = tag ? this.props.posts.topics[sort][tag] : this.props.posts[sort];\n    }\n    return data || [];\n  }\n\n  load(page, length) {\n    this.hasMore = page * this.props.pageSize <= length;\n    if (this.hasMore) {\n      this.props.load(null, null, length);\n    }\n  }\n\n  renderFeed() {\n    return this.props.posts.feed.map(id => {\n      const post = this.props.posts.posts[id];\n      const repost = post.repost ? this.props.posts.posts[post.repost.post] : null;\n\n      return <Post key={id} post={post} repost={repost} />;\n    });\n  }\n\n  renderDiscover(sort, tag) {\n    const postIds = tag ? this.props.posts.topics[sort][tag] : this.props.posts[sort];\n    const { posts } = this.props.posts;\n\n    return (postIds || []).map(id => {\n      const post = posts[id];\n      if (!post) return null;\n\n      const link = this.props.posts.links[post.metaPost];\n      const commentId = get(post, `${sort}.0`);\n      const comment = posts[commentId];\n\n      const repost = post.repost ? this.props.posts.posts[post.repost.post] : null;\n\n      return (\n        <PostComponent\n          key={id}\n          post={post}\n          link={link}\n          repost={repost}\n          comment={comment}\n        />\n      );\n    });\n  }\n\n  render() {\n    const { sort, tag } = this.props;\n\n    const data = this.getData(sort, tag);\n    const posts = this.renderDiscover(sort, tag);\n\n    const { length } = posts;\n    // const newPosts = this.props.posts.newPostsAvailable[auth.community];\n    // const refreshPosts = (\n    //   <a onClick={() => this.props.actions.refreshTab('discover')}>\n    //     <LinkFont ml={4} c={colors.blue}>See New Posts</LinkFont>\n    //   </a>\n    // );\n    // {newPosts ? refreshPosts : null}\n\n    return (\n      <div style={{ position: 'relative' }}>\n        <InfScroll\n          // this resets the inf scroll with community\n          key={this.props.auth.community}\n          className={'parent'}\n          data={data}\n          loadMore={p => this.load(p, length)}\n          hasMore={this.hasMore}\n          style={{ position: 'relative' }}\n        >\n          {posts}\n        </InfScroll>\n      </div>\n    );\n  }\n}\n\nexport default DiscoverPosts;\n"],"file":"discoverPosts.component.js"}