{"version":3,"sources":["../../../../src/modules/web_about/countUp/countUp.coin.component.js"],"names":["BOX_HEIGHT","randrange","a","Math","floor","random","marqueeCoin","active","firingRate","parallax","speed","marqueeOff","BetResult","Text","BetWin","p","show","BetLoose","CountUpCoin","mode","animationState","headline","score","highIndex","lowIndex","marquee","thumbTiming","delay","duration","width","global","window","innerWidth","height","postRank","clearTimeout","timeout","removeEventListener","advance","addEventListener","props","high","low","state","length","setState","setTimeout","pause","tween","reset","color","outcome","handleMeasurement","handleCoinFinished","handleHeadlineFinished","handleTimerFinished","Component","PropTypes","array","string"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { tween } from 'app/utils';\nimport styled from 'styled-components';\nimport { Text, BodyText } from 'modules/styled/web';\nimport { size } from 'app/styles';\n\nimport { CountUpContainer, CountUpSpacer } from './countUp.styles';\n\nimport CountUpBox from './countUp.box';\nimport CountUpMarquee from './countUp.animatedEl';\nimport { ArrowTimer } from './countUp.images';\n\nconst BOX_HEIGHT = 26;\n\nconst randrange = a => Math.floor(Math.random() * (a[1] - a[0]) + a[0]);\n\nconst marqueeCoin = {\n  active: true,\n  firingRate: 2000,\n  parallax: 1,\n  speed: 4.5\n};\n\nconst marqueeOff = {\n  active: false,\n  firingRate: 0,\n  parallax: 0,\n  speed: 0\n};\n\nconst BetResult = styled(Text)`\n  position: absolute;\n  width: ${() => size([25, 20])};\n  height: ${() => size([25, 20])};\n  background-size: contain;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  z-index: 1;\n  opacity: 1;\n`;\n\nconst BetWin = styled(BetResult)`\n  top: ${() => size([-7.5, -8])};\n  right: ${() => size([-12, -3])};\n  background-image: url(/img/betWin.png);\n  transform: rotate(0deg) scale(0);\n  ${p =>\n    p.show\n      ? `\n    transition: all .3s cubic-bezier(.83,.42,0,1.24);\n    transform:  rotate(23deg) scale(1);\n    `\n      : ''}\n`;\nconst BetLoose = styled(BetResult)`\n  bottom: -60px;\n  right: -20px;\n  background-image: url(/img/betLoose.png);\n  transform: rotate(0deg) scale(0);\n  ${p =>\n    p.show\n      ? `\n    transition: all .5s cubic-bezier(.83,.42,0,1.24);\n    transform: rotate(-15deg) scale(1);\n    `\n      : ''}\n`;\n\nexport default class CountUpCoin extends Component {\n  state = {\n    mode: false,\n    animationState: 0,\n    headline: '',\n    score: 0,\n    highIndex: -1,\n    lowIndex: -1,\n    marquee: { ...marqueeOff },\n    thumbTiming: { delay: 10, duration: 3000 },\n    width: global.window ? window.innerWidth / 3 : 0,\n    height: 212,\n    postRank: 0\n  };\n\n  static propTypes = {\n    high: PropTypes.array,\n    low: PropTypes.array,\n    color: PropTypes.string\n  };\n\n  componentDidMount() {\n    window.addEventListener('blur', this.pause);\n  }\n\n  pause = () => {\n    clearTimeout(this.timeout);\n    window.removeEventListener('focus', this.advance);\n    window.addEventListener('focus', this.advance);\n  };\n\n  advance = () => {\n    const { high, low } = this.props;\n    let { mode, highIndex, lowIndex, postRank } = this.state;\n    let headline;\n    mode = !mode;\n    if (mode) {\n      highIndex += 1;\n      headline = high[highIndex % high.length];\n      postRank = randrange([50, 100]);\n    } else {\n      lowIndex += 1;\n      headline = low[lowIndex % low.length];\n      postRank = randrange([-100, -50]);\n    }\n\n    this.setState({\n      mode,\n      headline,\n      highIndex,\n      lowIndex,\n      animationState: 0,\n      postRank\n    });\n  };\n\n  // window measurement triggers the animation\n  handleMeasurement = (width, height) => {\n    this.setState({ width, height }, () => this.advance());\n  };\n\n  // headline animates first, triggering the coin\n  handleHeadlineFinished = () => {\n    if (this.state.animationState !== 0) return;\n    clearTimeout(this.timeout);\n    this.setState({ marquee: marqueeCoin, score: this.state.score + 1 });\n  };\n\n  // when coin finishes, increment the score which triggers the timer\n  handleCoinFinished = () => {\n    this.setState({ marquee: marqueeOff });\n  };\n\n  // when the timer is finished, display the funky message!!\n  handleTimerFinished = () => {\n    this.setState({ animationState: 1 });\n    this.timeout = setTimeout(() => {\n      this.advance();\n    }, 3000);\n  };\n\n  componentWillUnmount() {\n    window.removeEventListener('blur', this.pause);\n    window.removeEventListener('focus', this.advance);\n    clearTimeout(this.timeout);\n    tween.reset();\n  }\n\n  render() {\n    const { color } = this.props;\n    const {\n      mode,\n      headline,\n      score,\n      marquee,\n      thumbTiming,\n      animationState,\n      postRank\n    } = this.state;\n    const outcome = animationState === 1 && (mode ? 'win' : 'loose');\n\n    return (\n      <CountUpContainer>\n        <CountUpMarquee\n          height={BOX_HEIGHT}\n          type={'coin'}\n          score={score}\n          onMeasure={this.handleMeasurement}\n          onFinished={this.handleCoinFinished}\n          {...marquee}\n        />\n        <CountUpBox\n          height={BOX_HEIGHT}\n          type={'coin'}\n          color={color}\n          headline={headline}\n          onHeadlineFinished={this.handleHeadlineFinished}\n        >\n          <ArrowTimer\n            showRank={animationState === 1}\n            score={score}\n            postRank={postRank}\n            {...thumbTiming}\n            onTimerFinished={this.handleTimerFinished}\n          />\n\n          <BetWin show={outcome === 'win'}>\n            <BodyText p={4} fs={[3, 2.5]} lh={[4, 3]}>\n              YOU WIN!\n            </BodyText>\n          </BetWin>\n          <BetLoose show={outcome === 'loose'}>\n            <BodyText p={7} fs={[3, 2.5]} lh={[4, 3]}>\n              NOT A GREAT BET :(\n            </BodyText>\n          </BetLoose>\n        </CountUpBox>\n        <CountUpSpacer flex={[1, null]} w={['auto', 2]} />\n      </CountUpContainer>\n    );\n  }\n}\n"],"file":"countUp.coin.component.js"}