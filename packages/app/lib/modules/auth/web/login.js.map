{"version":3,"sources":["../../../../src/modules/auth/web/login.js"],"names":["twitterIcon","require","LoginForm","data","user","name","username","password","props","actions","loginUser","loggedIn","close","location","handleSubmit","invitecode","auth","local","length","queryString","parse","search","redirect","pathname","FORM_FIELDS","label","component","ReduxFormField","autocomplete","type","validate","required","socialSignup","showModal","login","map","field","colors","blue","submit","twitterBlue","white","Component","PropTypes","object","func","string","selector","mapStateToProps","state","initialValues","enableReinitialize","mapDispatchToProps","dispatch","form"],"mappings":"0qCAAA,qDACA,6DACA,qCACA,qCACA,4BACA,uCACA,uCACA,+EACA,iEACA,qCACA,gDACA,+DACA,kGACA,qCACA,iDACA,2D,ulDAEA,GAAMA,CAAAA,WAAW,CAAGC,OAAO,kDAA3B,C,GAGMC,CAAAA,S,2eAWI,iBAAMC,IAAN,qJAEEC,IAFF,CAES,CACXC,IAAI,CAAEF,IAAI,CAACG,QADA,CAEXC,QAAQ,CAAEJ,IAAI,CAACI,QAFJ,CAFT,uBAMmB,OAAKC,KAAL,CAAWC,OAAX,CAAmBC,SAAnB,CAA6BN,IAA7B,CANnB,QAMEO,QANF,eAOJ,GAAIA,QAAJ,CAAc,CACZ,MAAKH,KAAL,CAAWI,KAAX,GACD,CATG,mJ,wJAeC,iCACgD,KAAKJ,KADrD,CACCK,QADD,aACCA,QADD,CACWC,YADX,aACWA,YADX,CACyBR,QADzB,aACyBA,QADzB,CACmCC,QADnC,aACmCA,QADnC,IAECQ,CAAAA,UAFD,CAEgB,KAAKP,KAAL,CAAWQ,IAF3B,CAECD,UAFD,CAGP,GAAME,CAAAA,KAAK,CAAGX,QAAQ,EAAIA,QAAQ,CAACY,MAArB,EAA+BX,QAA/B,EAA2CA,QAAQ,CAACW,MAAlE,CAHO,uBAIYC,qBAAYC,KAAZ,CAAkBP,QAAQ,CAACQ,MAA3B,CAJZ,CAIDC,QAJC,oBAIDA,QAJC,CAKP,GAAI,CAACA,QAAL,CAAeA,QAAQ,CAAGT,QAAQ,CAACU,QAApB,CAEf,GAAMC,CAAAA,WAAW,CAAG,CAClB,CACEC,KAAK,CAAE,mBADT,CAEEC,SAAS,CAAEC,uBAFb,CAGEtB,IAAI,CAAE,UAHR,CAIEuB,YAAY,CAAE,UAJhB,CAKEC,IAAI,CAAE,MALR,CAMEC,QAAQ,CAAE,CAACC,oBAAD,CANZ,CADkB,CASlB,CACEF,IAAI,CAAE,UADR,CAEEH,SAAS,CAAEC,uBAFb,CAGEF,KAAK,CAAE,UAHT,CAIEpB,IAAI,CAAE,UAJR,CAKEuB,YAAY,CAAE,kBALhB,CAMEE,QAAQ,CAAE,CAACC,oBAAD,CANZ,CATkB,CAApB,CAmBA,GAAMC,CAAAA,YAAY,CAChB,6BAAC,aAAD,EAAU,MAAM,CAAE,CAAlB,CAAqB,EAAE,CAAE,CAAC,CAAD,CAAI,CAAJ,CAAzB,sFACsB,GADtB,CAEE,kCACE,OAAO,CAAE,kBAAM,CACb,MAAI,CAACxB,KAAL,CAAWC,OAAX,CAAmBwB,SAAnB,CAA6B,cAA7B,EACD,CAHH,0EAFF,CADF,CAaA,MACE,8BAAC,SAAD,EAAM,UAAU,CAAC,QAAjB,CAA0B,QAAQ,CAAEnB,YAAY,CAAC,KAAKoB,KAAN,CAAhD,gEACGV,WAAW,CAACW,GAAZ,CAAgB,SAAAC,KAAK,QACpB,8BAAC,gBAAD,0BAAWA,KAAX,EAAkB,GAAG,CAAEA,KAAK,CAAC/B,IAA7B,kEADoB,EAArB,CADH,CAIE,6BAAC,SAAD,EACE,EAAE,CAAE,CADN,CAEE,OAAO,CAAC,MAFV,CAGE,UAAU,CAAC,QAHb,CAIE,KAAK,CAAC,YAJR,CAKE,OAAO,CAAC,YALV,gEAOE,kCACE,OAAO,CAAE,kBAAM,CACb,MAAI,CAACG,KAAL,CAAWC,OAAX,CAAmBwB,SAAnB,CAA6B,QAA7B,EACD,CAHH,iEAKE,6BAAC,aAAD,EAAU,CAAC,CAAEI,eAAOC,IAApB,0FALF,CAPF,CAcGrB,KAAK,CACJ,6BAAC,SAAD,EAAM,UAAU,CAAC,KAAjB,CAAuB,EAAE,CAAE,CAAC,CAAD,CAAI,CAAJ,CAA3B,CAAmC,KAAK,CAAC,QAAzC,kEACE,6BAAC,WAAD,EAAQ,OAAO,CAAE,KAAKsB,MAAtB,CAA8B,IAAI,CAAC,QAAnC,CAA4C,EAAE,CAAE,CAAC,CAAD,CAAI,CAAJ,CAAhD,CAAwD,UAAU,CAAC,KAAnE,kEACG,GADH,WAEU,GAFV,CADF,CAKGP,YALH,CADI,CAQF,IAtBN,CAJF,CA6BE,6BAAC,SAAD,kEACG,CAACf,KAAD,CACC,6BAAC,SAAD,EACE,UAAU,CAAE,CAAC,KAAD,CAAQ,QAAR,CADd,CAEE,KAAK,CAAE,CAAC,QAAD,CAAW,SAAX,CAFT,CAGE,EAAE,CAAE,CAAC,CAAD,CAAI,CAAJ,CAHN,CAIE,IAAI,CAAE,CAJR,kEAME,6BAAC,cAAD,EACE,EAAE,kCAA4BK,QAA5B,wBAAmDP,UAAnD,CADJ,CAEE,QAAQ,KAFV,CAGE,GAAG,CAAC,UAHN,CAIE,EAAE,CAAE,CAAC,CAAD,CAAI,CAAJ,CAJN,CAKE,EAAE,CAAE,CAAC,CAAD,CAAI,CAAJ,CALN,kEAOE,6BAAC,eAAD,EAAY,IAAI,CAAE,CAAlB,CAAqB,EAAE,CAAEsB,eAAOG,WAAhC,CAA6C,UAAU,CAAC,KAAxD,kEACE,6BAAC,UAAD,EAAO,MAAM,CAAExC,WAAf,CAA4B,CAAC,CAAE,GAA/B,CAAoC,CAAC,CAAE,GAAvC,CAA4C,EAAE,CAAE,GAAhD,kEADF,CAEE,6BAAC,aAAD,EAAU,CAAC,CAAEqC,eAAOI,KAApB,yFAFF,CAPF,CANF,CAkBE,6BAAC,cAAD,EAAU,KAAK,CAAE,KAAKjC,KAAL,CAAWI,KAA5B,kEAlBF,CAmBGoB,YAnBH,CADD,CAsBG,IAvBN,CA7BF,CADF,CAyDD,C,uBA1HqBU,gB,+BAAlBxC,S,aACe,CACjBW,QAAQ,CAAE8B,mBAAUC,MADH,CAEjB5B,IAAI,CAAE2B,mBAAUC,MAFC,CAGjBnC,OAAO,CAAEkC,mBAAUC,MAHF,CAIjBhC,KAAK,CAAE+B,mBAAUE,IAJA,CAKjB/B,YAAY,CAAE6B,mBAAUE,IALP,CAMjBvC,QAAQ,CAAEqC,mBAAUG,MANH,CAOjBvC,QAAQ,CAAEoC,mBAAUG,MAPH,C,EA4HrB,GAAMC,CAAAA,QAAQ,CAAG,iCAAkB,OAAlB,CAAjB,CAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAAC,KAAK,sCAC3B7C,IAAI,CAAE6C,KAAK,CAACjC,IAAN,CAAWZ,IADU,CAE3BY,IAAI,CAAEiC,KAAK,CAACjC,IAFe,EAGxB+B,QAAQ,CAACE,KAAD,CAAQ,UAAR,CAAoB,UAApB,CAHgB,MAI3BC,aAAa,CAAE,EAJY,CAK3BC,kBAAkB,CAAE,IALO,IAA7B,CAQA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAAC,QAAQ,QAAK,CACtC5C,OAAO,CAAE,8BACP,CACEC,SAAS,CAATA,eADF,CAEEuB,SAAS,CAATA,qBAFF,CADO,CAKPoB,QALO,CAD6B,CAAL,EAAnC,C,aAUe,+BACb,wBACEL,eADF,CAEEI,kBAFF,EAIE,yBAAU,CACRE,IAAI,CAAE,OADE,CAAV,EAEGpD,SAFH,CAJF,CADa,C","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { LinkFont, Image, ViewButton } from 'modules/styled/uni';\nimport { Form, View, Button } from 'modules/styled/web';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { colors } from 'app/styles';\nimport ULink from 'modules/navigation/ULink.component';\nimport queryString from 'query-string';\nimport { loginUser } from 'modules/auth/auth.actions';\nimport { withRouter } from 'react-router-dom';\nimport { showModal } from 'modules/navigation/navigation.actions';\nimport ReduxFormField from 'modules/styled/form/reduxformfield.component';\nimport { Field, reduxForm, formValueSelector } from 'redux-form';\nimport { required } from 'modules/form/validators';\nimport BoxLogin from 'modules/auth/web/login.3box';\n\nconst twitterIcon = require('public/img/icons/twitter_white.png');\n// const redditIcon = require('public/img/icons/reddit.png');\n\nclass LoginForm extends Component {\n  static propTypes = {\n    location: PropTypes.object,\n    auth: PropTypes.object,\n    actions: PropTypes.object,\n    close: PropTypes.func,\n    handleSubmit: PropTypes.func,\n    username: PropTypes.string,\n    password: PropTypes.string\n  };\n\n  login = async data => {\n    try {\n      const user = {\n        name: data.username,\n        password: data.password\n      };\n      const loggedIn = await this.props.actions.loginUser(user);\n      if (loggedIn) {\n        this.props.close();\n      }\n    } catch (err) {\n      // TODO error handling\n    }\n  };\n\n  render() {\n    const { location, handleSubmit, username, password } = this.props;\n    const { invitecode } = this.props.auth;\n    const local = username && username.length && password && password.length;\n    let { redirect } = queryString.parse(location.search);\n    if (!redirect) redirect = location.pathname;\n\n    const FORM_FIELDS = [\n      {\n        label: 'Username or email',\n        component: ReduxFormField,\n        name: 'username',\n        autocomplete: 'username',\n        type: 'text',\n        validate: [required]\n      },\n      {\n        type: 'password',\n        component: ReduxFormField,\n        label: 'Password',\n        name: 'password',\n        autocomplete: 'current-password',\n        validate: [required]\n      }\n    ];\n\n    const socialSignup = (\n      <LinkFont shrink={1} mt={[0, 4]}>\n        Not registered yet?{' '}\n        <a\n          onClick={() => {\n            this.props.actions.showModal('signupSocial');\n          }}\n        >\n          Sign up\n        </a>\n      </LinkFont>\n    );\n\n    return (\n      <Form fdirection=\"column\" onSubmit={handleSubmit(this.login)}>\n        {FORM_FIELDS.map(field => (\n          <Field {...field} key={field.name} />\n        ))}\n        <View\n          mt={2}\n          display=\"flex\"\n          fdirection=\"column\"\n          align=\"flex-start\"\n          justify=\"flex-start\"\n        >\n          <a\n            onClick={() => {\n              this.props.actions.showModal('forgot');\n            }}\n          >\n            <LinkFont c={colors.blue}>Forgot Your Password?</LinkFont>\n          </a>\n          {local ? (\n            <View fdirection=\"row\" mt={[4, 2]} align=\"center\">\n              <Button onClick={this.submit} type=\"submit\" mr={[2, 0]} fdirection=\"row\">\n                {' '}\n                Sign In{' '}\n              </Button>\n              {socialSignup}\n            </View>\n          ) : null}\n        </View>\n\n        <View>\n          {!local ? (\n            <View\n              fdirection={['row', 'column']}\n              align={['center', 'stretch']}\n              mt={[4, 2]}\n              flex={1}\n            >\n              <ULink\n                to={`/auth/twitter?redirect=${redirect}&invitecode=${invitecode}`}\n                external\n                rel=\"nofollow\"\n                mr={[2, 0]}\n                mt={[0, 2]}\n              >\n                <ViewButton flex={1} bg={colors.twitterBlue} fdirection=\"row\">\n                  <Image source={twitterIcon} w={2.5} h={2.5} mr={1.5} />\n                  <LinkFont c={colors.white}>Sign In with Twitter</LinkFont>\n                </ViewButton>\n              </ULink>\n              <BoxLogin close={this.props.close} />\n              {socialSignup}\n            </View>\n          ) : null}\n        </View>\n      </Form>\n    );\n  }\n}\n\nconst selector = formValueSelector('login');\n\nconst mapStateToProps = state => ({\n  user: state.auth.user,\n  auth: state.auth,\n  ...selector(state, 'username', 'password'),\n  initialValues: {},\n  enableReinitialize: true\n});\n\nconst mapDispatchToProps = dispatch => ({\n  actions: bindActionCreators(\n    {\n      loginUser,\n      showModal\n    },\n    dispatch\n  )\n});\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(\n    reduxForm({\n      form: 'login'\n    })(LoginForm)\n  )\n);\n"],"file":"login.js"}