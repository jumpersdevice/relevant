{"version":3,"sources":["../../../src/modules/community/communityActive.component.js"],"names":["CommunityActive","propTypes","community","PropTypes","object","children","node","members","array","view","auth","screenSize","number","viewCommunityMembers","func","showSettings","userCommunities","userMemberships","dispatch","length","slug","topics","totalMembers","userId","allMembers","filter","member","embeddedUser","_id","isMember","user","find","unshift","memberShip","m","communityId","isSuperAdmin","superAdmin","limitedMembers","slice","sort","colors","white","SIDE_NAV_PADDING","map","topic","grey","black","description","blue"],"mappings":"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","sourcesContent":["import React, { useEffect, memo } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch } from 'react-redux';\n\nimport get from 'lodash/get';\nimport { colors } from 'app/styles';\nimport ULink from 'modules/navigation/ULink.component';\nimport UAvatar from 'modules/user/UAvatar.component';\nimport { View, CommunityLink, SecondaryText, BodyText, Box } from 'modules/styled/uni';\nimport { Linkify } from 'app/utils/text';\nimport { SIDE_NAV_PADDING } from 'styles/layout';\nimport { goToTopic } from 'modules/navigation/navigation.actions';\nimport { getCommunityMembers } from 'modules/community/community.actions';\n\nCommunityActive.propTypes = {\n  community: PropTypes.object,\n  children: PropTypes.node,\n  members: PropTypes.array,\n  view: PropTypes.object,\n  auth: PropTypes.object,\n  screenSize: PropTypes.number,\n  viewCommunityMembers: PropTypes.func,\n  showSettings: PropTypes.func,\n  userCommunities: PropTypes.array,\n  userMemberships: PropTypes.array\n};\n\nexport default memo(CommunityActive);\n\nfunction CommunityActive({\n  community,\n  children,\n  members,\n  view,\n  screenSize,\n  auth,\n  viewCommunityMembers,\n  userCommunities,\n  showSettings,\n  userMemberships\n}) {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (!members.length) dispatch(getCommunityMembers({ slug: community.slug }));\n  }, []); // eslint-disable-line\n\n  const topics = get(community, 'topics', []);\n  const totalMembers = get(community, 'memberCount', 0);\n  const userId = get(auth, 'user._id', null);\n  const allMembers = members.filter(member => member.embeddedUser._id !== userId);\n  let isMember;\n  if (auth.user) {\n    isMember = userCommunities.find(_id => _id === community._id);\n    if (isMember) {\n      allMembers.unshift({ _id: userId, embeddedUser: auth.user });\n    }\n  }\n  const memberShip = userMemberships.find(m => m.communityId === community._id);\n  const isSuperAdmin =\n    (memberShip && memberShip.superAdmin) || get(auth, 'user.role') === 'admin';\n\n  const limitedMembers = allMembers.slice(0, screenSize ? 14 : 12);\n  const sort = get(view, 'sort') || 'new';\n  return (\n    <View bg={colors.white} mr={'1px'}>\n      <View mt={[SIDE_NAV_PADDING, 2]} />\n      {children}\n      <View bb p={[`0 ${SIDE_NAV_PADDING} 4 ${SIDE_NAV_PADDING}`, '0 2 4 2']}>\n        <View m={'0.5 0 0 5.5'}>\n          {topics.map(topic => (\n            <ULink\n              key={topic}\n              color={colors.grey}\n              hc={colors.black}\n              ac={colors.black}\n              navLink\n              onPress={() => dispatch(goToTopic(topic))}\n              to={`/${community.slug}/${sort}/${topic}`}\n            >\n              <Box mt={0.5} mb={0.5}>\n                <CommunityLink key={topic}>#{topic}</CommunityLink>\n              </Box>\n            </ULink>\n          ))}\n        </View>\n\n        <View mt={[SIDE_NAV_PADDING, 2]}>\n          <BodyText>\n            <Linkify>{community.description}</Linkify>\n          </BodyText>\n        </View>\n\n        <View mt={SIDE_NAV_PADDING} mb={2} fdirection=\"row\" justify=\"space-between\">\n          <CommunityLink c={colors.black}>{`${totalMembers} Members`}</CommunityLink>\n          <ULink\n            inline={1}\n            to=\"#\"\n            onPress={viewCommunityMembers}\n            onClick={viewCommunityMembers}\n          >\n            <CommunityLink c={colors.blue}>See All</CommunityLink>\n          </ULink>\n        </View>\n\n        <View fdirection={'row'} wrap>\n          {limitedMembers.map(member => (\n            <UAvatar key={member._id} user={member.embeddedUser} m={'0 1 1 0'} />\n          ))}\n        </View>\n\n        {isSuperAdmin && (\n          <SecondaryText\n            mt={2}\n            c={colors.blue}\n            onPress={showSettings}\n            key={'settings_'}\n            p={'0.5 0'}\n          >\n            Settings\n          </SecondaryText>\n        )}\n      </View>\n    </View>\n  );\n}\n"],"file":"communityActive.component.js"}