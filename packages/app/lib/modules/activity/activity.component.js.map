{"version":3,"sources":["../../../src/modules/activity/activity.component.js"],"names":["SingleActivity","activity","user","actions","props","totalUsers","s","handle","goToProfile","colors","blue","img","PostComponent","post","parentId","parentPost","_id","link","metaPost","community","data","linkToPost","onPress","goToPost","screenSize","activityHelper","getActivityParams","emoji","image","byUser","amount","numbers","abbreviateNumber","renderIcon","renderName","renderDate","fromNow","getTimestamp","createdAt","type","embeddedUser","singleActivity","renderComment","MAX_POST_WIDTH","renderActivity","renderPostPreview","PureComponent","PropTypes","object","shape","totlaUsers","number","string","text","oneOfType","isRequired"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { numbers } from 'app/utils';\nimport { colors } from 'app/styles';\nimport * as activityHelper from 'modules/activity/activityHelper';\nimport ActivityText from 'modules/activity/activityText.component';\nimport UAvatar from 'modules/user/UAvatar.component';\nimport { View, SecondaryText, BodyText, Image, Divider, Box } from 'modules/styled/uni';\nimport ULink from 'modules/navigation/ULink.component';\nimport { MAX_POST_WIDTH } from 'styles/layout';\n\nexport default class SingleActivity extends PureComponent {\n  static propTypes = {\n    actions: PropTypes.object,\n    singleActivity: PropTypes.shape({\n      totlaUsers: PropTypes.number,\n      amount: PropTypes.number,\n      byUser: PropTypes.object, // TODO create user prop type validation\n      post: PropTypes.object, // TODO create post prop type validation\n      type: PropTypes.string,\n      text: PropTypes.string,\n      createdAt: PropTypes.oneOfType([PropTypes.string, PropTypes.object])\n    }).isRequired,\n    screenSize: PropTypes.number,\n    PostComponent: PropTypes.object\n  };\n\n  renderName(activity, user) {\n    const { actions } = this.props;\n    if (!user && activity.totalUsers) {\n      let s = '';\n      if (activity.totalUsers > 1) s = 's';\n      return (\n        <Box mr={0.75}>\n          {activity.totalUsers} user{s}{' '}\n        </Box>\n      );\n    }\n    if (!user) return null;\n\n    if (user && user.handle && activity.totalUsers - 1) {\n      let s = '';\n      if (activity.totalUsers - 1 > 1) s = 's';\n      return (\n        <Box mr={0.75}>\n          <ULink\n            inline={1}\n            onPress={() => actions.goToProfile(user)}\n            to={'/user/profile/' + user.handle}\n          >\n            <BodyText c={colors.blue} inline={1}>\n              @{user.handle}\n            </BodyText>\n          </ULink>\n          <BodyText>\n            {activity.totalUsers - 1} other{s}\n          </BodyText>\n        </Box>\n      );\n    }\n    if (user.handle) {\n      return (\n        <Box mr={0.75}>\n          <ULink\n            inline={1}\n            onPress={() => actions.goToProfile(user)}\n            to={'/user/profile/' + user.handle}\n          >\n            <BodyText c={colors.blue} inline={1}>\n              @{user.handle}\n            </BodyText>\n          </ULink>\n        </Box>\n      );\n    }\n    return <Box mr={0.75}>user.name</Box>;\n  }\n\n  renderIcon(img) {\n    if (!img) {\n      return null;\n    }\n    return <Image w={4} h={3.5} resizeMode={'contain'} source={img} />;\n  }\n\n  renderPostPreview(activity) {\n    const { PostComponent, actions } = this.props;\n    const { post } = activity;\n\n    const parentId = post.parentPost ? post.parentPost._id || post.parentPost : post._id;\n\n    const link = post.metaPost || post.parentPost;\n    // TODO hack should normalize in reducer\n    // if (post.parentPost) post.parentPost = post.parentPost._id;\n\n    const community = post.community || post.data ? post.data.community : null;\n    const linkToPost = `/${community}/post/${parentId}`;\n\n    const onPress = () => actions.goToPost({ _id: parentId, community });\n\n    return (\n      <ULink to={linkToPost} onPress={onPress}>\n        <View m={['0 4', '0 2']}>\n          <PostComponent\n            post={post}\n            link={link}\n            hideDivider\n            hidePostButtons\n            preview\n            noLink\n          />\n        </View>\n      </ULink>\n    );\n  }\n\n  renderActivity(activity) {\n    const { screenSize, actions } = this.props;\n    const { emoji, image, byUser } = activityHelper.getActivityParams(activity);\n    const amount = numbers.abbreviateNumber(activity.amount);\n    return (\n      <View flex={1} fdirection=\"row\" align=\"center\">\n        <View alignself={'flex-start'} mr={1.5}>\n          {this.renderIcon(image)}\n          {emoji ? (\n            <BodyText fs={4} lh={4.2} pt={1} align=\"baseline\">\n              {emoji}\n            </BodyText>\n          ) : null}\n          {byUser && <UAvatar goToProfile={actions.goToProfile} user={byUser} size={4} />}\n        </View>\n        <View flex={1} fdirection={'column'} align=\"baseline\">\n          <View fdirection={'row'} wrap={'wrap'} justify={'flex-start'}>\n            {this.renderName(activity, byUser)}\n            <ActivityText activity={activity} amount={amount} />\n          </View>\n          <View>{screenSize ? this.renderDate(activity) : null}</View>\n        </View>\n      </View>\n    );\n  }\n\n  renderDate(activity) {\n    const fromNow = numbers.getTimestamp(activity.createdAt);\n    return activity.type ? <SecondaryText lh={2}>{fromNow}</SecondaryText> : null;\n  }\n\n  renderComment(activity) {\n    const { PostComponent } = this.props;\n    const { post, amount, byUser } = activity;\n\n    post.embeddedUser = byUser;\n    return (\n      <View>\n        <View m={['0 4', '0 2']}>\n          <PostComponent\n            post={post}\n            hidePostButtons\n            preview\n            hideDivider\n            avatarText={() => <ActivityText activity={activity} amount={amount} />}\n          />\n        </View>\n        <Divider m={'2 0 0 0'} />\n      </View>\n    );\n  }\n\n  render() {\n    const { screenSize } = this.props;\n    const activity = this.props.singleActivity;\n    if (!activity) return null;\n\n    if (activity.type === 'comment') return this.renderComment(activity);\n\n    return (\n      <View maxWidth={MAX_POST_WIDTH}>\n        <View\n          m={['4 4 0 4', '4 2 0 2']}\n          fdirection=\"row\"\n          justify=\"space-between\"\n          align=\"center\"\n        >\n          {this.renderActivity(activity)}\n          {screenSize ? null : this.renderDate(activity)}\n        </View>\n        {activity.post ? (\n          <View m={0} ml={[6, 5.5]} pr={0}>\n            {this.renderPostPreview(activity)}\n          </View>\n        ) : (\n          <View mt={[4, 0]} />\n        )}\n        <Divider m={'2 0 0 0'} />\n      </View>\n    );\n  }\n}\n"],"file":"activity.component.js"}