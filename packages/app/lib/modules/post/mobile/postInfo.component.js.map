{"version":3,"sources":["../../../../src/modules/post/mobile/postInfo.component.js"],"names":["ActionSheet","ActionSheetIOS","Platform","OS","RNBottomSheet","showActionSheetWithOptions","showBottomSheetWithOptions","styles","PostInfo","props","context","setTag","bind","setSelected","state","passed","invested","timeUntilString","timePassedPercent","time","posted","input","ownerMenu","myPost","buttons","destructiveIndex","cancelIndex","showActionSheet","auth","user","_id","menu","singlePost","actions","post","redirect","deletePost","setCreatePostState","postBody","body","nativeImage","postUrl","url","postImage","image","allTags","tags","urlPreview","title","description","edit","editPost","push","key","back","next","left","tag","selectTag","changeTab","twitter","Linking","openURL","embeddedUser","handle","goToProfile","options","cancelButtonIndex","destructiveButtonIndex","buttonIndex","toggleEditing","delete","flag","preview","repost","avatarText","postActions","postButton","paddingRight","greyText","popup","infoRight","Component","PropTypes","object","bool","func","localStyles","StyleSheet","create","justifyContent","overflow","alignSelf","mapStateToProps","mapDispatchToProps","dispatch","globalStyles"],"mappings":"y6BAAA,qDACA,gDAQA,6DACA,4BACA,uCAEA,wFACA,oFACA,8CACA,6EAEA,qCACA,+DACA,+DACA,0C,umDAEA,GAAIA,CAAAA,WAAW,CAAGC,8BAAlB,CACA,GAAIC,yBAASC,EAAT,GAAgB,SAApB,CAA+B,CAC7BH,WAAW,CAAGI,+BAAd,CACAJ,WAAW,CAACK,0BAAZ,CAAyCD,gCAAcE,0BAAvD,CACD,CACD,GAAIC,CAAAA,MAAJ,C,GAEMC,CAAAA,Q,oGAcJ,kBAAYC,KAAZ,CAAmBC,OAAnB,CAA4B,uDAC1B,uBAAMD,KAAN,CAAaC,OAAb,EACA,MAAKC,MAAL,CAAc,MAAKA,MAAL,CAAYC,IAAZ,4CAAd,CACA,MAAKC,WAAL,CAAmB,MAAKA,WAAL,CAAiBD,IAAjB,4CAAnB,CACA,MAAKE,KAAL,CAAa,CACXC,MAAM,CAAE,KADG,CAEXC,QAAQ,CAAE,KAFC,CAGXC,eAAe,CAAE,IAHN,CAIXC,iBAAiB,CAAE,CAJR,CAKXC,IAAI,CAAE,CALK,CAMXC,MAAM,CAAE,IANG,CAOXC,KAAK,CAAE,IAPI,CAAb,CAUA,MAAKC,SAAL,CAAiB,CACfC,MAAM,CAAE,IADO,CAEfC,OAAO,CAAE,CAAC,MAAD,CAAS,QAAT,CAAmB,QAAnB,CAFM,CAGfC,gBAAgB,CAAE,CAHH,CAIfC,WAAW,CAAE,CAJE,CAAjB,CAOA,MAAKC,eAAL,CAAuB,MAAKA,eAAL,CAAqBf,IAArB,4CAAvB,CArB0B,aAsB3B,C,+FAEmB,iBACK,KAAKH,KADV,CACVmB,IADU,aACVA,IADU,CACJC,IADI,aACJA,IADI,CAElB,GAAI,CAACA,IAAL,CAAW,OACX,GAAID,IAAI,EAAIA,IAAI,CAACC,IAAb,EAAqBA,IAAI,CAACC,GAAL,GAAaF,IAAI,CAACC,IAAL,CAAUC,GAAhD,CAAqD,CACnD,KAAKC,IAAL,CAAY,KAAKT,SAAjB,CACA,KAAKC,MAAL,CAAc,IAAd,CACD,CACF,C,+CAEY,kBAC2B,KAAKd,KADhC,CACHuB,UADG,cACHA,UADG,CACSC,OADT,cACSA,OADT,CACkBC,IADlB,cACkBA,IADlB,CAEX,GAAIC,CAAAA,QAAQ,CAAG,KAAf,CACA,GAAIH,UAAJ,CAAgBG,QAAQ,CAAG,IAAX,CAChBF,OAAO,CAACG,UAAR,CAAmBF,IAAnB,CAAyBC,QAAzB,EACD,C,qDAEe,kBACY,KAAK1B,KADjB,CACNyB,IADM,cACNA,IADM,CACAD,OADA,cACAA,OADA,CAEdA,OAAO,CAACI,kBAAR,CAA2B,CACzBC,QAAQ,CAAEJ,IAAI,CAACK,IADU,CAEzBC,WAAW,CAAE,IAFY,CAGzBC,OAAO,CAAEP,IAAI,CAACQ,GAHW,CAIzBC,SAAS,CAAET,IAAI,CAACU,KAJS,CAKzBC,OAAO,CAAEX,IAAI,CAACY,IALW,CAMzBC,UAAU,CAAE,CACVH,KAAK,CAAEV,IAAI,CAACU,KADF,CAEVI,KAAK,CAAEd,IAAI,CAACc,KAAL,CAAad,IAAI,CAACc,KAAlB,CAA0B,UAFvB,CAGVC,WAAW,CAAEf,IAAI,CAACe,WAHR,CANa,CAWzBC,IAAI,CAAE,IAXmB,CAYzBC,QAAQ,CAAEjB,IAZe,CAA3B,EAcAD,OAAO,CAACmB,IAAR,CAAa,CACXC,GAAG,CAAE,YADM,CAEXC,IAAI,CAAE,IAFK,CAGXN,KAAK,CAAE,WAHI,CAIXO,IAAI,CAAE,QAJK,CAKXC,IAAI,CAAE,QALK,CAAb,EAOD,C,sCAEMC,G,CAAK,IACFxB,CAAAA,OADE,CACU,KAAKxB,KADf,CACFwB,OADE,CAEV,GAAI,CAACwB,GAAL,CAAU,OACVxB,OAAO,CAACyB,SAAR,CAAkBD,GAAlB,EACAxB,OAAO,CAAC0B,SAAR,CAAkB,UAAlB,EACD,C,iDAEa,kBACc,KAAKlD,KADnB,CACJwB,OADI,cACJA,OADI,CACKC,IADL,cACKA,IADL,CAEZ,GAAI,CAACD,OAAL,CAAc,MAAO,KAAP,CAEd,GAAI,KAAKxB,KAAL,CAAWyB,IAAX,CAAgB0B,OAApB,CAA6B,CAC3B,MAAOC,yBAAQC,OAAR,CAAgB,uBAAyB5B,IAAI,CAAC6B,YAAL,CAAkBC,MAA3D,CAAP,CACD,CAED,MAAO/B,CAAAA,OAAO,CAACgC,WAAR,CAAoB/B,IAAI,CAAC6B,YAAzB,CAAP,CACD,C,yDAEiB,kCACU,KAAKtD,KADf,CACRyB,IADQ,cACRA,IADQ,CACFD,OADE,cACFA,OADE,CAEhB,GAAI,KAAKV,MAAT,CAAiB,CACf,MAAOvB,CAAAA,WAAW,CAACK,0BAAZ,CACL,CACE6D,OAAO,CAAE,KAAKnC,IAAL,CAAUP,OADrB,CAEE2C,iBAAiB,CAAE,KAAKpC,IAAL,CAAUL,WAF/B,CAGE0C,sBAAsB,CAAE,KAAKrC,IAAL,CAAUN,gBAHpC,CADK,CAML,SAAA4C,WAAW,CAAI,CACb,OAAQA,WAAR,EACE,IAAK,EAAL,CACE,GAAI,MAAI,CAAC5D,KAAL,CAAWyC,IAAf,CAAqB,MAAI,CAACzC,KAAL,CAAWyC,IAAX,GAArB,IACK,CAAA,MAAI,CAACoB,aAAL,GACL,MACF,IAAK,EAAL,CACE,GAAI,MAAI,CAAC7D,KAAL,CAAW8D,MAAf,CAAuB,MAAI,CAAC9D,KAAL,CAAW8D,MAAX,GAAvB,IACK,CAAA,MAAI,CAACnC,UAAL,GACL,MACF,QATF,CAWD,CAlBI,CAAP,CAoBD,CAED,MAAOpC,CAAAA,WAAW,CAACK,0BAAZ,CACL,CACE6D,OAAO,CAAE,CAAC,4BAAD,CAA+B,QAA/B,CADX,CAEEC,iBAAiB,CAAE,CAFrB,CADK,CAKL,SAAAE,WAAW,CAAI,CACb,OAAQA,WAAR,EACE,IAAK,EAAL,CACEpC,OAAO,CAACuC,IAAR,CAAatC,IAAb,EACA,MACF,QAJF,CAMD,CAZI,CAAP,CAcD,C,uCAEQ,kCAC6C,KAAKzB,KADlD,CACCyB,IADD,cACCA,IADD,CACOuC,OADP,cACOA,OADP,CACgBC,MADhB,cACgBA,MADhB,CACwB7C,IADxB,cACwBA,IADxB,CAC8B8C,UAD9B,cAC8BA,UAD9B,CAEP,GAAI,CAAC9C,IAAL,CAAW,MAAO,KAAP,CAEX,GAAM+C,CAAAA,WAAW,CACf,6BAAC,gCAAD,EACE,KAAK,CAAE,CAACrE,MAAM,CAACsE,UAAR,CAAoB,CAAEC,YAAY,CAAE,EAAhB,CAApB,CADT,CAEE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACnD,eAAL,EAAN,EAFX,iEAIE,6BAAC,iBAAD,EAAM,IAAI,CAAC,UAAX,CAAsB,IAAI,CAAE,EAA5B,CAAgC,KAAK,CAAEoD,gBAAvC,iEAJF,CADF,CASA,GAAMC,CAAAA,KAAK,CAAG,6BAAC,oBAAD,EAAM,KAAK,CAAE,CAACzE,MAAM,CAAC0E,SAAR,CAAb,kEAAkCP,MAAM,CAAG,IAAH,CAAUE,WAAlD,CAAd,CAEA,MACE,8BAAC,gBAAD,EACE,UAAU,CAAED,UADd,CAEE,OAAO,CAAEzC,IAFX,CAGE,IAAI,CAAEL,IAHR,CAIE,KAAK,CAAE,CAAC4C,OAAD,EAAYO,KAJrB,CAKE,OAAO,CAAEP,OALX,iEADF,CASD,C,sBAlKoBS,gB,+BAAjB1E,Q,aACe,CACjB0B,IAAI,CAAEiD,mBAAUC,MADC,CAEjBxD,IAAI,CAAEuD,mBAAUC,MAFC,CAGjBpD,UAAU,CAAEmD,mBAAUE,IAHL,CAIjBpD,OAAO,CAAEkD,mBAAUC,MAJF,CAKjBlC,IAAI,CAAEiC,mBAAUG,IALC,CAMjBf,MAAM,CAAEY,mBAAUG,IAND,CAOjBb,OAAO,CAAEU,mBAAUE,IAPF,CAQjBX,MAAM,CAAES,mBAAUE,IARD,CASjBxD,IAAI,CAAEsD,mBAAUC,MATC,CAUjBT,UAAU,CAAEQ,mBAAUG,IAVL,C,EAoKrB,GAAMC,CAAAA,WAAW,CAAGC,2BAAWC,MAAX,CAAkB,CACpCR,SAAS,CAAE,CACTS,cAAc,CAAE,UADP,CAETC,QAAQ,CAAE,SAFD,CAGTC,SAAS,CAAE,QAHF,CADyB,CAAlB,CAApB,CAQA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,SAAO,EAAP,EAAxB,CAEA,QAASC,CAAAA,kBAAT,CAA4BC,QAA5B,CAAsC,CACpC,MAAO,CACL9D,OAAO,CAAE,8BACP,CAAEG,UAAU,CAAVA,gBAAF,CAAcoC,IAAI,CAAJA,UAAd,CAAoBpB,IAAI,CAAJA,gBAApB,CAA0BO,SAAS,CAATA,qBAA1B,CAAqCM,WAAW,CAAXA,uBAArC,CAAkD5B,kBAAkB,CAAlBA,8BAAlD,CAAsEqB,SAAS,CAATA,cAAtE,CADO,CAEPqC,QAFO,CADJ,CAAP,CAMD,C,aAEc,wBAAQF,eAAR,CAAyBC,kBAAzB,EAA6CtF,QAA7C,C,0BAEfD,MAAM,gCAAQyF,oBAAR,EAAyBT,WAAzB,CAAN","sourcesContent":["import React, { Component } from 'react';\nimport {\n  StyleSheet,\n  View,\n  ActionSheetIOS,\n  TouchableOpacity,\n  Platform,\n  Linking\n} from 'react-native';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport RNBottomSheet from 'react-native-bottomsheet';\nimport Icon from 'react-native-vector-icons/Ionicons';\nimport { globalStyles, greyText } from 'app/styles/global';\nimport CommentAuthor from 'modules/comment/comment.author';\n\nimport { deletePost, flag } from 'modules/post/post.actions';\nimport { push, changeTab, goToProfile } from 'modules/navigation/navigation.actions';\nimport { setCreatePostState } from 'modules/createPost/createPost.actions';\nimport { selectTag } from 'modules/tag/tag.actions';\n\nlet ActionSheet = ActionSheetIOS;\nif (Platform.OS === 'android') {\n  ActionSheet = RNBottomSheet;\n  ActionSheet.showActionSheetWithOptions = RNBottomSheet.showBottomSheetWithOptions;\n}\nlet styles;\n\nclass PostInfo extends Component {\n  static propTypes = {\n    post: PropTypes.object,\n    auth: PropTypes.object,\n    singlePost: PropTypes.bool,\n    actions: PropTypes.object,\n    edit: PropTypes.func,\n    delete: PropTypes.func,\n    preview: PropTypes.bool,\n    repost: PropTypes.bool,\n    user: PropTypes.object,\n    avatarText: PropTypes.func\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.setTag = this.setTag.bind(this);\n    this.setSelected = this.setSelected.bind(this);\n    this.state = {\n      passed: false,\n      invested: false,\n      timeUntilString: null,\n      timePassedPercent: 0,\n      time: 0,\n      posted: null,\n      input: null\n    };\n\n    this.ownerMenu = {\n      myPost: true,\n      buttons: ['Edit', 'Delete', 'Cancel'],\n      destructiveIndex: 1,\n      cancelIndex: 2\n    };\n\n    this.showActionSheet = this.showActionSheet.bind(this);\n  }\n\n  componentDidMount() {\n    const { auth, user } = this.props;\n    if (!user) return;\n    if (auth && auth.user && user._id === auth.user._id) {\n      this.menu = this.ownerMenu;\n      this.myPost = true;\n    }\n  }\n\n  deletePost() {\n    const { singlePost, actions, post } = this.props;\n    let redirect = false;\n    if (singlePost) redirect = true;\n    actions.deletePost(post, redirect);\n  }\n\n  toggleEditing() {\n    const { post, actions } = this.props;\n    actions.setCreatePostState({\n      postBody: post.body,\n      nativeImage: true,\n      postUrl: post.url,\n      postImage: post.image,\n      allTags: post.tags,\n      urlPreview: {\n        image: post.image,\n        title: post.title ? post.title : 'Untitled',\n        description: post.description\n      },\n      edit: true,\n      editPost: post\n    });\n    actions.push({\n      key: 'createPost',\n      back: true,\n      title: 'Edit Post',\n      next: 'Update',\n      left: 'Cancel'\n    });\n  }\n\n  setTag(tag) {\n    const { actions } = this.props;\n    if (!tag) return;\n    actions.selectTag(tag);\n    actions.changeTab('discover');\n  }\n\n  setSelected() {\n    const { actions, post } = this.props;\n    if (!actions) return null;\n\n    if (this.props.post.twitter) {\n      return Linking.openURL('https://twitter.com/' + post.embeddedUser.handle);\n    }\n\n    return actions.goToProfile(post.embeddedUser);\n  }\n\n  showActionSheet() {\n    const { post, actions } = this.props;\n    if (this.myPost) {\n      return ActionSheet.showActionSheetWithOptions(\n        {\n          options: this.menu.buttons,\n          cancelButtonIndex: this.menu.cancelIndex,\n          destructiveButtonIndex: this.menu.destructiveIndex\n        },\n        buttonIndex => {\n          switch (buttonIndex) {\n            case 0:\n              if (this.props.edit) this.props.edit();\n              else this.toggleEditing();\n              break;\n            case 1:\n              if (this.props.delete) this.props.delete();\n              else this.deletePost();\n              break;\n            default:\n          }\n        }\n      );\n    }\n\n    return ActionSheet.showActionSheetWithOptions(\n      {\n        options: ['Flag Inappropriate Content', 'Cancel'],\n        cancelButtonIndex: 1\n      },\n      buttonIndex => {\n        switch (buttonIndex) {\n          case 0:\n            actions.flag(post);\n            break;\n          default:\n        }\n      }\n    );\n  }\n\n  render() {\n    const { post, preview, repost, user, avatarText } = this.props;\n    if (!user) return null;\n\n    const postActions = (\n      <TouchableOpacity\n        style={[styles.postButton, { paddingRight: 10 }]}\n        onPress={() => this.showActionSheet()}\n      >\n        <Icon name=\"ios-more\" size={24} color={greyText} />\n      </TouchableOpacity>\n    );\n\n    const popup = <View style={[styles.infoRight]}>{repost ? null : postActions}</View>;\n\n    return (\n      <CommentAuthor\n        avatarText={avatarText}\n        comment={post}\n        user={user}\n        popup={!preview && popup}\n        preview={preview}\n      />\n    );\n  }\n}\n\nconst localStyles = StyleSheet.create({\n  infoRight: {\n    justifyContent: 'flex-end',\n    overflow: 'visible',\n    alignSelf: 'center'\n  }\n});\n\nconst mapStateToProps = () => ({});\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      { deletePost, flag, push, changeTab, goToProfile, setCreatePostState, selectTag },\n      dispatch\n    )\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostInfo);\n\nstyles = { ...globalStyles, ...localStyles };\n"],"file":"postInfo.component.js"}