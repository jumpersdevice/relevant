{"version":3,"sources":["../../../../src/modules/post/mobile/singlePost.container.js"],"names":["SinglePostContainer","inputHeight","editing","comment","props","posts","navigation","id","state","params","post","actions","getSelectedPost","getComments","bool","setState","setTitle","InteractionManager","runAfterInteractions","getPost","prevProps","auth","community","link","links","metaPost","title","body","setParams","next","error","related","reload","flex","setEditing","Component","PropTypes","object","comments","users","mapStateToProps","user","singlepost","tags","mapDispatchToProps","dispatch","statsActions","tagActions","authActions","commentActions","postActions","animationActions","investActions","userActions","createPostActions","navigationActions","tooltipActions"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { View, InteractionManager } from 'react-native';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport * as authActions from 'modules/auth/auth.actions';\nimport * as userActions from 'modules/user/user.actions';\nimport * as postActions from 'modules/post/post.actions';\nimport * as commentActions from 'modules/comment/comment.actions';\nimport * as statsActions from 'modules/stats/stats.actions';\nimport * as tagActions from 'modules/tag/tag.actions';\nimport * as investActions from 'modules/post/invest.actions';\nimport * as createPostActions from 'modules/createPost/createPost.actions';\nimport * as navigationActions from 'modules/navigation/navigation.actions';\nimport * as animationActions from 'modules/animation/animation.actions';\nimport * as tooltipActions from 'modules/tooltip/tooltip.actions';\nimport CustomSpinnerRelative from 'modules/ui/mobile/customSpinnerRelative.component';\nimport ErrorComponent from 'modules/ui/mobile/error.component';\nimport SinglePost from './singlePost.component';\n\nclass SinglePostContainer extends Component {\n  static propTypes = {\n    navigation: PropTypes.object,\n    actions: PropTypes.object,\n    comments: PropTypes.object,\n    users: PropTypes.object,\n    auth: PropTypes.object,\n    error: PropTypes.bool,\n    posts: PropTypes.object\n  };\n\n  state = {\n    inputHeight: 0,\n    editing: false,\n    comment: null\n  };\n\n  componentWillMount() {\n    this.setTitle(this.props);\n    InteractionManager.runAfterInteractions(this.getPost());\n  }\n\n  componentDidUpdate(prevProps) {\n    // TODO this is not needed if we don't wipe post reducer\n    // when switching communities\n    if (prevProps.auth.community !== this.props.auth.community) this.getPost();\n  }\n\n  getPost = () => {\n    const { posts, navigation } = this.props;\n    const { id } = navigation.state.params;\n    const post = posts.posts[id];\n    if (!post) this.props.actions.getSelectedPost(id);\n    this.props.actions.getComments(id);\n  };\n\n  setTitle(props) {\n    const { posts, navigation } = props;\n    const { id } = navigation.state.params;\n    const post = posts.posts[id];\n    if (!post) return;\n\n    const link = post && posts.links[post.metaPost];\n    const title = post.title || post.body || link.title;\n\n    if (!this.props.navigation.state.params || title !== navigation.state.params.title) {\n      navigation.setParams({ title });\n    }\n  }\n\n  componentDidWillUpdate(next) {\n    if (\n      !this.props.navigation.state.params ||\n      !this.props.navigation.state.params.title\n    ) {\n      this.setTitle(next);\n    }\n  }\n\n  setEditing = bool => {\n    this.setState({ editing: bool });\n  };\n\n  reload = () => {\n    const { id } = this.props.navigation.state.params;\n    this.props.actions.getSelectedPost(id);\n    this.props.actions.getComments(id);\n  };\n\n  render() {\n    const { posts, navigation, error } = this.props;\n    const { id } = navigation.state.params;\n    const post = posts.posts[id];\n\n    const related = posts.related[id] || [];\n    const link = post && posts.links[post.metaPost];\n\n    if (error && !post) {\n      return (\n        <ErrorComponent\n          error={this.props.error}\n          parent={'singlepost'}\n          reloadFunction={this.reload}\n        />\n      );\n    }\n\n    return (\n      <View style={{ flex: 1 }}>\n        <SinglePost\n          postId={id}\n          post={post}\n          link={link}\n          singlePostEditing={this.setEditing}\n          error={this.error}\n          related={related}\n          {...this.props}\n        />\n        <CustomSpinnerRelative visible={!post && !this.props.error} />\n      </View>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    auth: state.auth,\n    posts: state.posts,\n    user: state.user,\n    error: state.error.singlepost,\n    comments: state.comments,\n    users: state.user,\n    tags: state.tags\n    // myPostInv: state.investments.myPostInv\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...statsActions,\n        ...tagActions,\n        ...authActions,\n        ...commentActions,\n        ...postActions,\n        ...animationActions,\n        ...investActions,\n        ...userActions,\n        ...createPostActions,\n        ...navigationActions,\n        ...tooltipActions\n      },\n      dispatch\n    )\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SinglePostContainer);\n"],"file":"singlePost.container.js"}