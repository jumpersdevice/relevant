{"version":3,"sources":["../../../../src/modules/post/mobile/postImage.component.js"],"names":["styles","PostImage","props","context","openLink","bind","state","url","actions","goToUrl","post","_id","image","metaPost","single","smallerImg","title","linkEl","time","author","authorEl","articleDate","numbers","getTimestamp","Date","parse","articleAuthor","length","join","font12","articleTitle","darkGrey","match","link","publisher","domain","trim","titleEl","textContainer","bebasBold","color","lineHeight","fontSize","letterSpacing","marginBottom","paddingTop","imageEl","imgColors","titleLength","body","Math","max","colors","parseInt","start","x","y","end","gradient","linearGradient","height","img","postImage","uri","require","imageCont","flex","marginTop","e","touchable1x","nativeEvent","pageX","abs","top","left","right","bottom","postImageContainer","Component","PropTypes","object","localStyles","StyleSheet","create","whiteText","backgroundColor","paddingHorizontal","mainPadding","paddingVertical","flexDirection","justifyContent","smallScreen","maxWidth","fullWidth","position","resizeMode","overflow","width","alignItems","globalStyles"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { StyleSheet, Text, View, TouchableHighlight, Image } from 'react-native';\nimport PropTypes from 'prop-types';\nimport LinearGradient from 'react-native-linear-gradient';\nimport { numbers } from 'app/utils';\nimport { globalStyles, fullWidth, mainPadding, smallScreen } from 'app/styles/global';\n\nlet styles;\n\nclass PostImage extends Component {\n  static propTypes = {\n    actions: PropTypes.object,\n    post: PropTypes.object,\n    metaPost: PropTypes.object\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.openLink = this.openLink.bind(this);\n    this.state = {};\n  }\n\n  componentDidMount() {}\n\n  openLink(url) {\n    this.props.actions.goToUrl(url, this.props.post._id);\n  }\n\n  render() {\n    let image = null;\n    let post = this.props.metaPost || this.props.post;\n    if (post.metaPost) post = post.metaPost;\n\n    if (!post) return null;\n\n    const single = false; // this.props.singlePost;\n    let smallerImg; // = this.props.singlePost;\n    let title = null;\n    let linkEl = null;\n    let time;\n    let author;\n    let authorEl;\n    if (post.articleDate) {\n      time = numbers.getTimestamp(Date.parse(post.articleDate));\n    }\n    if (post.articleAuthor && post.articleAuthor.length) {\n      author = post.articleAuthor.join(', ');\n      authorEl = (\n        <Text\n          numberOfLines={1}\n          style={[styles.font12, styles.articleTitle, single ? styles.darkGrey : null]}\n        >\n          {author || ''}\n        </Text>\n      );\n    }\n    if (post.image && !post.image.match('gif')) {\n      image = post.image.match('http') ? post.image : 'https:' + post.image;\n    }\n    if (post.link || post.url) {\n      linkEl = (\n        <View>\n          <Text\n            style={[styles.font12, styles.articleTitle, single ? styles.darkGrey : null]}\n          >\n            {post.publisher || post.domain}\n            {time ? ' · ' + time : ''}\n            {authorEl ? ' · ' : null}\n            {authorEl}\n          </Text>\n        </View>\n      );\n    }\n    title = post.title ? post.title.trim() : '';\n\n    const titleEl = (\n      <View style={[styles.textContainer]}>\n        <View>\n          <Text\n            numberOfLines={3}\n            style={[\n              styles.articleTitle,\n              styles.bebasBold,\n              { color: 'white', lineHeight: 28 },\n              { fontSize: 30, letterSpacing: 0.1, marginBottom: 0, paddingTop: 3 },\n              single ? styles.darkGrey : null\n            ]}\n          >\n            {title || 'Untitled'}\n          </Text>\n          {linkEl}\n        </View>\n      </View>\n    );\n\n    let imageEl;\n\n    const imgColors = [\n      'hsla(240, 70%, 30%, .01)',\n      'hsla(240, 70%, 20%, .05)',\n      'hsla(240, 70%, 10%, .2)',\n      'hsla(240, 70%, 10%, .7)',\n      'hsla(240, 70%, 10%, .6)'\n    ];\n\n    const titleLength = post.title ? post.title.length : 0;\n    let color = post.body ? post.body.length : titleLength;\n    color = (color % 220) + 200 || 200;\n    color = Math.max(100, color);\n    const colors = [\n      'hsla(' + parseInt(color - 30, 10) + ', 100%, 50%, 1)',\n      'hsla(' + parseInt(color, 10) + ',      100%, 50%, 1)',\n      'hsla(' + parseInt(color + 30, 10) + ', 100%, 50%, 1)'\n    ];\n    const start = { x: 0.8, y: 0.0 };\n    const end = { x: 0.2, y: 1.0 };\n\n    const gradient = (\n      <LinearGradient\n        start={image ? { x: 0.5, y: 0.0 } : start}\n        end={image ? { x: 0.5, y: 1.0 } : end}\n        colors={image ? imgColors : colors}\n        style={[styles.linearGradient, smallerImg ? { height: 180 } : null]}\n      >\n        {single ? null : titleEl}\n      </LinearGradient>\n    );\n    let img;\n    if (image) {\n      img = (\n        <Image\n          style={[styles.postImage, smallerImg ? { height: 180 } : null]}\n          source={image ? { uri: image } : require('public/img/missing.png')}\n        />\n      );\n    }\n\n    if (post.link || post.url || image) {\n      imageEl = (\n        <View style={[styles.imageCont, smallerImg ? { height: 180 } : null]}>\n          {img}\n          {!single ? gradient : null}\n        </View>\n      );\n    }\n\n    return (\n      <TouchableHighlight\n        style={{ flex: 1, marginTop: 0 }}\n        underlayColor={'transparent'}\n        // onPress={link ? () => this.openLink(link) : null}\n        onPressIn={e => {\n          this.touchable1x = e.nativeEvent.pageX;\n        }}\n        onPress={e => {\n          const x = e.nativeEvent.pageX;\n          if (Math.abs(this.touchable1x - x) > 5) {\n            return;\n          }\n          this.openLink(post.link || post.url);\n        }}\n        pressRetentionOffset={{ top: 100, left: 100, right: 100, bottom: 100 }}\n      >\n        <View style={[styles.postImageContainer]}>\n          {imageEl}\n          {single ? titleEl : null}\n        </View>\n      </TouchableHighlight>\n    );\n  }\n}\n\nexport default PostImage;\n\nconst localStyles = StyleSheet.create({\n  whiteText: {\n    backgroundColor: 'transparent',\n    color: 'white'\n  },\n  textContainer: {\n    paddingHorizontal: mainPadding,\n    paddingVertical: 15,\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'flex-end'\n  },\n  articleTitle: {\n    backgroundColor: 'transparent',\n    color: 'white'\n  },\n  postImage: {\n    height: smallScreen ? 200 : 256,\n    flex: 1,\n    maxWidth: fullWidth,\n    position: 'relative',\n    resizeMode: 'cover'\n  },\n  imageCont: {\n    height: smallScreen ? 200 : 256,\n    flex: 1,\n    overflow: 'hidden'\n  },\n  linearGradient: {\n    height: 256,\n    width: fullWidth,\n    position: 'absolute',\n    bottom: 0\n  },\n  postImageContainer: {\n    marginBottom: 0,\n    flex: 1,\n    alignItems: 'stretch',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    backgroundColor: 'white'\n  }\n});\n\nstyles = { ...globalStyles, ...localStyles };\n"],"file":"postImage.component.js"}