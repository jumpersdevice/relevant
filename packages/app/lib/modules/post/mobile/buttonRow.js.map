{"version":3,"sources":["../../../../src/modules/post/mobile/buttonRow.js"],"names":["ActionSheet","ActionSheetIOS","Platform","OS","RNBottomSheet","showActionSheetWithOptions","showBottomSheetWithOptions","linkMenu","buttons","cancelIndex","defaultMenu","ButtonRow","propTypes","singlePost","PropTypes","bool","focusInput","func","link","object","comment","setupReply","post","oneOfType","string","parentPost","auth","state","dispatch","menu","hasAuth","onShare","community","postUrl","title","Share","open","url","subject","catch","err","console","log","showActionSheet","options","cancelButtonIndex","destructiveButtonIndex","destructiveIndex","buttonIndex","repostUrl","Linking","openURL","postBody","component","nativeImage","postImage","image","urlPreview","description","key","NavigateToPost","openComment","_parentPost","parentPostId","_id","isLink","paddingHorizontal","flexDirection","alignItems","colors","blue","commentCount","paddingRight"],"mappings":"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","sourcesContent":["import React, { memo } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ActionSheetIOS, TouchableOpacity, Platform, Linking } from 'react-native';\nimport RNBottomSheet from 'react-native-bottomsheet';\nimport Share from 'react-native-share';\nimport { getPostUrl, getTitle } from 'app/utils/post';\nimport { push, goToPost } from 'modules/navigation/navigation.actions';\nimport { setCreatePostState } from 'modules/createPost/createPost.actions';\nimport { CTALink, View } from 'modules/styled/uni';\nimport { colors } from 'app/styles';\nimport { useAuth } from 'modules/auth/hooks';\n\nlet ActionSheet = ActionSheetIOS;\n\nif (Platform.OS === 'android') {\n  ActionSheet = RNBottomSheet;\n  ActionSheet.showActionSheetWithOptions = RNBottomSheet.showBottomSheetWithOptions;\n}\n\nconst linkMenu = {\n  buttons: ['Repost Article', 'Share Via...', 'Open Link in Browser', 'Cancel'],\n  cancelIndex: 3\n};\n\nconst defaultMenu = {\n  buttons: ['Share Via...', 'Cancel'],\n  cancelIndex: 2\n};\n\nButtonRow.propTypes = {\n  singlePost: PropTypes.bool,\n  focusInput: PropTypes.func,\n  link: PropTypes.object,\n  comment: PropTypes.object,\n  setupReply: PropTypes.func,\n  post: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  parentPost: PropTypes.oneOfType([PropTypes.string, PropTypes.object])\n};\n\nexport default memo(ButtonRow);\n\nfunction ButtonRow({\n  link,\n  post,\n  parentPost,\n  singlePost,\n  focusInput,\n  comment,\n  setupReply\n}) {\n  const auth = useSelector(state => state.auth);\n  const dispatch = useDispatch();\n\n  const menu = link ? linkMenu : defaultMenu;\n  const hasAuth = useAuth();\n\n  const onShare = () => {\n    const { community } = auth;\n    if (!hasAuth()) return;\n    const postUrl = getPostUrl(community, post);\n    const title = getTitle({ post });\n    Share.open({\n      title: title || '',\n      url: 'https://relevant.community' + postUrl,\n      subject: 'Share Link'\n    }).catch(err => console.log(err)); // eslint-disable-line\n  };\n\n  function showActionSheet() {\n    if (!hasAuth()) return;\n    ActionSheet.showActionSheetWithOptions(\n      {\n        options: menu.buttons,\n        cancelButtonIndex: menu.cancelIndex,\n        destructiveButtonIndex: menu.destructiveIndex\n      },\n      buttonIndex => {\n        if (link) {\n          switch (buttonIndex) {\n            case 0:\n              return repostUrl();\n            case 1:\n              return onShare();\n            case 2:\n              return Linking.openURL(link.url);\n            default:\n              return null;\n          }\n        }\n        switch (buttonIndex) {\n          case 0:\n            return onShare();\n          default:\n            return null;\n        }\n      }\n    );\n  }\n\n  function repostUrl() {\n    if (!hasAuth()) return;\n    if (!link) return;\n    dispatch(\n      setCreatePostState({\n        postBody: '',\n        component: 'createPost',\n        nativeImage: true,\n        postUrl: link.url,\n        postImage: link.image,\n        urlPreview: {\n          image: link.image,\n          title: link.title ? link.title : 'Untitled',\n          description: link.description\n        }\n      })\n    );\n\n    dispatch(push({ key: 'createPost', title: 'Add Commentary' }));\n  }\n\n  function NavigateToPost(openComment) {\n    if (openComment && !hasAuth()) return;\n\n    const _parentPost = parentPost || post;\n    const parentPostId = _parentPost._id || _parentPost;\n\n    // console.log('click NAVIGATE TO POST', parentPostId);\n    if (singlePost) {\n      // console.log('setup reply');\n      // console.log('post id', get(navigation, 'state.params.id'));\n      if (setupReply) setupReply(post);\n      if (focusInput) focusInput();\n      return;\n    }\n\n    dispatch(goToPost({ _id: parentPostId, comment }, openComment));\n  }\n\n  const isLink = !post.parentPost && post.url;\n\n  return (\n    <View fdirection={'row'}>\n      <TouchableOpacity\n        onPress={() => (isLink ? repostUrl() : NavigateToPost(true))}\n        style={{ paddingHorizontal: 12 }}\n      >\n        <View style={[{ flexDirection: 'row', alignItems: 'center' }]}>\n          <CTALink c={colors.blue}>{isLink ? 'Comment' : 'Reply'}</CTALink>\n          {post.commentCount && !isLink ? (\n            <CTALink> ({post.commentCount})</CTALink>\n          ) : null}\n        </View>\n      </TouchableOpacity>\n\n      <TouchableOpacity style={{ paddingRight: 8 }} onPress={() => showActionSheet()}>\n        <View style={[{ flexDirection: 'column', alignItems: 'center' }]}>\n          <CTALink c={colors.blue}>Share</CTALink>\n        </View>\n      </TouchableOpacity>\n    </View>\n  );\n}\n"],"file":"buttonRow.js"}