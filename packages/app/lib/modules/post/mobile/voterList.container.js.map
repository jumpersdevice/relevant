{"version":3,"sources":["../../../../src/modules/post/mobile/voterList.container.js"],"names":["styles","VoterList","props","context","renderRow","bind","load","renderRight","state","loading","postId","navigation","params","id","onInteraction","InteractionManager","runAfterInteractions","forceUpdate","cancel","inv","invest","posts","data","map","investments","loaded","view","length","undefined","actions","getPostInvestments","rowData","user","users","investor","amount","relevantPoints","icon","require","color","darkGrey","inner","flexDirection","alignItems","statNumber","r","height","width","bebas","lineHeight","fontSize","Math","abs","numbers","abbreviateNumber","getViewData","listEl","flex","Component","PropTypes","object","localStyles","StyleSheet","create","votes","alignSelf","globalStyles","mapStateToProps","error","discover","tabs","mapDispatchToProps","dispatch","investActions","navigationActions"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { View, InteractionManager, Text, StyleSheet, Image } from 'react-native';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { globalStyles, darkGrey } from 'app/styles/global';\nimport * as investActions from 'modules/post/invest.actions';\nimport * as navigationActions from 'modules/navigation/navigation.actions';\n\nimport DiscoverUser from 'modules/discover/mobile/discoverUser.component';\nimport CustomListView from 'modules/listview/mobile/customList.component';\nimport CustomSpinner from 'modules/ui/mobile/CustomSpinner.component';\nimport { numbers } from 'app/utils';\n\nlet styles;\n\nclass VoterList extends Component {\n  static propTypes = {\n    navigation: PropTypes.object,\n    invest: PropTypes.object,\n    actions: PropTypes.object,\n    users: PropTypes.object\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.renderRow = this.renderRow.bind(this);\n    this.load = this.load.bind(this);\n    this.renderRight = this.renderRight.bind(this);\n    this.state = {};\n    this.loading = false;\n  }\n\n  componentWillMount() {\n    this.postId = this.props.navigation.state.params.id;\n    this.onInteraction = InteractionManager.runAfterInteractions(() => {\n      this.load();\n      this.forceUpdate();\n    });\n  }\n\n  componentWillUnmount() {\n    if (this.onInteraction) this.onInteraction.cancel();\n  }\n\n  getViewData() {\n    const inv = this.props.invest.posts[this.postId];\n    let data = [];\n    if (inv) {\n      data = inv.map(id => this.props.invest.investments[id]);\n    }\n    const loaded = this.props.invest.loaded[this.postId];\n    return {\n      data,\n      loaded\n    };\n  }\n\n  load(view, length) {\n    if (length === undefined) length = 0;\n    this.props.actions.getPostInvestments(this.postId, 100, length);\n  }\n\n  renderRow(rowData) {\n    const user = this.props.users[rowData.investor];\n    if (!user || !rowData) return null;\n    return (\n      <DiscoverUser\n        relevance\n        user={user}\n        {...this.props}\n        renderRight={() => this.renderRight(rowData)}\n      />\n    );\n  }\n\n  renderRight(props) {\n    const { amount, relevantPoints } = props;\n    let icon = require('public/img/rup.png');\n    const color = { color: darkGrey };\n    if (amount < 0) {\n      icon = require('public/img/rdown.png');\n    }\n\n    let inner = (\n      <View style={{ flexDirection: 'row', alignItems: 'center' }}>\n        <Text style={[styles.statNumber, color]}>+ </Text>\n        <Image\n          resizeMode={'contain'}\n          style={[styles.r, { height: 16, width: 20 }]}\n          source={icon}\n        />\n        <Text style={[styles.bebas, color, { lineHeight: 17, fontSize: 17 }]}>\n          {Math.abs(numbers.abbreviateNumber(relevantPoints))}\n        </Text>\n      </View>\n    );\n\n    if (amount < 0) {\n      inner = (\n        <View style={{ flexDirection: 'row', alignItems: 'center' }}>\n          <Text style={[styles.statNumber, color]}>- </Text>\n          <Image\n            resizeMode={'contain'}\n            style={[styles.r, { height: 16, width: 20 }]}\n            source={icon}\n          />\n          <Text style={[styles.bebas, color, { lineHeight: 17, fontSize: 17 }]}>\n            {Math.abs(numbers.abbreviateNumber(relevantPoints))}\n          </Text>\n        </View>\n      );\n    }\n    return inner;\n  }\n\n  render() {\n    const data = this.getViewData();\n    let listEl = <CustomSpinner />;\n\n    if (!this.loading) {\n      listEl = (\n        <CustomListView\n          data={data.data || []}\n          loaded={data.loaded}\n          renderRow={this.renderRow}\n          load={this.load}\n          type={'votes'}\n          parent={'discover'}\n          active\n          view={0}\n          scrollableTab\n        />\n      );\n    }\n\n    return <View style={{ flex: 1 }}>{listEl}</View>;\n  }\n}\n\nconst localStyles = StyleSheet.create({\n  votes: {\n    alignSelf: 'flex-end',\n    fontSize: 17\n  }\n});\n\nstyles = { ...localStyles, ...globalStyles };\n\nfunction mapStateToProps(state) {\n  return {\n    invest: state.investments,\n    users: state.user.users,\n    error: state.error.discover,\n    tabs: state.navigation.tabs\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...investActions,\n        ...navigationActions\n      },\n      dispatch\n    )\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(VoterList);\n"],"file":"voterList.container.js"}