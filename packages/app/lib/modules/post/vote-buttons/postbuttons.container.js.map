{"version":3,"sources":["../../../../src/modules/post/vote-buttons/postbuttons.container.js"],"names":["coinImage","require","PostButtons","propTypes","post","PropTypes","shape","_id","oneOfType","string","object","id","data","user","myVote","parentPost","type","url","color","horizontal","bool","investButton","community","state","auth","canBet","getCanBet","castVote","tooltipData","getTooltipData","voteStatus","getVoteStatus","opacity","top","right","up","e","vote","down","ownPost","amount","postType","tipText","text","position","desktopOnly","now","Date","bettingEnabled","betEnabled","manualBet","notificationSettings","bet","manual","eligibleForReward","getTime","payoutTime"],"mappings":"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","sourcesContent":["import React, { useRef, memo } from 'react';\nimport PropTypes from 'prop-types';\nimport { useSelector } from 'react-redux';\nimport { getPostType } from 'app/utils/post';\nimport { View, Image } from 'modules/styled/uni';\nimport { useCommunity } from 'modules/community/community.selectors';\nimport { sizing } from 'styles';\nimport PostButton from './postbutton';\nimport PostRank from './postrank';\nimport { useVoteAnimation, useCastVote } from './button.hooks';\n\nconst coinImage = require('public/img/relevantcoin.png');\n\nPostButtons.propTypes = {\n  post: PropTypes.shape({\n    _id: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n    id: PropTypes.string,\n    data: PropTypes.object,\n    user: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n    myVote: PropTypes.object,\n    parentPost: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n    type: PropTypes.string,\n    url: PropTypes.string\n  }),\n  color: PropTypes.string,\n  horizontal: PropTypes.bool\n};\n\nexport default memo(PostButtons);\n\nfunction PostButtons({ post, color, horizontal }) {\n  const investButton = useRef();\n  const community = useCommunity();\n  const user = useSelector(state => state.auth.user);\n  const canBet = getCanBet({ post, community, user });\n\n  useVoteAnimation({ post, investButton, horizontal });\n  const castVote = useCastVote({ post, user, community, canBet });\n\n  const tooltipData = getTooltipData(post);\n  const voteStatus = getVoteStatus(user, post);\n  if (!post || post === 'notFound') return null;\n\n  return (\n    <View\n      ref={investButton}\n      onLayout={() => {}}\n      align=\"center\"\n      fdirection={horizontal ? 'row' : 'column'}\n      style={{ opacity: 1 }} // need this to make animations work on android\n    >\n      <View>\n        {canBet && (\n          <Image\n            w={1.6}\n            h={1.6}\n            position={'absolute'}\n            style={{ top: sizing(-0.1), right: sizing(-0.4) }}\n            source={coinImage}\n          />\n        )}\n        <PostButton\n          canBet={canBet}\n          tooltipData={tooltipData}\n          key={`${post.id}-up`}\n          imageSet=\"UPVOTE\"\n          isActive={voteStatus.up}\n          alt=\"upvote\"\n          color={color}\n          onPress={e => castVote(e, voteStatus.vote, 1)}\n        />\n      </View>\n      <PostRank horizontal={horizontal} color={color} post={post} />\n      <PostButton\n        tooltipData={tooltipData}\n        key={`${post.id}-down`}\n        imageSet=\"DOWNVOTE\"\n        isActive={voteStatus.down}\n        alt=\"downvote\"\n        color={color}\n        onPress={e => castVote(e, voteStatus.vote, -1)}\n      />\n    </View>\n  );\n}\n\nfunction getVoteStatus(user, post) {\n  const ownPost = user && user._id === post.user;\n  const vote = ownPost ? true : post.myVote;\n  return {\n    vote,\n    up: vote && vote.amount > 0,\n    down: vote && vote.amount < 0\n  };\n}\n\nfunction getTooltipData(post) {\n  const postType = getPostType({ post });\n  const tipText =\n    postType === 'link'\n      ? 'Upvote articles that are worth reading, downvote spam.'\n      : `Upvote quality ${postType}s and downvote spam`;\n\n  return {\n    text: tipText,\n    position: 'right',\n    desktopOnly: true\n  };\n}\n\nfunction getCanBet({ post, community, user }) {\n  if (!post) return false;\n  const now = new Date();\n  const bettingEnabled = community && community.betEnabled;\n  const manualBet = user && user.notificationSettings.bet.manual;\n  return (\n    manualBet &&\n    bettingEnabled &&\n    post.data &&\n    post.data.eligibleForReward &&\n    now.getTime() < new Date(post.data.payoutTime).getTime()\n  );\n}\n"],"file":"postbuttons.container.js"}