{"version":3,"sources":["../../../../src/modules/createPost/mobile/createPostHeaderRight.component.js"],"names":["Analytics","styles","CreatePostHeaderRight","props","context","createPost","allTags","bodyTags","postBody","editPost","tags","Set","body","mentions","bodyMentions","actions","res","Error","Alert","alert","clearCreatePost","navigation","navigate","setUserSearch","message","state","creatingPost","rightButtonAction","bind","uploadPost","prev","edit","postUrl","newUrl","skipUrl","urlPreview","text","onPress","repost","createRepost","enableNext","Keyboard","dismiss","routeName","params","title","next","commentObj","post","_id","setState","createComment","then","screenProps","close","popToTop","setScrollTab","tab","reloadTab","image","length","nativeImage","utils","s3","toS3Advanced","results","success","url","catch","err","postImage","link","map","tag","trim","description","category","postCategory","domain","keywords","articleAuthor","shortText","submitPost","logEvent","viaShare","share","hasBody","enabledNext","rightText","enabled","rightAction","p","rightButton","opacity","active","rightButtonText","Component","PropTypes","object","bool","localStyles","StyleSheet","create","flex","marginRight","mainPadding","paddingVertical","justifyContent","textAlign","fontSize","fontFamily","paddingRight","globalStyles","mapStateToProps","mapDispatchToProps","dispatch","commentActions","navigationActions","createPostActions","postActions","userActions"],"mappings":"8rCAAA,qDACA,gDACA,6DACA,0DACA,4BACA,uCACA,gFACA,4EACA,qFACA,4EACA,8FACA,6DACA,8C,0nDAEA,GAAMA,CAAAA,SAAS,CAAG,oCAAlB,CAEA,GAAIC,CAAAA,MAAJ,C,GAEMC,CAAAA,qB,8HAeJ,+BAAYC,MAAZ,CAAmBC,OAAnB,CAA4B,oEAC1B,uBAAMD,MAAN,CAAaC,OAAb,EAD0B,4IA0DjB,2NAEDD,KAFC,CAEO,MAAKA,KAAL,CAAWE,UAFlB,gBAGiCF,KAHjC,CAGCG,OAHD,CAGCA,OAHD,yBAGW,EAHX,gCAGiCH,KAHjC,CAGeI,QAHf,CAGeA,QAHf,0BAG0B,EAH1B,iBAIDC,QAJC,gCAKFL,KAAK,CAACM,QALJ,MAMLC,IAAI,iCAAM,GAAIC,CAAAA,GAAJ,2CAAYL,OAAZ,kCAAwBC,QAAxB,GAAN,CANC,CAOLK,IAAI,CAAET,KAAK,CAACK,QAPP,CAQLK,QAAQ,CAAEV,KAAK,CAACW,YARX,yBAUW,OAAKX,KAAL,CAAWY,OAAX,CAAmBN,QAAnB,CAA4BD,QAA5B,CAVX,QAUDQ,GAVC,kBAWFA,GAXE,8BAWS,IAAIC,CAAAA,KAAJ,CAAU,0CAAV,CAXT,QAYPC,sBAAMC,KAAN,CAAY,UAAZ,EACA,MAAKhB,KAAL,CAAWY,OAAX,CAAmBK,eAAnB,GACA,MAAKjB,KAAL,CAAWkB,UAAX,CAAsBC,QAAtB,CAA+B,MAA/B,EACA,MAAKnB,KAAL,CAAWY,OAAX,CAAmBQ,aAAnB,CAAiC,EAAjC,EAfO,iFAiBPL,sBAAMC,KAAN,CAAY,YAAIK,OAAhB,EAjBO,qEA1DiB,IAG1B,MAAKC,KAAL,CAAa,CACXC,YAAY,CAAE,KADH,CAAb,CAIA,MAAKC,iBAAL,CAAyB,MAAKA,iBAAL,CAAuBC,IAAvB,4CAAzB,CACA,MAAKC,UAAL,CAAkB,MAAKA,UAAL,CAAgBD,IAAhB,4CAAlB,CACA,MAAKvB,UAAL,CAAkB,MAAKA,UAAL,CAAgBuB,IAAhB,4CAAlB,CAT0B,aAU3B,C,6GAEkBE,I,CAAM,IACfzB,CAAAA,UADe,CACA,KAAKF,KADL,CACfE,UADe,IAEf0B,CAAAA,IAFe,CAEG1B,UAFH,CAEf0B,IAFe,CAETC,OAFS,CAEG3B,UAFH,CAET2B,OAFS,CAGvB,GAAID,IAAI,EAAIC,OAAO,GAAKF,IAAI,CAACzB,UAAL,CAAgB2B,OAAxC,CAAiD,CAC/C,KAAKC,MAAL,CAAc,IAAd,CACD,CACF,C,4DAEiB9B,K,CAAO,iBACvB,GACE,CAAC,KAAK+B,OAAN,EACA,KAAK/B,KAAL,CAAWE,UAAX,CAAsB2B,OADtB,EAEA,CAAC,KAAK7B,KAAL,CAAWE,UAAX,CAAsB8B,UAHzB,CAIE,CACAjB,sBAAMC,KAAN,CAAY,yDAAZ,CAAuE,IAAvE,CAA6E,CAC3E,CACEiB,IAAI,CAAE,iBADR,CAEEC,OAAO,CAAE,kBAAM,CACb,MAAI,CAACH,OAAL,CAAe,IAAf,CACA,MAAO,CAAA,MAAI,CAACP,iBAAL,CAAuB,IAAvB,CAAP,CACD,CALH,CAD2E,CAQ3E,CAAES,IAAI,CAAE,MAAR,CAAgBC,OAAO,CAAE,yBAAM,KAAN,EAAzB,CAR2E,CAA7E,EAUA,MAAO,KAAP,CACD,CACD,KAAKH,OAAL,CAAe,KAAf,CAEA,GAAI,KAAK/B,KAAL,CAAWE,UAAX,CAAsBiC,MAA1B,CAAkC,MAAO,MAAKC,YAAL,EAAP,CAClC,GAAI,KAAKpC,KAAL,CAAWE,UAAX,CAAsB0B,IAAtB,EAA8B,CAAC,KAAKE,MAAxC,CAAgD,CAC9C,MAAO,MAAKxB,QAAL,EAAP,CACD,CAED,GAAI,KAAK+B,UAAT,CAAqB,CACnBC,yBAASC,OAAT,GACAvC,KAAK,CAACkB,UAAN,CAAiBC,QAAjB,CAA0B,CACxBqB,SAAS,CAAE,gBADa,CAExBC,MAAM,CAAE,CACNC,KAAK,CAAE,eADD,CAENC,IAAI,CAAE,MAFA,CAFgB,CAA1B,EAOD,CACD,MAAO,KAAP,CACD,C,mDAuBc,iBACb,GAAI,KAAKrB,KAAL,CAAWC,YAAf,CAA6B,OAE7B,GAAMvB,CAAAA,KAAK,CAAG,KAAKA,KAAL,CAAWE,UAAzB,CAEA,GAAM0C,CAAAA,UAAU,CAAG,CACjBC,IAAI,CAAE7C,KAAK,CAACmC,MAAN,CAAaW,GADF,CAEjBb,IAAI,CAAEjC,KAAK,CAACK,QAFK,CAGjB8B,MAAM,CAAE,IAHS,CAAnB,CAKA,KAAKY,QAAL,CAAc,CAAExB,YAAY,CAAE,IAAhB,CAAd,EACA,KAAKvB,KAAL,CAAWY,OAAX,CAAmBoC,aAAnB,CAAiCJ,UAAjC,EAA6CK,IAA7C,CAAkD,UAAM,CACtD,MAAI,CAACjD,KAAL,CAAWY,OAAX,CAAmBK,eAAnB,GACA,MAAI,CAACjB,KAAL,CAAWY,OAAX,CAAmBQ,aAAnB,CAAiC,EAAjC,EACA,MAAI,CAAC2B,QAAL,CAAc,CAAExB,YAAY,CAAE,KAAhB,CAAd,EAEA,GAAI,MAAI,CAACvB,KAAL,CAAWkD,WAAX,CAAuBC,KAA3B,CAAkC,CAChC,MAAO,CAAA,MAAI,CAACnD,KAAL,CAAWkD,WAAX,CAAuBC,KAAvB,EAAP,CACD,CAED,MAAI,CAACnD,KAAL,CAAWkB,UAAX,CAAsBC,QAAtB,CAA+B,MAA/B,EACA,MAAI,CAACnB,KAAL,CAAWkB,UAAX,CAAsBC,QAAtB,CAA+B,UAA/B,EACA,MAAI,CAACnB,KAAL,CAAWkB,UAAX,CAAsBkC,QAAtB,GACA,MAAI,CAACpD,KAAL,CAAWY,OAAX,CAAmByC,YAAnB,CAAgC,UAAhC,CAA4C,CAAEC,GAAG,CAAE,CAAP,CAA5C,EACA,MAAI,CAACtD,KAAL,CAAWY,OAAX,CAAmB2C,SAAnB,CAA6B,UAA7B,EACA,MAAO,KAAP,CACD,CAfD,EAgBD,C,+CAEY,iBACX,GAAI,KAAKjC,KAAL,CAAWC,YAAf,CAA6B,OAE7B,GAAMvB,CAAAA,KAAK,CAAG,KAAKA,KAAL,CAAWE,UAAzB,CACA,KAAKsD,KAAL,CAAa,IAAb,CAEA,GAAI,CAACxD,KAAK,CAACG,OAAN,CAAcsD,MAAnB,CAA2B,CACzB1C,sBAAMC,KAAN,CAAY,gCAAZ,EACA,OACD,CAED,KAAK+B,QAAL,CAAc,CAAExB,YAAY,CAAE,IAAhB,CAAd,EACA,GAAIvB,KAAK,CAACgC,UAAN,EAAoBhC,KAAK,CAACgC,UAAN,CAAiBwB,KAArC,EAA8C,CAACxD,KAAK,CAAC0D,WAAzD,CAAsE,CACpEC,KAAK,CAACC,EAAN,CACGC,YADH,CACgB7D,KAAK,CAACgC,UAAN,CAAiBwB,KADjC,EAEGP,IAFH,CAEQ,SAAAa,OAAO,CAAI,CACf,GAAIA,OAAO,CAACC,OAAZ,CAAqB,CACnB,MAAI,CAACP,KAAL,CAAaM,OAAO,CAACE,GAArB,CACA,MAAI,CAACtC,UAAL,GACD,CAHD,IAGO,CACLX,sBAAMC,KAAN,CAAY,yCAAZ,EACA,MAAI,CAAC+B,QAAL,CAAc,CAAExB,YAAY,CAAE,KAAhB,CAAd,EACD,CACF,CAVH,EAWG0C,KAXH,CAWS,SAAAC,GAAG,CAAI,CACZnD,sBAAMC,KAAN,CAAY,yBAAZ,CAAuCkD,GAAG,CAAC7C,OAA3C,EACA,MAAI,CAAC0B,QAAL,CAAc,CAAExB,YAAY,CAAE,KAAhB,CAAd,EACD,CAdH,EAeD,CAhBD,IAgBO,CACL,KAAKiC,KAAL,CACExD,KAAK,CAACgC,UAAN,EAAoBhC,KAAK,CAACgC,UAAN,CAAiBwB,KAArC,CACIxD,KAAK,CAACgC,UAAN,CAAiBwB,KADrB,CAEIxD,KAAK,CAACmE,SAHZ,CAIA,KAAKzC,UAAL,GACD,CACF,C,+CAEY,iBACX,GAAM1B,CAAAA,KAAK,CAAG,KAAKA,KAAL,CAAWE,UAAzB,CACA,GAAIG,CAAAA,QAAQ,CAAG,CACb+D,IAAI,CAAEpE,KAAK,CAAC6B,OADC,CAEbtB,IAAI,iCAAM,GAAIC,CAAAA,GAAJ,2CAAYR,KAAK,CAACG,OAAN,CAAckE,GAAd,CAAkB,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACxB,GAAR,EAArB,CAAZ,kCAAkD9C,KAAK,CAACI,QAAxD,GAAN,CAFS,CAGbK,IAAI,CAAET,KAAK,CAACK,QAHC,CAIbqC,KAAK,CAAE1C,KAAK,CAACgC,UAAN,CAAmBhC,KAAK,CAACgC,UAAN,CAAiBU,KAAjB,CAAuB6B,IAAvB,EAAnB,CAAmD,IAJ7C,CAKbC,WAAW,CAAExE,KAAK,CAACgC,UAAN,CAAmBhC,KAAK,CAACgC,UAAN,CAAiBwC,WAApC,CAAkD,IALlD,CAMbC,QAAQ,CAAEzE,KAAK,CAAC0E,YANH,CAOblB,KAAK,CAAE,KAAKA,KAPC,CAQb9C,QAAQ,CAAEV,KAAK,CAACW,YARH,CASbgE,MAAM,CAAE3E,KAAK,CAAC2E,MATD,CAUbC,QAAQ,CAAE5E,KAAK,CAAC4E,QAVH,CAWbC,aAAa,CAAE7E,KAAK,CAAC6E,aAXR,CAYbC,SAAS,CAAE9E,KAAK,CAAC8E,SAZJ,CAAf,CAeA,GAAI9E,KAAK,CAAC4B,IAAV,CAAgB,CACdvB,QAAQ,gCAAQL,KAAK,CAACM,QAAd,EAA2BD,QAA3B,CAAR,CACA,MAAO,MAAKL,KAAL,CAAWY,OAAX,CAAmBN,QAAnB,CAA4BD,QAA5B,EAAsC4C,IAAtC,CAA2C,SAAApC,GAAG,CAAI,CACvD,GAAI,CAACA,GAAL,CAAU,OACVE,sBAAMC,KAAN,CAAY,UAAZ,EACA,MAAI,CAAChB,KAAL,CAAWY,OAAX,CAAmBK,eAAnB,GACA,MAAI,CAACjB,KAAL,CAAWkB,UAAX,CAAsBC,QAAtB,CAA+B,MAA/B,EACA,MAAI,CAACnB,KAAL,CAAWY,OAAX,CAAmBQ,aAAnB,CAAiC,EAAjC,EACD,CANM,CAAP,CAOD,CAED,KAAKpB,KAAL,CAAWY,OAAX,CAAmBmE,UAAnB,CAA8B1E,QAA9B,EAAwC4C,IAAxC,CAA6C,SAAAa,OAAO,CAAI,CACtD,GAAI,CAACA,OAAL,CAAc,CACZ/C,sBAAMC,KAAN,CAAY,6BAAZ,EACA,MAAO,CAAA,MAAI,CAAC+B,QAAL,CAAc,CAAExB,YAAY,CAAE,KAAhB,CAAd,CAAP,CACD,CAED,MAAI,CAACvB,KAAL,CAAWY,OAAX,CAAmBQ,aAAnB,CAAiC,EAAjC,EACA,MAAI,CAACpB,KAAL,CAAWY,OAAX,CAAmBK,eAAnB,GACApB,SAAS,CAACmF,QAAV,CAAmB,SAAnB,CAA8B,CAC5BC,QAAQ,CAAE,MAAI,CAACjF,KAAL,CAAWkF,KADO,CAA9B,EAIA,GAAI,MAAI,CAAClF,KAAL,CAAWkD,WAAX,CAAuBC,KAA3B,CAAkC,CAChC,MAAO,CAAA,MAAI,CAACnD,KAAL,CAAWkD,WAAX,CAAuBC,KAAvB,EAAP,CACD,CAED,MAAI,CAACnD,KAAL,CAAWkB,UAAX,CAAsBC,QAAtB,CAA+B,MAA/B,EACA,MAAI,CAACnB,KAAL,CAAWkB,UAAX,CAAsBC,QAAtB,CAA+B,UAA/B,EACA,MAAI,CAACnB,KAAL,CAAWkB,UAAX,CAAsBkC,QAAtB,GACA,MAAI,CAACpD,KAAL,CAAWY,OAAX,CAAmB2C,SAAnB,CAA6B,UAA7B,EACA,MAAI,CAACvD,KAAL,CAAWY,OAAX,CAAmByC,YAAnB,CAAgC,UAAhC,CAA4C,CAAEC,GAAG,CAAE,CAAP,CAA5C,EACA,MAAO,KAAP,CACD,CAtBD,EAuBA,MAAO,KAAP,CACD,C,uCAEQ,oBACChC,CAAAA,KADD,CACW,KAAKtB,KAAL,CAAWkB,UADtB,CACCI,KADD,IAECmB,CAAAA,MAFD,CAEYnB,KAFZ,CAECmB,MAFD,IAGCpC,CAAAA,QAHD,CAGc,KAAKL,KAAL,CAAWE,UAHzB,CAGCG,QAHD,CAKP,GAAIiB,KAAK,CAACkB,SAAN,GAAoB,WAAxB,CAAqC,CACnC,MAAO,KAAP,CACD,CAED,KAAKH,UAAL,CAAkB,KAAlB,CACA,GAAM8C,CAAAA,OAAO,CAAG9E,QAAQ,EAAIA,QAAQ,CAACkE,IAAT,GAAgBd,MAA5C,CACA,GAAI0B,OAAJ,CAAa,CACX,KAAK9C,UAAL,CAAkB,IAAlB,CACD,CAED,GAAI,KAAKf,KAAL,CAAWC,YAAf,CAA6B,KAAK6D,WAAL,CAAmB,KAAnB,CAE7B,GAAMC,CAAAA,SAAS,CAAG5C,MAAM,EAAIA,MAAM,CAACE,IAAjB,CAAwBF,MAAM,CAACE,IAA/B,CAAsC,MAAxD,CAEA,GAAI2C,CAAAA,OAAJ,CACA,GAAIC,CAAAA,WAAJ,CAEA,GAAIjE,KAAK,CAACkB,SAAN,GAAoB,eAAxB,CAAyC,CACvC8C,OAAO,CAAG,KAAKjD,UAAf,CACAkD,WAAW,CAAG,qBAAAC,CAAC,QAAI,CAAA,MAAI,CAAChE,iBAAL,CAAuBgE,CAAvB,CAAJ,EAAf,CACD,CAHD,IAGO,CACLF,OAAO,CAAG,KAAKtF,KAAL,CAAWE,UAAX,CAAsBC,OAAtB,CAA8BsD,MAA9B,EAAwC,CAAC,KAAKnC,KAAL,CAAWC,YAA9D,CACAgE,WAAW,CAAG,6BAAM,CAAA,MAAI,CAACrF,UAAL,EAAN,EAAd,CACD,CAED,MACE,8BAAC,gCAAD,EACE,GAAG,CAAEoB,KAAK,CAACkB,SADb,CAEE,KAAK,CAAE,CAAC1C,MAAM,CAAC2F,WAAR,CAFT,CAGE,OAAO,CAAE,yBAAMF,CAAAA,WAAW,CAAC,MAAI,CAACvF,KAAN,CAAjB,EAHX,iEAKE,6BAAC,oBAAD,EACE,KAAK,CAAE,CAAC,CAAE0F,OAAO,CAAEJ,OAAO,CAAG,CAAH,CAAO,GAAzB,CAAD,CAAiCxF,MAAM,CAAC6F,MAAxC,CAAgD7F,MAAM,CAAC8F,eAAvD,CADT,iEAGGP,SAHH,CALF,CADF,CAaD,C,mCAjQiCQ,gB,+BAA9B9F,qB,aACe,CACjBa,OAAO,CAAEkF,mBAAUC,MADF,CAEjB7F,UAAU,CAAE4F,mBAAUC,MAFL,CAGjB7E,UAAU,CAAE4E,mBAAUC,MAHL,CAIjB7C,WAAW,CAAE4C,mBAAUC,MAJN,CAKjBb,KAAK,CAAEY,mBAAUE,IALA,CAMjB1F,QAAQ,CAAEwF,mBAAUC,MANH,CAOjB1F,QAAQ,CAAEyF,mBAAUC,MAPH,CAQjB5D,MAAM,CAAE2D,mBAAUC,MARD,CASjB/D,UAAU,CAAE8D,mBAAUC,MATL,CAUjBlE,OAAO,CAAEiE,mBAAUC,MAVF,CAWjBnE,IAAI,CAAEkE,mBAAUE,IAXC,C,EAmQrB,GAAMC,CAAAA,WAAW,CAAGC,2BAAWC,MAAX,CAAkB,CACpCV,WAAW,CAAE,CACXW,IAAI,CAAE,CADK,CAEXC,WAAW,CAAEC,oBAAc,EAFhB,CAGXC,eAAe,CAAE,EAHN,CAIXC,cAAc,CAAE,QAJL,CADuB,CAOpCZ,eAAe,CAAE,CACfa,SAAS,CAAE,OADI,CAEfC,QAAQ,CAAE,EAFK,CAGfC,UAAU,CAAE,WAHG,CAIfC,YAAY,CAAE,EAJC,CAPmB,CAAlB,CAApB,CAeA9G,MAAM,gCAAQmG,WAAR,EAAwBY,oBAAxB,CAAN,CAEA,QAASC,CAAAA,eAAT,CAAyBxF,KAAzB,CAAgC,CAC9B,MAAO,CACLpB,UAAU,CAAEoB,KAAK,CAACpB,UADb,CAAP,CAGD,CAED,QAAS6G,CAAAA,kBAAT,CAA4BC,QAA5B,CAAsC,CACpC,MAAO,CACLpG,OAAO,CAAE,uGAEFqG,cAFE,EAGFC,iBAHE,EAIFC,iBAJE,EAKFC,WALE,EAMFC,WANE,EAQPL,QARO,CADJ,CAAP,CAYD,C,aAEc,wBAAQF,eAAR,CAAyBC,kBAAzB,EAA6ChH,qBAA7C,C","sourcesContent":["import React, { Component } from 'react';\nimport { StyleSheet, Text, TouchableOpacity, Alert, Keyboard } from 'react-native';\nimport PropTypes from 'prop-types';\nimport { analytics } from 'react-native-firebase';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport * as createPostActions from 'modules/createPost/createPost.actions';\nimport * as postActions from 'modules/post/post.actions';\nimport * as commentActions from 'modules/comment/comment.actions';\nimport * as userActions from 'modules/user/user.actions';\nimport * as navigationActions from 'modules/navigation/navigation.actions';\nimport * as utils from 'app/utils';\nimport { globalStyles, mainPadding } from 'app/styles/global';\n\nconst Analytics = analytics();\n\nlet styles;\n\nclass CreatePostHeaderRight extends Component {\n  static propTypes = {\n    actions: PropTypes.object,\n    createPost: PropTypes.object,\n    navigation: PropTypes.object,\n    screenProps: PropTypes.object,\n    share: PropTypes.bool,\n    editPost: PropTypes.object,\n    postBody: PropTypes.object,\n    repost: PropTypes.object,\n    urlPreview: PropTypes.object,\n    postUrl: PropTypes.object,\n    edit: PropTypes.bool\n  };\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      creatingPost: false\n    };\n\n    this.rightButtonAction = this.rightButtonAction.bind(this);\n    this.uploadPost = this.uploadPost.bind(this);\n    this.createPost = this.createPost.bind(this);\n  }\n\n  componentDidUpdate(prev) {\n    const { createPost } = this.props;\n    const { edit, postUrl } = createPost;\n    if (edit && postUrl !== prev.createPost.postUrl) {\n      this.newUrl = true;\n    }\n  }\n\n  rightButtonAction(props) {\n    if (\n      !this.skipUrl &&\n      this.props.createPost.postUrl &&\n      !this.props.createPost.urlPreview\n    ) {\n      Alert.alert('Url is still loading, please give it a few more seconds', null, [\n        {\n          text: 'Continue Anyway',\n          onPress: () => {\n            this.skipUrl = true;\n            return this.rightButtonAction(true);\n          }\n        },\n        { text: 'Wait', onPress: () => null }\n      ]);\n      return null;\n    }\n    this.skipUrl = false;\n\n    if (this.props.createPost.repost) return this.createRepost();\n    if (this.props.createPost.edit && !this.newUrl) {\n      return this.editPost();\n    }\n\n    if (this.enableNext) {\n      Keyboard.dismiss();\n      props.navigation.navigate({\n        routeName: 'createPostTags',\n        params: {\n          title: 'Post Category',\n          next: 'Post'\n        }\n      });\n    }\n    return null;\n  }\n\n  editPost = async () => {\n    try {\n      const props = this.props.createPost;\n      const { allTags = [], bodyTags = [] } = props;\n      const postBody = {\n        ...props.editPost,\n        tags: [...new Set([...allTags, ...bodyTags])],\n        body: props.postBody,\n        mentions: props.bodyMentions\n      };\n      const res = await this.props.actions.editPost(postBody);\n      if (!res) throw new Error('Something went wrong... please try again');\n      Alert.alert('Success!');\n      this.props.actions.clearCreatePost();\n      this.props.navigation.navigate('main');\n      this.props.actions.setUserSearch([]);\n    } catch (err) {\n      Alert.alert(err.message);\n    }\n  };\n\n  createRepost() {\n    if (this.state.creatingPost) return;\n\n    const props = this.props.createPost;\n\n    const commentObj = {\n      post: props.repost._id,\n      text: props.postBody,\n      repost: true\n    };\n    this.setState({ creatingPost: true });\n    this.props.actions.createComment(commentObj).then(() => {\n      this.props.actions.clearCreatePost();\n      this.props.actions.setUserSearch([]);\n      this.setState({ creatingPost: false });\n\n      if (this.props.screenProps.close) {\n        return this.props.screenProps.close();\n      }\n\n      this.props.navigation.navigate('main');\n      this.props.navigation.navigate('discover');\n      this.props.navigation.popToTop();\n      this.props.actions.setScrollTab('discover', { tab: 0 });\n      this.props.actions.reloadTab('discover');\n      return null;\n    });\n  }\n\n  createPost() {\n    if (this.state.creatingPost) return;\n\n    const props = this.props.createPost;\n    this.image = null;\n\n    if (!props.allTags.length) {\n      Alert.alert('Please select at least one tag');\n      return;\n    }\n\n    this.setState({ creatingPost: true });\n    if (props.urlPreview && props.urlPreview.image && !props.nativeImage) {\n      utils.s3\n        .toS3Advanced(props.urlPreview.image)\n        .then(results => {\n          if (results.success) {\n            this.image = results.url;\n            this.uploadPost();\n          } else {\n            Alert.alert('Error uploading image, please try again');\n            this.setState({ creatingPost: false });\n          }\n        })\n        .catch(err => {\n          Alert.alert('Error uploading image: ', err.message);\n          this.setState({ creatingPost: false });\n        });\n    } else {\n      this.image =\n        props.urlPreview && props.urlPreview.image\n          ? props.urlPreview.image\n          : props.postImage;\n      this.uploadPost();\n    }\n  }\n\n  uploadPost() {\n    const props = this.props.createPost;\n    let postBody = {\n      link: props.postUrl,\n      tags: [...new Set([...props.allTags.map(tag => tag._id), ...props.bodyTags])],\n      body: props.postBody,\n      title: props.urlPreview ? props.urlPreview.title.trim() : null,\n      description: props.urlPreview ? props.urlPreview.description : null,\n      category: props.postCategory,\n      image: this.image,\n      mentions: props.bodyMentions,\n      domain: props.domain,\n      keywords: props.keywords,\n      articleAuthor: props.articleAuthor,\n      shortText: props.shortText\n    };\n\n    if (props.edit) {\n      postBody = { ...props.editPost, ...postBody };\n      return this.props.actions.editPost(postBody).then(res => {\n        if (!res) return;\n        Alert.alert('Success!');\n        this.props.actions.clearCreatePost();\n        this.props.navigation.navigate('main');\n        this.props.actions.setUserSearch([]);\n      });\n    }\n\n    this.props.actions.submitPost(postBody).then(results => {\n      if (!results) {\n        Alert.alert('Post error please try again');\n        return this.setState({ creatingPost: false });\n      }\n\n      this.props.actions.setUserSearch([]);\n      this.props.actions.clearCreatePost();\n      Analytics.logEvent('newPost', {\n        viaShare: this.props.share\n      });\n\n      if (this.props.screenProps.close) {\n        return this.props.screenProps.close();\n      }\n\n      this.props.navigation.navigate('main');\n      this.props.navigation.navigate('discover');\n      this.props.navigation.popToTop();\n      this.props.actions.reloadTab('discover');\n      this.props.actions.setScrollTab('discover', { tab: 0 });\n      return null;\n    });\n    return null;\n  }\n\n  render() {\n    const { state } = this.props.navigation;\n    const { params } = state;\n    const { postBody } = this.props.createPost;\n\n    if (state.routeName === 'shareAuth') {\n      return null;\n    }\n\n    this.enableNext = false;\n    const hasBody = postBody && postBody.trim().length;\n    if (hasBody) {\n      this.enableNext = true;\n    }\n\n    if (this.state.creatingPost) this.enabledNext = false;\n\n    const rightText = params && params.next ? params.next : 'Post';\n\n    let enabled;\n    let rightAction;\n\n    if (state.routeName === 'createPostUrl') {\n      enabled = this.enableNext;\n      rightAction = p => this.rightButtonAction(p);\n    } else {\n      enabled = this.props.createPost.allTags.length && !this.state.creatingPost;\n      rightAction = () => this.createPost();\n    }\n\n    return (\n      <TouchableOpacity\n        key={state.routeName}\n        style={[styles.rightButton]}\n        onPress={() => rightAction(this.props)}\n      >\n        <Text\n          style={[{ opacity: enabled ? 1 : 0.6 }, styles.active, styles.rightButtonText]}\n        >\n          {rightText}\n        </Text>\n      </TouchableOpacity>\n    );\n  }\n}\n\nconst localStyles = StyleSheet.create({\n  rightButton: {\n    flex: 1,\n    marginRight: mainPadding - 10,\n    paddingVertical: 10,\n    justifyContent: 'center'\n  },\n  rightButtonText: {\n    textAlign: 'right',\n    fontSize: 17,\n    fontFamily: 'Helvetica',\n    paddingRight: 10\n  }\n});\n\nstyles = { ...localStyles, ...globalStyles };\n\nfunction mapStateToProps(state) {\n  return {\n    createPost: state.createPost\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...commentActions,\n        ...navigationActions,\n        ...createPostActions,\n        ...postActions,\n        ...userActions\n      },\n      dispatch\n    )\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CreatePostHeaderRight);\n"],"file":"createPostHeaderRight.component.js"}