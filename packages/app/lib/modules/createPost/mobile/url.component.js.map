{"version":3,"sources":["../../../../src/modules/createPost/mobile/url.component.js"],"names":["ActionSheet","ActionSheetIOS","Platform","OS","RNBottomSheet","showActionSheetWithOptions","showBottomSheetWithOptions","styles","UrlComponent","props","context","actions","setCreatePostState","urlPreview","postUrl","disableUrl","postBody","setTimeout","processInput","edit","repost","options","cancelButtonIndex","destructiveButtonIndex","buttonIndex","removeUrlPreview","generatePreviewServer","results","Error","domain","url","inputUrl","keywords","postTags","tags","articleAuthor","shortText","image","title","description","Alert","alert","message","setMention","bind","previousPostLength","toggleTooltip","initTooltips","createPreview","InteractionManager","runAfterInteractions","length","getParentTags","prev","navigation","isFocused","input","blur","Keyboard","dismiss","focus","name","setTooltipData","toggle","parentEl","measureInWindow","x","y","w","h","parent","showTooltip","user","replace","mention","handle","setUserSearch","doneTyping","shouldParseUrl","prevLength","mentions","newUrl","bodyTags","bodyMentions","words","lastWord","match","searchUser","addTagsAndMentions","urlPlaceholder","userHeader","share","createPostUser","innerBorder","paddingVertical","userSearch","users","search","flex","maxHeight","addP","postButton","font12","active","tipCTA","c","shareTip","postButtonShare","textAlign","scrollView","paddingHorizontal","mainPadding","backgroundColor","colors","white","flexGrow","height","minHeight","marginTop","font15","createPostInput","greyText","_postBody","okToSubmit","enableUrlPreview","color","blue","position","bottom","right","marginVertical","previewMenu","Component","PropTypes","string","object","bool","array","localStyles","StyleSheet","create","textP","marginBottom","videoTip","borderColor","borderWidth","hairlineWidth","flexDirection","alignItems","padding","left","borderRadius","borderBottomWidth","borderBottomColor","borderGrey","noBorder","inputBox","globalStyles","mapStateToProps","state","auth","createPost","parentTags","mapDispatchToProps","dispatch","createPostActions","tagActions","userActions","tooltipActions"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n  StyleSheet,\n  TextInput,\n  View,\n  Text,\n  TouchableHighlight,\n  Platform,\n  ScrollView,\n  InteractionManager,\n  ActionSheetIOS,\n  Alert,\n  Keyboard\n} from 'react-native';\nimport PropTypes from 'prop-types';\nimport { globalStyles, mainPadding, greyText, borderGrey } from 'app/styles/global';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { NavigationEvents } from 'react-navigation';\nimport * as createPostActions from 'modules/createPost/createPost.actions';\nimport * as tagActions from 'modules/tag/tag.actions';\nimport * as userActions from 'modules/user/user.actions';\nimport * as tooltipActions from 'modules/tooltip/tooltip.actions';\n\nimport { getTextData, getWords } from 'app/utils/text';\nimport Avatar from 'modules/user/avatarbox.component';\nimport TextBody from 'modules/text/mobile/textBody.component';\nimport RNBottomSheet from 'react-native-bottomsheet';\nimport { colors } from 'styles';\n\nimport UserSearchComponent from './userSearch.component';\nimport UrlPreview from './urlPreview.component';\n\nlet ActionSheet = ActionSheetIOS;\n\nif (Platform.OS === 'android') {\n  ActionSheet = RNBottomSheet;\n  ActionSheet.showActionSheetWithOptions = RNBottomSheet.showBottomSheetWithOptions;\n}\n\nlet styles;\n\nclass UrlComponent extends Component {\n  static propTypes = {\n    postUrl: PropTypes.string,\n    createPreview: PropTypes.object,\n    postBody: PropTypes.string,\n    urlPreview: PropTypes.object,\n    share: PropTypes.bool,\n    actions: PropTypes.object,\n    repost: PropTypes.object,\n    edit: PropTypes.bool,\n    users: PropTypes.object,\n    user: PropTypes.object,\n    tags: PropTypes.array,\n    disableUrl: PropTypes.bool,\n    navigation: PropTypes.object\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.setMention = this.setMention.bind(this);\n    this.previousPostLength = 0;\n    this.toggleTooltip = this.toggleTooltip.bind(this);\n    this.initTooltips = this.initTooltips.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.postUrl) {\n      this.createPreview(this.props.postUrl);\n    }\n    setTimeout(() => this.initTooltips('shareTip'), 1000);\n    InteractionManager.runAfterInteractions(() => {\n      if (!this.props.tags.length) this.props.actions.getParentTags();\n    });\n  }\n\n  componentDidUpdate(prev) {\n    const { createPreview, postUrl, navigation } = this.props;\n\n    if (Platform.OS === 'android' && !navigation.isFocused()) {\n      this.input.blur();\n      Keyboard.dismiss();\n    }\n    if (createPreview !== prev.createPreview && postUrl) {\n      this.createPreview(postUrl);\n      this.input.focus();\n    }\n  }\n\n  componentWillUnmount() {\n    this.input.blur();\n  }\n\n  removeUrlPreview = () => {\n    this.props.actions.setCreatePostState({\n      urlPreview: null,\n      postUrl: null,\n      disableUrl: true\n    });\n  };\n\n  enableUrlPreview = () => {\n    const { postBody } = this.props;\n    this.props.actions.setCreatePostState({ disableUrl: false });\n    setTimeout(() => this.processInput(postBody), 1);\n  };\n\n  previewMenu = () => {\n    if (this.props.edit || this.props.repost) return;\n    ActionSheet.showActionSheetWithOptions(\n      {\n        options: ['Remove Url', 'Cancel'],\n        cancelButtonIndex: 1,\n        destructiveButtonIndex: 0\n      },\n      buttonIndex => {\n        switch (buttonIndex) {\n          case 0:\n            this.removeUrlPreview();\n            break;\n          default:\n        }\n      }\n    );\n  };\n\n  initTooltips(name) {\n    this.props.actions.setTooltipData({\n      name,\n      toggle: () => this.toggleTooltip(this[name], name)\n    });\n  }\n\n  toggleTooltip(parentEl, name) {\n    if (!parentEl) return;\n    parentEl.measureInWindow((x, y, w, h) => {\n      const parent = { x, y, w, h };\n      if (x + y + w + h === 0) return;\n      this.props.actions.setTooltipData({\n        name,\n        parent\n      });\n      this.props.actions.showTooltip(name);\n    });\n  }\n\n  setMention(user) {\n    const postBody = this.props.postBody.replace(this.mention, '@' + user.handle);\n    this.props.actions.setCreatePostState({ postBody });\n    this.props.actions.setUserSearch([]);\n    this.input.focus();\n  }\n\n  processInput(postBody, doneTyping) {\n    const { disableUrl, postUrl } = this.props;\n    const length = postBody ? postBody.length : 0;\n\n    if (doneTyping) postBody = this.props.postBody;\n    let shouldParseUrl = false;\n    const prevLength = this.props.postBody.length || 0;\n    if (length - prevLength > 1) shouldParseUrl = true;\n\n    // eslint-disable-next-line\n    if (postBody[postBody.length - 1] == ' ') shouldParseUrl = true;\n    // eslint-disable-next-line\n    if (postBody[postBody.length - 1] == '\\n') shouldParseUrl = true;\n\n    const { tags, mentions, url } = getTextData(postBody);\n\n    if (!disableUrl && !postUrl && shouldParseUrl) {\n      const newUrl = url && url.url;\n      if (newUrl) {\n        this.props.actions.setCreatePostState({ postUrl: newUrl });\n        this.createPreview(newUrl);\n      }\n    }\n\n    const bodyTags = tags;\n    const bodyMentions = mentions;\n\n    const words = getWords(postBody);\n    const lastWord = words[words.length - 1];\n    if (lastWord.match(/^@\\S+/g) && lastWord.length > 1) {\n      this.mention = lastWord;\n      this.props.actions.searchUser(lastWord.replace('@', ''));\n    } else this.props.actions.setUserSearch([]);\n\n    const addTagsAndMentions = doneTyping ? { bodyTags, bodyMentions } : {};\n\n    this.props.actions.setCreatePostState({ postBody, ...addTagsAndMentions });\n  }\n\n  createPreview = async postUrl => {\n    try {\n      const results = await this.props.actions.generatePreviewServer(postUrl);\n      if (!results) throw new Error('Unable to generate preview for url');\n\n      this.props.actions.setCreatePostState({\n        domain: results.domain,\n        postUrl: results.url,\n        inputUrl: postUrl,\n        keywords: results.keywords,\n        postTags: results.tags,\n        articleAuthor: results.articleAuthor,\n        shortText: results.shortText,\n        urlPreview: {\n          image: results.image,\n          title: results.title ? results.title : 'Untitled',\n          description: results.description\n        }\n      });\n    } catch (err) {\n      this.props.actions.setCreatePostState({ postUrl: null });\n      Alert.alert(err.message);\n    }\n  };\n\n  render() {\n    const { disableUrl, postUrl, postBody, navigation } = this.props;\n    let urlPlaceholder = 'Article URL.';\n    if (postUrl) {\n      urlPlaceholder = 'Add your own commentary';\n    }\n    if (this.props.repost) {\n      urlPlaceholder = 'Add a comment';\n    }\n\n    let userHeader = null;\n\n    if (this.props.user && !this.props.share && !this.props.repost) {\n      userHeader = (\n        <View style={styles.createPostUser}>\n          <View style={[styles.innerBorder, { paddingVertical: 10 }]}>\n            <Avatar\n              style={styles.innerBorder}\n              user={this.props.user}\n              setSelected={() => null}\n            />\n          </View>\n        </View>\n      );\n    }\n\n    let userSearch = null;\n\n    if (this.props.users.search && this.props.users.search.length) {\n      userSearch = (\n        <View style={{ flex: 1, maxHeight: 220 }}>\n          <UserSearchComponent\n            setSelected={this.setMention}\n            users={this.props.users.search}\n          />\n        </View>\n      );\n    }\n\n    let addP = null;\n\n    if (\n      this.props.urlPreview &&\n      this.props.urlPreview.description &&\n      !this.props.repost\n    ) {\n      addP = (\n        <TouchableHighlight\n          underlayColor={'transparent'}\n          style={styles.postButton}\n          onPress={() =>\n            this.props.actions.setCreatePostState({\n              postBody: postBody + '\\n>\"' + this.props.urlPreview.description + '\"'\n            })\n          }\n        >\n          <Text style={[styles.font12, styles.active]}>Add text from link</Text>\n        </TouchableHighlight>\n      );\n    }\n\n    let tipCTA;\n    if (\n      Platform.OS === 'ios' &&\n      !this.props.urlPreview &&\n      postBody === '' &&\n      !this.props.share\n    ) {\n      tipCTA = (\n        <TouchableHighlight\n          ref={c => (this.shareTip = c)}\n          underlayColor={'transparent'}\n          style={[styles.postButtonShare]}\n          onPress={() => this.toggleTooltip(this.shareTip, 'shareTip')}\n        >\n          <Text style={[styles.font12, styles.active, { textAlign: 'center' }]}>\n            How to post from Chrome, Safari & other apps\n          </Text>\n        </TouchableHighlight>\n      );\n    }\n\n    return (\n      <ScrollView\n        keyboardShouldPersistTaps={'always'}\n        ref={c => (this.scrollView = c)}\n        style={{\n          flex: 1,\n          paddingHorizontal: mainPadding,\n          backgroundColor: colors.white\n        }}\n        contentContainerStyle={{ flexGrow: 1, height: 'auto', minHeight: 260 }}\n      >\n        <NavigationEvents\n          onDidBlur={() => {\n            this.input && this.input.blur();\n            Keyboard.dismiss();\n          }}\n          onWillBlur={() => {\n            this.input && this.input.blur();\n            Keyboard.dismiss();\n          }}\n        />\n        {userHeader}\n        <View style={[{ flex: 1, marginTop: 8 }]}>\n          <TextInput\n            ref={c => {\n              this.input = c;\n            }}\n            style={[\n              { flex: 1 },\n              styles.font15,\n              styles.createPostInput,\n              { maxHeight: 280 }\n            ]}\n            autoFocus={navigation.isFocused()}\n            underlineColorAndroid={'transparent'}\n            placeholder={urlPlaceholder}\n            placeholderTextColor={greyText}\n            multiline\n            clearButtonMode={'while-editing'}\n            onChangeText={_postBody => {\n              this.processInput(_postBody, false);\n            }}\n            onBlur={() => this.processInput(null, true)}\n            returnKeyType={'default'}\n            onFocus={() => null}\n            keyboardShouldPersistTaps={'never'}\n            disableFullscreenUI\n            textAlignVertical={'top'}\n            onSubmitEditing={() => {\n              if (this.okToSubmit) {\n                this.processInput(postBody + '\\n', true);\n                return (this.okToSubmit = false);\n              }\n              return (this.okToSubmit = true);\n            }}\n          >\n            <TextBody showAllMentions>{postBody}</TextBody>\n          </TextInput>\n          {addP}\n          {tipCTA}\n        </View>\n        {userSearch}\n        {disableUrl && postBody !== '' && (\n          <Text\n            onPress={this.enableUrlPreview}\n            style={{ color: colors.blue, position: 'absolute', bottom: 16, right: 0 }}\n          >\n            Enable Link Preview\n          </Text>\n        )}\n        {postUrl && !this.props.users.search.length && !this.props.repost ? (\n          <View style={{ marginVertical: 8 }}>\n            <UrlPreview\n              remove\n              {...this.props}\n              size={'small'}\n              urlMenu={this.previewMenu}\n            />\n          </View>\n        ) : null}\n      </ScrollView>\n    );\n  }\n}\n\nconst localStyles = StyleSheet.create({\n  textP: {\n    flex: 0,\n    marginBottom: 10\n  },\n  videoTip: {\n    borderColor: 'lightgrey',\n    borderWidth: StyleSheet.hairlineWidth,\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: 10,\n    padding: 10\n  },\n  createPostUser: {\n    height: 55\n  },\n  postButtonShare: {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    bottom: 10,\n    alignItems: 'center',\n    paddingVertical: 5,\n    paddingHorizontal: 5,\n    borderRadius: 3\n  },\n  postButton: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    paddingVertical: 5,\n    paddingHorizontal: 5,\n    borderRadius: 3\n  },\n  innerBorder: {\n    height: 55,\n    borderBottomWidth: 1,\n    borderBottomColor: borderGrey\n  },\n  noBorder: {\n    borderBottomWidth: StyleSheet.hairlineWidth\n  },\n  inputBox: {\n    flex: 1,\n    backgroundColor: '#ffffff'\n  }\n});\n\nstyles = { ...localStyles, ...globalStyles };\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.auth.user,\n    users: state.user,\n    postUrl: state.createPost.postUrl,\n    createPreview: state.createPost.createPreview,\n    postBody: state.createPost.postBody,\n    urlPreview: state.createPost.urlPreview,\n    repost: state.createPost.repost,\n    tags: state.tags.parentTags,\n    disableUrl: state.createPost.disableUrl\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...createPostActions,\n        ...tagActions,\n        ...userActions,\n        ...tooltipActions\n      },\n      dispatch\n    )\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UrlComponent);\n"],"file":"url.component.js"}