{"version":3,"sources":["../../../src/modules/createPost/createPost.containerOld.js"],"names":["urlPlaceholder","textPlaceholder","PasteTextFromLink","SmallText","CreatePostContainer","props","setState","submitting","auth","close","actions","history","location","createPost","state","selectedTags","postUrl","urlPreview","category","mentions","domain","channel","title","tags","body","validate","validateInput","Error","allTags","concat","Array","from","Set","replace","newPost","url","description","image","edit","editPost","success","clearPost","push","pathname","submitPost","community","refreshTab","ReactGA","event","action","alert","browserAlerts","message","e","target","name","value","checked","handleChange","bind","handleBodyChange","parseBody","createPreview","addTextFromLink","setCategory","renderPreview","selectTags","loadingPreview","failedUrl","stateFromReducer","parentTags","length","getParentTags","newProps","userSearch","userSearchIndex","oldState","tag","clearCreatePost","clearUrl","updateReducer","postBody","postCategory","postImage","setCreatePostState","setSate","trim","field","data","shouldParseUrl","text","stripHTML","setPostCategory","loading","generatePreviewServer","then","results","imageURL","indexOf","split","keywords","postTags","embeddedUser","user","linkPreview","screenSize","textAlign","placeholder","articleTags","communityTags","activeCommunity","communities","active","map","t","_id","isAdmin","role","submitDisabled","chatEnabled","handleInput","colors","blue","preventDefault","filter","handleCheckbox","Component","PropTypes","object","array","func","number","mapStateToProps","users","search","navigation","mapDispatchToProps","dispatch","navigationActions","createPostActions","postActions","userActions","tagActions"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport RichText from 'modules/text/web/richText.component';\nimport get from 'lodash/get';\nimport ReactGA from 'react-ga';\nimport { colors, sizing } from 'styles';\n\nimport * as navigationActions from 'modules/navigation/navigation.actions';\nimport * as userActions from 'modules/user/user.actions';\nimport * as createPostActions from 'modules/createPost/createPost.actions';\nimport * as postActions from 'modules/post/post.actions';\nimport * as tagActions from 'modules/tag/tag.actions';\nimport { alert, text } from 'app/utils';\n\nimport {\n  View,\n  Button,\n  Divider,\n  BodyText,\n  LinkFont,\n  SmallText,\n  Box\n} from 'modules/styled/uni';\nimport { Input } from 'modules/styled/web';\n\nimport AvatarBox from 'modules/user/avatarbox.component';\nimport PostInfo from 'modules/post/postinfo.component';\nimport TagInput from 'modules/createPost/web/TagInput.component';\nimport SelectTags from 'modules/createPost/web/selectTags.component';\nimport styled from 'styled-components/primitives';\n\nconst urlPlaceholder = \"What's relevant?  Paste article URL.\";\nconst textPlaceholder =\n  'Add your commentary, opinion, summary or a relevant quote from the article';\n\nconst PasteTextFromLink = styled(SmallText)`\n  position: absolute;\n  right: ${sizing(1.5)};\n  bottom: ${sizing(1.5)};\n`;\n\nclass CreatePostContainer extends Component {\n  static propTypes = {\n    tags: PropTypes.object,\n    actions: PropTypes.object,\n    userSearch: PropTypes.array,\n    createPost: PropTypes.object,\n    // modal: PropTypes.bool,\n    auth: PropTypes.object,\n    close: PropTypes.func,\n    location: PropTypes.object,\n    history: PropTypes.object,\n    community: PropTypes.object,\n    screenSize: PropTypes.number\n  };\n\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleBodyChange = this.handleBodyChange.bind(this);\n    this.parseBody = this.parseBody.bind(this);\n    this.createPreview = this.createPreview.bind(this);\n    this.addTextFromLink = this.addTextFromLink.bind(this);\n    this.setCategory = this.setCategory.bind(this);\n    this.renderPreview = this.renderPreview.bind(this);\n    this.createPost = this.createPost.bind(this);\n    this.validateInput = this.validateInput.bind(this);\n    this.clearPost = this.clearPost.bind(this);\n    this.selectTags = this.selectTags.bind(this);\n    this.state = {\n      body: '',\n      category: '',\n      domain: null,\n      urlPreview: null,\n      loadingPreview: false,\n      selectedTags: [],\n      tags: null,\n      url: null,\n      mentions: null,\n      failedUrl: null,\n      submitting: false\n    };\n  }\n\n  componentWillMount() {\n    this.stateFromReducer();\n  }\n\n  componentDidMount() {\n    if (!this.props.tags || !this.props.tags.parentTags.length) {\n      this.props.actions.getParentTags();\n    }\n    this.setState({ submitting: false });\n  }\n\n  componentWillReceiveProps(newProps) {\n    if (newProps.userSearch !== this.props.userSearch) {\n      this.setState({ userSearchIndex: -1 });\n    }\n  }\n\n  componentDidUpdate(newProps, oldState) {\n    if (oldState.body !== this.state.body) {\n      this.parseBody();\n    }\n  }\n\n  selectTags(tag) {\n    if (!tag || !tag.length) return;\n    if (typeof tag === 'string') tag = [tag];\n    let { selectedTags } = this.state;\n    selectedTags = [...new Set([...selectedTags, ...tag])];\n    this.setState({ selectedTags });\n  }\n\n  clearPost() {\n    this.props.actions.clearCreatePost();\n    this.clearUrl();\n    this.stateFromReducer();\n  }\n\n  clearUrl() {\n    this.setState({\n      url: null,\n      postUrl: null,\n      urlPreview: null,\n      loadingPreview: false\n    });\n  }\n\n  componentWillUnmount() {\n    this.updateReducer();\n  }\n\n  stateFromReducer() {\n    const props = this.props.createPost;\n    this.setState({\n      ...props,\n      body: props.postBody || '',\n      category: props.postCategory,\n      tags: props.allTags\n    });\n    this.parseBody(this.state);\n  }\n\n  updateReducer() {\n    const allTags = this.state.tags\n      ? this.state.tags.concat(this.state.selectedTags)\n      : [];\n    const tags = Array.from(new Set(allTags));\n\n    const state = {\n      ...this.state,\n      postBody: this.state.body,\n      postCategory: this.state.category,\n      allTags: tags,\n      postImage: this.state.urlPreview ? this.state.urlPreview.image : null\n    };\n    this.props.actions.setCreatePostState(state);\n  }\n\n  validateInput() {\n    if (!this.state.selectedTags.length) {\n      this.setSate({ validate: 'Please select at least one topic' });\n      return 'Please select at least one topic';\n    }\n    if (!this.state.body || !this.state.body.trim().length) {\n      this.setState({ validate: 'Please write something' });\n      return 'Can not create empty post';\n    }\n    return true;\n  }\n\n  createPost = async () => {\n    this.setState({ submitting: true });\n    const { auth, close, actions, history, location, createPost } = this.props;\n    const {\n      selectedTags,\n      postUrl,\n      urlPreview,\n      category,\n      mentions,\n      domain,\n      channel,\n      title\n    } = this.state;\n\n    let { tags, body } = this.state;\n    try {\n      const validate = this.validateInput();\n      if (validate !== true) {\n        throw new Error(validate);\n      }\n      const allTags = tags.concat(selectedTags);\n      tags = Array.from(new Set(allTags));\n\n      body = body.replace(/&nbsp;/gi, '');\n\n      let newPost = {\n        url: postUrl || postUrl,\n        tags,\n        body,\n        title: urlPreview ? urlPreview.title : title,\n        description: urlPreview ? urlPreview.description : null,\n        category,\n        image: urlPreview ? urlPreview.image : null,\n        mentions,\n        domain,\n        channel\n      };\n\n      if (createPost.edit) {\n        newPost = { ...createPost.editPost, ...newPost };\n        const success = await actions.editPost(newPost);\n        if (success) {\n          this.clearPost();\n          history.push(location.pathname);\n          if (close) close();\n        }\n        return;\n      }\n\n      newPost = await actions.submitPost(newPost);\n\n      if (!newPost) {\n        this.setState({ submitting: false });\n        return;\n      }\n\n      close && close();\n      this.clearPost();\n\n      history.push(`/${auth.community}/new/`);\n      actions.refreshTab('discover');\n\n      ReactGA.event({\n        category: 'User',\n        action: 'Created a Post'\n      });\n    } catch (err) {\n      // TODO error handling\n      alert.browserAlerts.alert(err.message);\n    }\n    this.setState({ submitting: false });\n  };\n\n  handleChange(field, data) {\n    this.setState({ [field]: data });\n  }\n\n  handleBodyChange(body, data) {\n    if (body !== this.state.body) {\n      this.setState({ ...data, body });\n    }\n  }\n\n  parseBody() {\n    if (\n      this.state.url &&\n      !this.state.postUrl &&\n      this.state.shouldParseUrl &&\n      this.state.postUrl !== this.state.url\n    ) {\n      this.createPreview();\n    }\n  }\n\n  addTextFromLink() {\n    const description = '\"' + text.stripHTML(this.state.urlPreview.description) + '\"';\n    this.setState({\n      body: description\n    });\n  }\n\n  setCategory(category) {\n    this.setState({ category });\n    this.props.actions.setPostCategory(category);\n  }\n\n  createPreview() {\n    const { url } = this.state;\n    const { auth } = this.props;\n    // better logic?\n    if (this.state.loadingPreview) return;\n\n    const postUrl = url;\n    this.setState({\n      body: this.state.body.replace(postUrl, '').trim(),\n      loadingPreview: true,\n      urlPreview: {\n        loading: true\n      }\n    });\n\n    this.props.actions.generatePreviewServer(postUrl).then(results => {\n      if (results && results.url) {\n        let imageURL = results.image;\n        if (imageURL && imageURL.indexOf(', ')) {\n          imageURL = imageURL.split(', ')[0];\n        }\n        this.setState({\n          domain: results.domain,\n          postUrl: results.url,\n          url: results.url,\n          loadingPreview: false,\n          keywords: results.keywords,\n          postTags: results.tags,\n          urlPreview: {\n            ...results,\n            image: imageURL,\n            title: results.title || 'Untitled',\n            loading: false,\n            embeddedUser: auth.user,\n            tags: []\n          },\n          linkPreview: {\n            ...results,\n            image: imageURL\n          }\n        });\n      } else {\n        this.setState({ failedUrl: this.state.url, loadingPreview: false });\n      }\n    });\n  }\n\n  renderPreview() {\n    if (!this.state.urlPreview) return null;\n    const { auth, screenSize } = this.props;\n    return (\n      <Box>\n        <PostInfo\n          small\n          preview={!!screenSize}\n          auth={auth}\n          screenSize={screenSize}\n          close={this.clearUrl.bind(this)}\n          post={this.state.urlPreview}\n          link={this.state.linkPreview}\n        />\n        <SmallText style={{ textAlign: 'right' }}>\n          <a onClick={this.clearUrl.bind(this)} className=\"removeUrl\">\n            remove url\n          </a>\n        </SmallText>\n      </Box>\n    );\n  }\n\n  handleInput = e => this.setState({ [e.target.name]: e.target.value });\n\n  handleCheckbox = e => this.setState({ [e.target.name]: e.target.checked });\n\n  render() {\n    const placeholder = this.state.urlPreview ? textPlaceholder : urlPlaceholder;\n    const { body, url, submitting, channel, title } = this.state;\n    const { community, auth } = this.props;\n    const articleTags = this.state.keywords;\n    let communityTags = [];\n    if (community) {\n      const activeCommunity = get(community.communities, community.active, {}) || {};\n      communityTags = get(activeCommunity, 'topics', []) || [].map(t => t._id);\n    }\n    const allTags = [].concat(articleTags, communityTags);\n    const isAdmin = auth.user && auth.user.role === 'admin';\n\n    const submitDisabled =\n      submitting || !this.state.selectedTags.length || !body || !body.trim().length;\n\n    const chatEnabled = false;\n\n    return (\n      <View>\n        <View display=\"flex\" fdirection=\"row\" align=\"center\">\n          <AvatarBox user={auth.user} size={4} />\n        </View>\n\n        {channel && (\n          <Input\n            onChange={this.handleInput}\n            value={title}\n            name=\"title\"\n            mt={2}\n            type=\"text\"\n            placeholder=\"Title\"\n          />\n        )}\n\n        <View mt={2}>\n          <RichText\n            body={this.state.body}\n            placeholder={placeholder}\n            onChange={this.handleBodyChange}\n            onBlur={() => {\n              if (!this.state.body.length && !this.state.postUrl) {\n                this.setState({ active: false });\n              }\n            }}\n          />\n          <PasteTextFromLink c={colors.blue}>\n            {this.state.urlPreview &&\n              this.state.body === '' &&\n              this.state.urlPreview.description && (\n                <a\n                  href=\"#\"\n                  onClick={e => {\n                    e.preventDefault();\n                    this.addTextFromLink();\n                  }}\n                >\n                  Paste article description\n                </a>\n              )}\n          </PasteTextFromLink>\n        </View>\n\n        <View mt={[3, 2]}>{this.renderPreview()}</View>\n\n        {body || url ? (\n          <View mt={[3, 2]}>\n            <TagInput\n              selectedTags={this.state.selectedTags}\n              selectTag={this.selectTags}\n              deselectTag={tag => {\n                let { selectedTags } = this.state;\n                selectedTags = selectedTags.filter(t => t !== tag);\n                this.setState({ selectedTags });\n              }}\n              placeholderText={\n                !this.state.selectedTags.length ? 'Please add at least one tag' : ''\n              }\n            />\n            <View mt={[4, 2]}>\n              <SelectTags\n                text={'Suggested tags'}\n                tags={allTags}\n                selectedTags={this.state.selectedTags}\n                selectTag={this.selectTags}\n                deselectTag={tag => {\n                  let { selectedTags } = this.state.selectedTags;\n                  selectedTags = selectedTags.filter(t => t !== tag);\n                  this.setState({ selectedTags });\n                }}\n              />\n            </View>\n            <Divider mt={[4, 2]} />\n          </View>\n        ) : null}\n\n        <View mt={2} fdirection=\"row\" justify=\"space-between\">\n          {isAdmin && chatEnabled && (\n            <View fdirection=\"row\" align={'center'} alignself={'center'}>\n              <input\n                checked={channel}\n                type=\"checkbox\"\n                name={'channel'}\n                onChange={this.handleCheckbox}\n              />\n              <BodyText ml={0.5}>This is a chat channel</BodyText>\n            </View>\n          )}\n          <View fdirection=\"row\" flex={1} justify=\"flex-end\" align=\"center\">\n            <LinkFont mr={3} onClick={this.clearPost}>\n              Clear\n            </LinkFont>\n\n            <Button\n              onClick={() => !submitDisabled && this.createPost()}\n              disabled={submitDisabled}\n              ml={2}\n            >\n              {this.props.createPost.edit ? 'Update Post' : 'Create Post'}\n            </Button>\n          </View>\n        </View>\n      </View>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    createPost: state.createPost,\n    auth: state.auth,\n    users: state.user,\n    tags: state.tags,\n    userSearch: state.user.search,\n    community: state.community,\n    screenSize: state.navigation.screenSize\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...navigationActions,\n        ...createPostActions,\n        ...postActions,\n        ...userActions,\n        ...tagActions\n      },\n      dispatch\n    )\n  };\n}\n\nexport default withRouter(\n  connect(mapStateToProps, mapDispatchToProps)(CreatePostContainer)\n);\n"],"file":"createPost.containerOld.js"}