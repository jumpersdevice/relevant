{"version":3,"sources":["../../../../src/modules/admin/web/invites.container.js"],"names":["process","env","BROWSER","require","PAGE_SIZE","Invites","props","handleChange","bind","createInvite","sendEmail","load","hasMore","state","email","name","number","filter","invitedBy","page","l","admin","inviteList","length","actions","getInvites","invite","status","c","window","confirm","sendInvitationEmail","_id","destroy","invitedByString","setState","event","target","value","inviteId","invites","code","width","textAlign","map","id","renderInvite","maxWidth","Component","PropTypes","object","auth","dispatch","adminActions"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport * as adminActions from 'modules/admin/admin.actions';\nimport ShadowButton from 'modules/ui/web/ShadowButton';\nimport InfScroll from 'modules/listview/web/infScroll.component';\n\nif (process.env.BROWSER === true) {\n  require('./admin.css');\n}\n\nconst PAGE_SIZE = 40;\n\nclass Invites extends Component {\n  static propTypes = {\n    admin: PropTypes.object,\n    actions: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.createInvite = this.createInvite.bind(this);\n    this.sendEmail = this.sendEmail.bind(this);\n    this.load = this.load.bind(this);\n    this.hasMore = true;\n    this.state = {\n      email: '',\n      name: '',\n      number: 1,\n      filter: null,\n      invitedBy: ''\n    };\n  }\n\n  componentDidMount() {}\n\n  load(page) {\n    const l = this.props.admin.inviteList.length;\n    this.hasMore = (page - 1) * PAGE_SIZE <= l;\n\n    if (this.hasMore) {\n      this.props.actions.getInvites(l, PAGE_SIZE);\n    }\n  }\n\n  sendEmail(invite) {\n    if (invite.status) {\n      const c = window.confirm(\n        'We have already sent one email to this user, are you sure you would like to send another one?'\n      );\n      if (c) {\n        this.props.actions.sendInvitationEmail(invite._id);\n      }\n    } else {\n      this.props.actions.sendInvitationEmail(invite._id);\n    }\n  }\n\n  destroy(invite) {\n    const c = window.confirm('Are you sure you would like to delete this invite?');\n    if (c) this.props.actions.destroy(invite);\n  }\n\n  createInvite() {\n    const invite = {\n      email: this.state.email,\n      name: this.state.name,\n      number: this.state.number,\n      invitedByString: this.state.invitedBy\n    };\n    this.props.actions.createInvite(invite);\n    this.setState({ name: '', email: '', number: 1 });\n  }\n\n  handleChange(event) {\n    this.setState({ [event.target.name]: event.target.value });\n  }\n\n  renderInvite(inviteId) {\n    const invite = this.props.admin.invites[inviteId];\n    if (!invite) return null;\n    if (this.state.filter === 'original' && !invite.email) return null;\n    if (this.state.filter === 'registered' && invite.status !== 'registered') return null;\n    if (\n      this.state.filter === 'notregistered' &&\n      (invite.status === 'registered' || !invite.email)\n    ) {\n      return null;\n    }\n\n    return (\n      <div key={inviteId} className={'adminRow'}>\n        <span>{invite.invitedBy}</span>\n        <span>{invite.name}</span>\n        <span>{invite.email}</span>\n        <span>{invite.code}</span>\n        <span>{invite.status}</span>\n        <span style={{ width: '40px' }}>{invite.number}</span>\n        <button onClick={() => this.sendEmail(invite)}>Resend Email</button>\n        <button className={'alert'} onClick={() => this.destroy(invite)}>\n          Delete\n        </button>\n      </div>\n    );\n  }\n\n  render() {\n    const createInvite = (\n      <div className=\"adminInner\">\n        <input\n          className={'blueInput'}\n          type={'text'}\n          name={'invitedBy'}\n          placeholder={'invited by'}\n          value={this.state.invitedBy}\n          onChange={this.handleChange}\n        />\n        <input\n          className={'blueInput'}\n          type={'email'}\n          name={'email'}\n          placeholder={'user email'}\n          value={this.state.email}\n          onChange={this.handleChange}\n        />\n        <input\n          className={'blueInput'}\n          type={'text'}\n          name={'name'}\n          placeholder={'user name'}\n          value={this.state.name}\n          onChange={this.handleChange}\n        />\n        <input\n          className={'blueInput'}\n          style={{ width: '40px', textAlign: 'right' }}\n          type={'text'}\n          name={'number'}\n          placeholder={'number of invites'}\n          value={this.state.number}\n          onChange={this.handleChange}\n        />\n        <ShadowButton\n          backgroundColor={'white'}\n          color={'#3E3EFF'}\n          onClick={this.createInvite}\n        >\n          {this.state.email ? 'Send Invite Email' : 'Create Invite Code'}\n        </ShadowButton>\n      </div>\n    );\n\n    const invites = this.props.admin.inviteList\n      ? this.props.admin.inviteList.map(id => this.renderInvite(id))\n      : null;\n\n    return (\n      <div className=\"adminContainer\">\n        <h2>Manage Invites</h2>\n        {createInvite}\n\n        <div className={'filter'}>\n          <span onClick={() => this.setState({ filter: null })}>all</span>\n          <span onClick={() => this.setState({ filter: 'original' })}>original</span>\n          <span onClick={() => this.setState({ filter: 'registered' })}>registered</span>\n          <span onClick={() => this.setState({ filter: 'notregistered' })}>\n            notregistered\n          </span>\n        </div>\n\n        <div key={'inviteId'} className={'titleRow'}>\n          <span>Invited by</span>\n          <span>Name</span>\n          <span>Email</span>\n          <span>Invite Code</span>\n          <span>Status</span>\n          <span style={{ width: '40px' }}>Number</span>\n          <span style={{ maxWidth: 130 }} />\n        </div>\n\n        <InfScroll\n          className={'adminContainer'}\n          data={this.props.admin.inviteList}\n          loadMore={this.load}\n          hasMore={this.hasMore}\n        >\n          {invites}\n        </InfScroll>\n      </div>\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    auth: state.auth,\n    admin: state.admin\n  }),\n  dispatch => ({\n    actions: bindActionCreators(adminActions, dispatch)\n  })\n)(Invites);\n"],"file":"invites.container.js"}