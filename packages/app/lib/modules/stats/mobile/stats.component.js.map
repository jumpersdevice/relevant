{"version":3,"sources":["../../../../src/modules/stats/mobile/stats.component.js"],"names":["styles","Stats","props","context","initTooltips","bind","toggleTooltip","tooltipParent","type","discover","topics","parent","title","setTimeout","forEach","name","actions","setTooltipData","toggle","measureInWindow","x","y","w","h","showTooltip","entity","auth","user","statsStyle","fontSize","lineHeight","height","bebas","quarterLetterSpacing","iconStyle","coinStyle","size","smallScreen","width","value","c","coin","statInner","require","textStyle","darkGrey","numbers","abbreviateNumber","balance","tokenBalance","percent","relevance","rank","topic","pagerank","r","getLeft","renderLeft","getRight","br","stats","style","Component","PropTypes","string","bool","object","localStyles","StyleSheet","create","alignItems","justifyContent","flexDirection","flexWrap","globalStyles","mapDispatchToProps","dispatch","tooltipActions","state"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { View, Text, Image, StyleSheet, TouchableOpacity } from 'react-native';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { globalStyles, smallScreen } from 'app/styles/global';\nimport Percent from 'modules/stats/mobile/percent.component';\nimport { numbers } from 'app/utils';\nimport * as tooltipActions from 'modules/tooltip/tooltip.actions';\n\nlet styles;\n\nclass Stats extends Component {\n  static propTypes = {\n    type: PropTypes.string,\n    discover: PropTypes.bool,\n    parent: PropTypes.object,\n    actions: PropTypes.object,\n    // currentView: PropTypes.string,\n    size: PropTypes.string,\n    textStyle: PropTypes.object,\n    topic: PropTypes.string,\n    renderLeft: PropTypes.object,\n    style: PropTypes.object,\n    entity: PropTypes.object,\n    auth: PropTypes.object\n  };\n\n  constructor(props, context) {\n    super(props, context);\n    this.initTooltips = this.initTooltips.bind(this);\n    this.toggleTooltip = this.toggleTooltip.bind(this);\n    this.tooltipParent = {};\n  }\n\n  componentDidMount() {\n    if (this.props.type === 'nav' && this.props.discover) {\n      this.tooltipParent.topics = this.props.parent.title;\n      setTimeout(() => this.initTooltips(), 1000);\n    }\n  }\n\n  initTooltips() {\n    ['relevance', 'coin', 'topics', 'earnings'].forEach(name => {\n      this.props.actions.setTooltipData({\n        name,\n        toggle: () => this.toggleTooltip(name)\n      });\n    });\n  }\n\n  toggleTooltip(name) {\n    // TODO test the onboarding here — might need this\n    // console.log('toggle toolitp ', name);\n    // if (\n    //   (name === 'relevance' || name === 'coin') &&\n    //   // this.props.currentView !== 'discover'\n    // ) {\n    //   return;\n    // }\n    if (this.props.type !== 'nav') return;\n    if (!this.tooltipParent[name]) return;\n    this.tooltipParent[name].measureInWindow((x, y, w, h) => {\n      const parent = { x, y, w, h };\n      if (x + y + w + h === 0) return;\n      this.props.actions.setTooltipData({\n        name,\n        parent\n      });\n      this.props.actions.showTooltip(name);\n    });\n  }\n\n  render() {\n    const { type } = this.props;\n    const entity = this.props.entity || this.props.auth.user;\n    if (!entity) return null;\n\n    let statsStyle = [\n      { fontSize: 17, lineHeight: 17, height: 17 },\n      styles.bebas,\n      styles.quarterLetterSpacing\n    ];\n    let iconStyle = [];\n    let coinStyle = [];\n\n    if (this.props.size === 'small' || (smallScreen && type === 'nav')) {\n      statsStyle = [\n        { fontSize: 15, lineHeight: 15 },\n        styles.bebas,\n        styles.quarterLetterSpacing\n      ];\n      iconStyle = [{ width: 15, height: 15 }];\n      coinStyle = [{ width: 15, height: 15 }];\n    }\n    if (this.props.size === 'tiny') {\n      statsStyle = [\n        { fontSize: 13, lineHeight: 13 },\n        styles.bebas,\n        styles.quarterLetterSpacing\n      ];\n      iconStyle = [{ width: 14, height: 14 }];\n      // coinStyle = [{ width: 18, height: 15, marginBottom: -6 }];\n    }\n\n    const value = (\n      <TouchableOpacity\n        ref={c => (this.tooltipParent.coin = c)}\n        onPress={() => this.toggleTooltip('coin')}\n        style={styles.statInner}\n      >\n        <Image\n          resizeMode={'contain'}\n          style={[styles.coin, ...coinStyle]}\n          source={require('public/img/relevantcoin.png')}\n        />\n        <Text style={[this.props.textStyle, statsStyle, styles.darkGrey]}>\n          {numbers.abbreviateNumber(\n            entity.value || entity.balance + entity.tokenBalance || 0\n          )}\n        </Text>\n      </TouchableOpacity>\n    );\n\n    const percent = (\n      <View style={styles.statInner}>\n        <Percent fontSize={17} user={entity} />\n      </View>\n    );\n\n    // This is in order to display topic relevance correctly\n    entity.relevance = entity.relevance || {};\n    const rank = this.props.topic\n      ? entity[this.props.topic + '_relevance']\n      : entity.relevance.pagerank || 0;\n    const relevance = (\n      <TouchableOpacity\n        ref={c => (this.tooltipParent.relevance = c)}\n        onPress={() => this.toggleTooltip('relevance')}\n        style={styles.statInner}\n      >\n        <Image\n          resizeMode={'contain'}\n          style={[styles.r, ...iconStyle]}\n          source={require('public/img/r.png')}\n        />\n        <Text style={[this.props.textStyle, statsStyle, styles.darkGrey]}>\n          {numbers.abbreviateNumber(rank)}\n        </Text>\n      </TouchableOpacity>\n    );\n\n    const getLeft = () => {\n      if (type === 'relevance') return null;\n      if (type === 'value') return value;\n      if (type === 'percent') return this.props.renderLeft || percent;\n      if (type === 'nav') return value;\n      return null;\n    };\n\n    const getRight = () => {\n      if (type === 'value') return relevance;\n      if (type === 'percent') return relevance;\n      if (type === 'nav') return relevance;\n      if (type === 'relevance') return relevance;\n      return null;\n    };\n\n    const br = (\n      <View style={styles.statInner}>\n        <Text style={statsStyle}>{smallScreen ? '•' : ' • '}</Text>\n      </View>\n    );\n\n    return (\n      <View style={[styles.stats, this.props.style]}>\n        {getLeft()}\n        {getLeft() && !this.props.renderLeft ? br : null}\n        {getRight()}\n      </View>\n    );\n  }\n}\n\nconst localStyles = StyleSheet.create({\n  stats: {\n    alignItems: 'flex-end',\n    justifyContent: 'flex-end',\n    flexDirection: 'row'\n  },\n  statInner: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    alignItems: 'center'\n  }\n});\n\nstyles = { ...globalStyles, ...localStyles };\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...tooltipActions\n      },\n      dispatch\n    )\n  };\n}\n\nexport default connect(\n  state => ({\n    auth: state.auth\n    // currentView: state.navigation.currentView\n  }),\n  mapDispatchToProps\n)(Stats);\n"],"file":"stats.component.js"}