{"version":3,"sources":["../../../../src/modules/navigation/web/topnav.component.js"],"names":["Nav","View","colors","white","layout","headerHeight","p","top","sideNavWidth","Badge","ActionButton","Button","screenSize","blue","TopNav","now","Date","isAuthenticated","props","auth","state","timeSinceNotificationCount","getTime","setState","actions","getNotificationCount","location","history","push","search","pathname","showModal","window","addEventListener","prevProps","wasNotAuthenticated","removeEventListener","notif","title","promptType","BANNER_PROMPT_HEIGHT","black","grey","count","red","e","preventDefault","user","toggleLogin","Component","PropTypes","object","number","string","mapStateToProps","navigation","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { StyledNavLink, Button } from 'modules/styled/web';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { withRouter } from 'react-router-dom';\nimport DiscoverTabs from 'modules/discover/web/discoverTabs.component';\nimport Breadcrumbs from 'modules/navigation/web/breadcrumbs.component';\nimport { View, Text, LinkFont, Header, ButtonText } from 'modules/styled/uni';\nimport styled from 'styled-components/primitives';\nimport styledComponent from 'styled-components';\nimport { colors, layout, sizing } from 'app/styles';\nimport { showModal } from 'modules/navigation/navigation.actions';\nimport { getNotificationCount } from 'modules/activity/activity.actions';\nimport Ulink from 'modules/navigation/ULink.component';\nimport MenuIcon from 'modules/ui/web/menuIcon.component';\n\nconst Nav = styled(View)`\n  position: sticky;\n  /*   background-image: linear-gradient(hsla(0, 0%, 100%, 1) 80%, hsla(0, 0%, 100%, 0) 100%);\n   */\n  z-index: 100;\n  background-color: ${colors.white};\n  height: ${layout.headerHeight};\n  top: ${p => (p.top ? p.top : 0)};\n  left: ${layout.sideNavWidth};\n`;\n\nconst Badge = styled(View)`\n  border-radius: 100%;\n  align-items: center;\n  height: ${sizing(2)};\n  width: ${sizing(2)};\n  justify-content: center;\n  display: flex;\n  flex-direction: row;\n  margin-bottom: ${sizing(1)};\n`;\n\nconst ActionButton = styledComponent(Button)`\n  ${p =>\n    !p.screenSize\n      ? ''\n      : `\n    position: fixed;\n    bottom: ${sizing(2)};\n    right: ${sizing(2)};\n    height: ${sizing(8)};\n    width: ${sizing(8)};\n    min-width: 0;\n    border-radius: 100%;\n    background-color: ${colors.blue};\n  `}\n`;\n\nclass TopNav extends Component {\n  static propTypes = {\n    location: PropTypes.object,\n    auth: PropTypes.object,\n    history: PropTypes.object,\n    actions: PropTypes.object,\n    notif: PropTypes.object,\n    screenSize: PropTypes.number,\n    title: PropTypes.string\n  };\n\n  state = {};\n\n  componentDidMount() {\n    this.getNotificationCount();\n    window.addEventListener('focus', getNotificationCount);\n  }\n\n  componentDidUpdate(prevProps) {\n    const wasNotAuthenticated = !prevProps.auth.isAuthenticated;\n    const { isAuthenticated } = this.props.auth;\n    if (wasNotAuthenticated && isAuthenticated) this.getNotificationCount();\n  }\n\n  getNotificationCount = () => {\n    const now = new Date();\n    const { isAuthenticated } = this.props.auth;\n    if (\n      this.state.timeSinceNotificationCount &&\n      now.getTime() - this.state.timeSinceNotificationCount.getTime() < 30000\n    ) {\n      return;\n    }\n    if (isAuthenticated) {\n      this.setState({ timeSinceNotificationCount: now });\n      this.props.actions.getNotificationCount();\n    }\n  };\n\n  componentWillUnmount() {\n    window.removeEventListener('focus', getNotificationCount);\n  }\n\n  toggleLogin = () => {\n    const { location, history } = this.props;\n    history.push({ search: `?redirect=${location.pathname}` });\n    this.props.actions.showModal('login');\n  };\n\n  render() {\n    const { auth, actions, notif, screenSize, title } = this.props;\n    return (\n      <Nav\n        fdirection=\"column\"\n        justify=\"center\"\n        p={['0 4', '0 2']}\n        top={notif.promptType ? layout.BANNER_PROMPT_HEIGHT : null}\n      >\n        <View\n          zIndex={1}\n          justify=\"space-between\"\n          display=\"flex\"\n          fdirection=\"row\"\n          align=\"center\"\n        >\n          <MenuIcon mr={[4, 2]} />\n          {title ? <Header>{title}</Header> : <DiscoverTabs />}\n          <View\n            justify=\"space-between\"\n            display=\"flex\"\n            fdirection=\"row\"\n            flex={1}\n            grow={1}\n            align=\"center\"\n          >\n            {!title && auth.isAuthenticated ? (\n              <StyledNavLink\n                to=\"/user/activity\"\n                hc={colors.black}\n                c={colors.grey}\n                fdirection=\"row\"\n                d=\"flex\"\n              >\n                Activity\n                {notif.count ? (\n                  <Badge bg={colors.red} ml={0.5}>\n                    <Text c={colors.white} fw=\"bold\" fs={1.25}>\n                      {notif.count}\n                    </Text>\n                  </Badge>\n                ) : null}\n              </StyledNavLink>\n            ) : (\n              <div />\n            )}\n\n            <View fdirection=\"row\" d=\"flex\" flex={1} align=\"center\" justify=\"flex-end\">\n              {screenSize ? null : (\n                <Ulink\n                  onClick={e => {\n                    e.preventDefault();\n                    actions.showModal('onboarding');\n                  }}\n                  align={'center'}\n                  mr={2}\n                  hu\n                  color={colors.blue}\n                  to=\"/home\"\n                >\n                  <LinkFont c={colors.blue}>Get Started</LinkFont>\n                </Ulink>\n              )}\n              {auth.isAuthenticated ? (\n                <ActionButton\n                  onClick={() => actions.showModal('newpost')}\n                  disabled={!auth.user}\n                  screenSize={screenSize}\n                >\n                  <ButtonText>New Post</ButtonText>\n                </ActionButton>\n              ) : (\n                <ActionButton\n                  onClick={this.toggleLogin}\n                  screenSize={screenSize}\n                  color={colors.blue}\n                >\n                  <ButtonText>Login</ButtonText>\n                </ActionButton>\n              )}\n            </View>\n          </View>\n        </View>\n        <View fdirection={'row'} mt={[0, 1]} ml={[0, 5.5]}>\n          {!title && <Breadcrumbs />}\n        </View>\n      </Nav>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    auth: state.auth,\n    notif: state.notif,\n    screenSize: state.navigation.screenSize\n  };\n}\n\nexport default withRouter(\n  connect(mapStateToProps, dispatch => ({\n    actions: bindActionCreators(\n      {\n        showModal,\n        getNotificationCount\n      },\n      dispatch\n    )\n  }))(TopNav)\n);\n"],"file":"topnav.component.js"}