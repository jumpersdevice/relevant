{"version":3,"sources":["../../src/utils/text.js"],"names":["LinkifyContainer","process","env","WEB","require","default","Linkify","getTextData","postBody","matches","tags","filter","m","schema","map","text","replace","mentions","urls","url","getMentions","words","word","match","mention","el","getTags","tag","trim","getWords","res","a","split","NAME_PATTERN","HTML_REGEX","RegExp","stripHTML","copyToClipBoard","document","createElement","value","setAttribute","style","position","left","body","appendChild","select","execCommand","removeChild","alert","childIsString","children","isString","isArray","length","isTextArray","find","renderString","$$typeof","getTitle","headerMatch","lines","noEmptyLines","line","firstLine","limit","titleText","isHeading","substr","lastIndexOf","title"],"mappings":"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","sourcesContent":["import { Alert } from 'app/utils/alert';\nimport { linkifyMatch } from 'modules/comment/linkify';\n\nlet LinkifyContainer;\nif (process.env.WEB !== 'true') {\n  LinkifyContainer = require('modules/text/mobile/textBody.component').default;\n} else {\n  LinkifyContainer = require('linkifyjs/react');\n}\n\nexport const Linkify = LinkifyContainer;\n\nexport function getTextData(postBody) {\n  const matches = linkifyMatch(postBody) || [];\n\n  const tags = matches.filter(m => m.schema === '#').map(m => m.text.replace('#', ''));\n\n  const mentions = matches\n    .filter(m => m.schema === '@')\n    .map(m => m.text.replace('@', ''));\n\n  const urls = matches.filter(m => m.schema !== '#' && m.schema !== '@');\n  const url = urls[0];\n  return { url, mentions, tags };\n}\n\n// TODO Deprecate\nexport function getMentions(words) {\n  return words\n    .map(word => {\n      if (word.match(/^@\\S+/g)) {\n        const mention = word.replace(/@/g, '');\n        return mention !== '' ? mention : null;\n      }\n      return null;\n    })\n    .filter(el => el !== null);\n}\n\n// TODO Deprecate\nexport function getTags(words) {\n  return words\n    .map(word => {\n      if (word.match(/^#\\S+/g)) {\n        const tag = word.replace(/#/g, '').trim();\n        return tag !== '' ? tag : null;\n      }\n      return null;\n    })\n    .filter(el => el !== null);\n}\n\n// TODO Deprecate - use desktop create post and regular text input\nexport function getWords(text) {\n  const res = text\n    .replace(/[,.!?](?!\\b)|[\\s+]/g, a => '__WRD_SPLT__' + a + '__WRD_SPLT__')\n    .split(/__WRD_SPLT__/);\n  return res;\n}\n\nexport const NAME_PATTERN = /^[a-zA-Z0-9-_]+$/;\n\n// Android crashes when flag is separate argument w error:\n// Cannot supply flags when constructing one RegExp from another\nconst HTML_REGEX = new RegExp(/<[^>]*>/gm);\n\nexport function stripHTML(text) {\n  return (text || '').replace(HTML_REGEX, '');\n}\n\nexport function copyToClipBoard(url) {\n  const el = document.createElement('textarea');\n  el.value = url;\n  el.setAttribute('readonly', '');\n  el.style.position = 'absolute';\n  el.style.left = '-9999px';\n  document.body.appendChild(el);\n  el.select();\n  document.execCommand('copy');\n  document.body.removeChild(el);\n  Alert().alert('Link copied to clip board ^_^', 'success');\n}\n\nexport function childIsString(children) {\n  const isString = typeof children === 'string';\n  const isArray = typeof children === 'object' && children.length;\n  const isTextArray = isArray && children.find(el => typeof el !== 'string');\n  const renderString = !children || !children.$$typeof || isTextArray || isString;\n  return renderString;\n}\n\nexport const getTitle = text => {\n  const headerMatch = /^#+(.*)$/;\n  const lines = text.split('\\n');\n  const noEmptyLines = lines.filter(line => line.length > 0);\n  if (noEmptyLines.length === 0) return {};\n  const firstLine = noEmptyLines[0];\n  const match = firstLine.match(headerMatch);\n  if (match == null) {\n    const limit = 60;\n    if (firstLine.length <= limit) return { titleText: firstLine, isHeading: false };\n    const titleText = firstLine.substr(0, firstLine.lastIndexOf(' ', limit)) + '...';\n    return { titleText, isHeading: false };\n  }\n  const title = match && match[1];\n  return { titleText: title.trim(), isHeading: true };\n};\n"],"file":"text.js"}