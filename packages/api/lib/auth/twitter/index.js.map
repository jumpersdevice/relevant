{"version":3,"sources":["../../../src/auth/twitter/index.js"],"names":["express","require","passport","auth","controller","config","router","Router","get","currentUser","req","res","next","invitecode","query","authenticate","callbackURL","twitter","redirect","failureRedirect","session","setTokenCookieDesktop","post","nativeAuth","module","exports"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,QAAQ,GAAGD,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAME,IAAI,GAAGF,OAAO,mBAApB;;AACA,IAAMG,UAAU,GAAGH,OAAO,cAA1B;;AACA,IAAMI,MAAM,GAAGJ,OAAO,uBAAtB;;AAEA,IAAMK,MAAM,GAAGN,OAAO,CAACO,MAAR,EAAf;AAEAD,MAAM,CAACE,GAAP,CAAW,GAAX,EAAgBL,IAAI,CAACM,WAAL,EAAhB,EAAoC,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AACtDF,EAAAA,GAAG,CAACG,UAAJ,GAAiBH,GAAG,CAACI,KAAJ,CAAUD,UAA3B;AACAX,EAAAA,QAAQ,CAACa,YAAT,CAAsB,SAAtB,EAAiC;AAC/BC,IAAAA,WAAW,YAAKX,MAAM,CAACY,OAAP,CAAeD,WAApB,yBAA8CN,GAAG,CAACI,KAAJ,CAAUD,UAAxD,uBAA+EH,GAAG,CAACI,KAAJ,CAAUI,QAAzF,CADoB;AAE/BC,IAAAA,eAAe,EAAE,aAFc;AAG/BC,IAAAA,OAAO,EAAE;AAHsB,GAAjC,EAIGV,GAJH,EAIQC,GAJR,EAIaC,IAJb;AAKD,CAPD;AASAN,MAAM,CAACE,GAAP,CACE,WADF,EAEEL,IAAI,CAACM,WAAL,EAFF,EAGEP,QAAQ,CAACa,YAAT,CAAsB,SAAtB,EAAiC;AAC/BI,EAAAA,eAAe,EAAE,aADc;AAE/BC,EAAAA,OAAO,EAAE;AAFsB,CAAjC,CAHF,EAOEjB,IAAI,CAACkB,qBAPP;AAUAf,MAAM,CAACgB,IAAP,CAAY,QAAZ,EAAsBnB,IAAI,CAACM,WAAL,EAAtB,EAA0CL,UAAU,CAACmB,UAArD;AAEAC,MAAM,CAACC,OAAP,GAAiBnB,MAAjB","sourcesContent":["const express = require('express');\nconst passport = require('passport');\nconst auth = require('../auth.service');\nconst controller = require('./passport');\nconst config = require('../../config/config');\n\nconst router = express.Router();\n\nrouter.get('/', auth.currentUser(), (req, res, next) => {\n  req.invitecode = req.query.invitecode;\n  passport.authenticate('twitter', {\n    callbackURL: `${config.twitter.callbackURL}?invitecode=${req.query.invitecode}&redirect=${req.query.redirect}`,\n    failureRedirect: '/user/login',\n    session: false\n  })(req, res, next);\n});\n\nrouter.get(\n  '/callback',\n  auth.currentUser(),\n  passport.authenticate('twitter', {\n    failureRedirect: '/user/login',\n    session: false\n  }),\n  auth.setTokenCookieDesktop\n);\n\nrouter.post('/login', auth.currentUser(), controller.nativeAuth);\n\nmodule.exports = router;\n"],"file":"index.js"}