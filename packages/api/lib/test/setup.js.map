{"version":3,"sources":["../../src/test/setup.js"],"names":["path","require","fs","MongoMemoryServer","mongoTestConfigPath","join","__dirname","process","env","WEB","BROWSER","mongod","autoStart","module","exports","isRunning","start","mongoUri","getConnectionString","writeFileSync","JSON","stringify","replace","global","__MONGOD__"],"mappings":";;;;;;AAAA,IAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,IAAMC,EAAE,GAAGD,OAAO,CAAC,IAAD,CAAlB;;AACA,IAAM;AAAEE,EAAAA;AAAF,IAAwBF,OAAO,CAAC,uBAAD,CAArC;;AAEA,IAAMG,mBAAmB,GAAGJ,IAAI,CAACK,IAAL,CAAUC,SAAV,EAAqB,wBAArB,CAA5B;AAEAC,OAAO,CAACC,GAAR,CAAYC,GAAZ,GAAkB,MAAlB;AACA,OAAOF,OAAO,CAACC,GAAR,CAAYE,OAAnB;AAEA,IAAMC,MAAM,GAAG,IAAIR,iBAAJ,CAAsB;AACnCS,EAAAA,SAAS,EAAE;AADwB,CAAtB,CAAf;AAIAC,MAAM,CAACC,OAAP,gDAAiB,aAAY;AAC3B,MAAI,CAACH,MAAM,CAACI,SAAZ,EAAuB;AACrB,UAAMJ,MAAM,CAACK,KAAP,EAAN;AACD;;AAED,MAAMC,QAAQ,SAASN,MAAM,CAACO,mBAAP,EAAvB;AACAhB,EAAAA,EAAE,CAACiB,aAAH,CACEf,mBADF,EAEEgB,IAAI,CAACC,SAAL,CAAe;AAAEJ,IAAAA,QAAQ,EAAEA,QAAQ,CAACK,OAAT,CAAiB,GAAjB,EAAsB,EAAtB;AAAZ,GAAf,CAFF,EAN2B,CAW3B;;AACAC,EAAAA,MAAM,CAACC,UAAP,GAAoBb,MAApB;AACD,CAbD","sourcesContent":["const path = require('path');\nconst fs = require('fs');\nconst { MongoMemoryServer } = require('mongodb-memory-server');\n\nconst mongoTestConfigPath = path.join(__dirname, './mongoTestConfig.json');\n\nprocess.env.WEB = 'true';\ndelete process.env.BROWSER;\n\nconst mongod = new MongoMemoryServer({\n  autoStart: false\n});\n\nmodule.exports = async () => {\n  if (!mongod.isRunning) {\n    await mongod.start();\n  }\n\n  const mongoUri = await mongod.getConnectionString();\n  fs.writeFileSync(\n    mongoTestConfigPath,\n    JSON.stringify({ mongoUri: mongoUri.replace('?', '') })\n  );\n\n  // Set reference to mongod in order to close the server during teardown.\n  global.__MONGOD__ = mongod;\n};\n"],"file":"setup.js"}