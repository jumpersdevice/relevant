{"version":3,"sources":["../../src/utils/cashOut.js"],"names":["logCashOut","user","cashOutAmt","earnings","Earnings","find","_id","status","earned","$gt","totalPreviousPaidout","reduce","getTotalEarnings","cashOutLog","cashOutAttempt","prevBalance","balance","endBalance","legacyAirdrop","referralTokens","airdropTokens","source","save","total","currentVal"],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAeA,UAAf,CAA0BC,IAA1B,EAAgCC,UAAhC,EAA4C;AACjD,QAAMC,QAAQ,GAAG,MAAMC,kBAASC,IAAT,CAAc;AACnCJ,IAAAA,IAAI,EAAEA,IAAI,CAACK,GADwB;AAEnCC,IAAAA,MAAM,EAAE,SAF2B;AAGnCC,IAAAA,MAAM,EAAE;AAAEC,MAAAA,GAAG,EAAE;AAAP;AAH2B,GAAd,CAAvB;AAKA,QAAMC,oBAAoB,GAAGP,QAAQ,CAACQ,MAAT,CAAgBC,gBAAhB,EAAkC,CAAlC,CAA7B;AACA,QAAMC,UAAU,GAAG,IAAIT,iBAAJ,CAAa;AAC9BH,IAAAA,IAAI,EAAEA,IAAI,CAACK,GADmB;AAE9BQ,IAAAA,cAAc,EAAE,IAFc;AAG9BZ,IAAAA,UAH8B;AAI9Ba,IAAAA,WAAW,EAAEd,IAAI,CAACe,OAJY;AAK9BC,IAAAA,UAAU,EAAEhB,IAAI,CAACe,OAAL,GAAed,UALG;AAM9BQ,IAAAA,oBAN8B;AAO9BQ,IAAAA,aAAa,EAAEjB,IAAI,CAACiB,aAPU;AAQ9BC,IAAAA,cAAc,EAAElB,IAAI,CAACkB,cARS;AAS9BC,IAAAA,aAAa,EAAEnB,IAAI,CAACmB,aATU;AAU9Bb,IAAAA,MAAM,EAAE,aAVsB;AAW9Bc,IAAAA,MAAM,EAAE;AAXsB,GAAb,CAAnB;AAaA,QAAMR,UAAU,CAACS,IAAX,EAAN;AACA,SAAOT,UAAP;AACD;;AAEM,SAASD,gBAAT,CAA0BW,KAA1B,EAAiCC,UAAjC,EAA6C;AAClDD,EAAAA,KAAK,IAAIC,UAAU,CAAChB,MAApB;AACA,SAAOe,KAAP;AACD","sourcesContent":["import Earnings from '../api/earnings/earnings.model';\n\nexport async function logCashOut(user, cashOutAmt) {\n  const earnings = await Earnings.find({\n    user: user._id,\n    status: 'paidout',\n    earned: { $gt: 0 }\n  });\n  const totalPreviousPaidout = earnings.reduce(getTotalEarnings, 0);\n  const cashOutLog = new Earnings({\n    user: user._id,\n    cashOutAttempt: true,\n    cashOutAmt,\n    prevBalance: user.balance,\n    endBalance: user.balance - cashOutAmt,\n    totalPreviousPaidout,\n    legacyAirdrop: user.legacyAirdrop,\n    referralTokens: user.referralTokens,\n    airdropTokens: user.airdropTokens,\n    status: 'in progress',\n    source: 'wallet'\n  });\n  await cashOutLog.save();\n  return cashOutLog;\n}\n\nexport function getTotalEarnings(total, currentVal) {\n  total += currentVal.earned;\n  return total;\n}\n"],"file":"cashOut.js"}