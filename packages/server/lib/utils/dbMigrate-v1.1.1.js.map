{"version":3,"sources":["../../src/utils/dbMigrate-v1.1.1.js"],"names":["markDeletedMembers","deletedCom","Community","find","inactive","ids","map","c","_id","CommunityMember","updateMany","communityId","$in","deletedCommunity","new","updateDB","err","console","log"],"mappings":";;;;AAAA;;AACA;;AAEA,eAAeA,kBAAf,GAAoC;AAClC,QAAMC,UAAU,GAAG,MAAMC,mBAAUC,IAAV,CAAe;AAAEC,IAAAA,QAAQ,EAAE;AAAZ,GAAf,EAAmC,KAAnC,CAAzB;AACA,QAAMC,GAAG,GAAGJ,UAAU,CAACK,GAAX,CAAeC,CAAC,IAAIA,CAAC,CAACC,GAAtB,CAAZ;AACA,SAAOC,yBAAgBC,UAAhB,CACL;AAAEC,IAAAA,WAAW,EAAE;AAAEC,MAAAA,GAAG,EAAEP;AAAP;AAAf,GADK,EAEL;AAAEQ,IAAAA,gBAAgB,EAAE;AAApB,GAFK,EAGL;AAAEC,IAAAA,GAAG,EAAE;AAAP,GAHK,CAAP;AAKD;;AAED,eAAeC,QAAf,GAA0B;AACxB,MAAI;AACF,UAAMf,kBAAkB,EAAxB;AACD,GAFD,CAEE,OAAOgB,GAAP,EAAY;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADY,CACM;AACnB;AACF;;AAEDD,QAAQ","sourcesContent":["import CommunityMember from 'server/api/community/community.member.model';\nimport Community from 'server/api/community/community.model';\n\nasync function markDeletedMembers() {\n  const deletedCom = await Community.find({ inactive: true }, '_id');\n  const ids = deletedCom.map(c => c._id);\n  return CommunityMember.updateMany(\n    { communityId: { $in: ids } },\n    { deletedCommunity: true },\n    { new: true }\n  );\n}\n\nasync function updateDB() {\n  try {\n    await markDeletedMembers();\n  } catch (err) {\n    console.log(err); // eslint-disable-line\n  }\n}\n\nupdateDB();\n"],"file":"dbMigrate-v1.1.1.js"}