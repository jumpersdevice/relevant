{"version":3,"sources":["../../src/utils/dbMigrate-v1.1.1.js"],"names":["markDeletedMembers","deletedCom","Community","find","inactive","ids","map","c","_id","CommunityMember","updateMany","communityId","$in","deletedCommunity","new","updateDB","err","console","log"],"mappings":";;;;;;AAAA;;AACA;;SAEeA,kB;;;;;wDAAf,aAAoC;AAClC,QAAMC,UAAU,SAASC,mBAAUC,IAAV,CAAe;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAf,EAAmC,KAAnC,CAAzB;AACA,QAAMC,GAAG,GAAGJ,UAAU,CAACK,GAAX,CAAeC,CAAC,IAAIA,CAAC,CAACC,GAAtB,CAAZ;AACA,WAAOC,yBAAgBC,UAAhB,CACL;AAAEC,MAAAA,WAAW,EAAE;AAAEC,QAAAA,GAAG,EAAEP;AAAP;AAAf,KADK,EAEL;AAAEQ,MAAAA,gBAAgB,EAAE;AAApB,KAFK,EAGL;AAAEC,MAAAA,GAAG,EAAE;AAAP,KAHK,CAAP;AAKD,G;;;;SAEcC,Q;;;;;8CAAf,aAA0B;AACxB,QAAI;AACF,YAAMf,kBAAkB,EAAxB;AACD,KAFD,CAEE,OAAOgB,GAAP,EAAY;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADY,CACM;AACnB;AACF,G;;;;AAEDD,QAAQ","sourcesContent":["import CommunityMember from 'server/api/community/community.member.model';\nimport Community from 'server/api/community/community.model';\n\nasync function markDeletedMembers() {\n  const deletedCom = await Community.find({ inactive: true }, '_id');\n  const ids = deletedCom.map(c => c._id);\n  return CommunityMember.updateMany(\n    { communityId: { $in: ids } },\n    { deletedCommunity: true },\n    { new: true }\n  );\n}\n\nasync function updateDB() {\n  try {\n    await markDeletedMembers();\n  } catch (err) {\n    console.log(err); // eslint-disable-line\n  }\n}\n\nupdateDB();\n"],"file":"dbMigrate-v1.1.1.js"}