{"version":3,"sources":["../src/apollo.client.server.js"],"names":["cache","InMemoryCache","dataIdFromObject","object","_id","resultCaching","authMiddleware","req","headers","token","credentials","authorization","client","ApolloClient","link","SchemaLink","schema","ssrMode"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,MAAMA,KAAK,GAAG,IAAIC,kCAAJ,CAAkB;AAC9BC,EAAAA,gBAAgB,EAAEC,MAAM,IAAIA,MAAM,CAACC,GAAP,IAAc,IADZ;AAE9BC,EAAAA,aAAa,EAAE;AAFe,CAAlB,CAAd;AAKA,MAAMC,cAAc,GAAG,mCAAW,OAAOC,GAAP,EAAY;AAAEC,EAAAA;AAAF,CAAZ,KAA4B;AAC5D,QAAMC,KAAK,GAAG,MAAM,wBAApB;AACA,SAAO;AACLC,IAAAA,WAAW,EAAE,SADR;AAELF,IAAAA,OAAO,EAAE,EACP,GAAGA,OADI;AAEPG,MAAAA,aAAa,EAAEF,KAAK,GAAI,UAASA,KAAM,EAAnB,GAAuB;AAFpC;AAFJ,GAAP;AAOD,CATsB,CAAvB;AAWO,MAAMG,MAAM,GAAG,IAAIC,0BAAJ,CAAiB;AACrCb,EAAAA,KADqC;AAErCc,EAAAA,IAAI,EAAE,wBAAOR,cAAP,EAAuB,IAAIS,4BAAJ,CAAe;AAAEC,IAAAA,MAAM,EAANA;AAAF,GAAf,CAAvB,CAF+B;AAGrCC,EAAAA,OAAO,EAAE;AAH4B,CAAjB,CAAf","sourcesContent":["import { ApolloClient } from 'apollo-client';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport schema from 'server/graphql/schema';\nimport { SchemaLink } from 'apollo-link-schema';\nimport { getToken } from 'app/utils/storage';\nimport { setContext } from 'apollo-link-context';\nimport { concat } from 'apollo-link';\n\nconst cache = new InMemoryCache({\n  dataIdFromObject: object => object._id || null,\n  resultCaching: false\n});\n\nconst authMiddleware = setContext(async (req, { headers }) => {\n  const token = await getToken();\n  return {\n    credentials: 'include',\n    headers: {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n  };\n});\n\nexport const client = new ApolloClient({\n  cache,\n  link: concat(authMiddleware, new SchemaLink({ schema })),\n  ssrMode: true\n});\n"],"file":"apollo.client.server.js"}