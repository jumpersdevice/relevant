{"version":3,"sources":["../../../src/auth/google/passport.js"],"names":["passport","require","GoogleStrategy","OAuth2Strategy","exports","setup","User","config","use","clientID","google","clientSecret","callbackURL","accessToken","refreshToken","profile","done","findOne","id","err","user","name","displayName","email","emails","value","role","username","provider","_json","save","err1"],"mappings":";;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB,C,CACA;;;AACA,IAAMC,cAAc,GAAGD,OAAO,CAAC,uBAAD,CAAP,CAAiCE,cAAxD;;AAEAC,OAAO,CAACC,KAAR,GAAgB,CAACC,IAAD,EAAOC,MAAP,KAAkB;AAChCP,EAAAA,QAAQ,CAACQ,GAAT,CACE,IAAIN,cAAJ,CACE;AACEO,IAAAA,QAAQ,EAAEF,MAAM,CAACG,MAAP,CAAcD,QAD1B;AAEEE,IAAAA,YAAY,EAAEJ,MAAM,CAACG,MAAP,CAAcC,YAF9B;AAGEC,IAAAA,WAAW,EAAEL,MAAM,CAACG,MAAP,CAAcE;AAH7B,GADF,EAME,CAACC,WAAD,EAAcC,YAAd,EAA4BC,OAA5B,EAAqCC,IAArC,KAA8C;AAC5CV,IAAAA,IAAI,CAACW,OAAL,CACE;AACE,mBAAaF,OAAO,CAACG;AADvB,KADF,EAIE,CAACC,GAAD,EAAMC,IAAN,KAAe;AACb,UAAI,CAACA,IAAL,EAAW;AACTA,QAAAA,IAAI,GAAG,IAAId,IAAJ,CAAS;AACde,UAAAA,IAAI,EAAEN,OAAO,CAACO,WADA;AAEdC,UAAAA,KAAK,EAAER,OAAO,CAACS,MAAR,CAAe,CAAf,EAAkBC,KAFX;AAGdC,UAAAA,IAAI,EAAE,MAHQ;AAIdC,UAAAA,QAAQ,EAAEZ,OAAO,CAACY,QAJJ;AAKdC,UAAAA,QAAQ,EAAE,QALI;AAMdlB,UAAAA,MAAM,EAAEK,OAAO,CAACc;AANF,SAAT,CAAP;AAQA,eAAOT,IAAI,CAACU,IAAL,CAAUC,IAAI,IAAI;AACvB,cAAIA,IAAJ,EAAU,OAAOf,IAAI,CAACe,IAAD,CAAX;AACV,iBAAOf,IAAI,CAACe,IAAD,EAAOX,IAAP,CAAX;AACD,SAHM,CAAP;AAID;;AACD,aAAOJ,IAAI,CAACG,GAAD,EAAMC,IAAN,CAAX;AACD,KApBH;AAsBD,GA7BH,CADF;AAiCD,CAlCD","sourcesContent":["const passport = require('passport');\n// eslint-disable-next-line\nconst GoogleStrategy = require('passport-google-oauth').OAuth2Strategy;\n\nexports.setup = (User, config) => {\n  passport.use(\n    new GoogleStrategy(\n      {\n        clientID: config.google.clientID,\n        clientSecret: config.google.clientSecret,\n        callbackURL: config.google.callbackURL\n      },\n      (accessToken, refreshToken, profile, done) => {\n        User.findOne(\n          {\n            'google.id': profile.id\n          },\n          (err, user) => {\n            if (!user) {\n              user = new User({\n                name: profile.displayName,\n                email: profile.emails[0].value,\n                role: 'user',\n                username: profile.username,\n                provider: 'google',\n                google: profile._json\n              });\n              return user.save(err1 => {\n                if (err1) return done(err1);\n                return done(err1, user);\n              });\n            }\n            return done(err, user);\n          }\n        );\n      }\n    )\n  );\n};\n"],"file":"passport.js"}