{"version":3,"sources":["../../src/test/seedData.js"],"names":["userInstances","communityInstances","postInstances","getUsers","getPosts","getCommunities","setupTestData","setupCommunities","setupUsers","setupMembers","setupPosts","setupVotes","link1","Post","linkPost1","save","addPostData","altCommunity","insertIntoFeed","communityId","link2","linkPost2","link3","linkPost3","link4","linkPost4","link5","linkPost5","post1","link","postI1","addToFeed","map","p","upsertMetaPost","undefined","toObject","Promise","all","users","allUsers","_user","relevance","user","User","alice","find","u","handle","bob","carol","communities","allCommunities","_community","community","Community","relevant","c","slug","crypto","join","_id","votes","Invest","investor","author","amount","ownPost","v"],"mappings":"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","sourcesContent":["import Post from 'server/api/post/post.model'; // eslint-disable-line\nimport PostData from 'server/api/post/postData.model'; // eslint-disable-line\nimport CommunityMember from 'server/api/community/community.member.model'; // eslint-disable-line\nimport Earnings from 'server/api/earnings/earnings.model'; // eslint-disable-line\nimport CommunityFeed from 'server/api/communityFeed/communityFeed.model'; // eslint-disable-line\nimport Treasury from 'server/api/treasury/treasury.model'; // eslint-disable-line\nimport Link from 'server/api/post/link.model'; // eslint-disable-line\n\nimport Invest from 'server/api/invest/invest.model';\nimport Community from 'server/api/community/community.model';\nimport User from 'server/api/user/user.model';\n\nimport {\n  post1,\n  linkPost1,\n  linkPost2,\n  linkPost3,\n  linkPost4,\n  linkPost5\n} from 'app/mockdata/post';\nimport { allUsers } from 'app/mockdata/user';\nimport { allCommunities } from 'app/mockdata/community';\n\nlet userInstances = {};\nlet communityInstances = {};\nlet postInstances = {};\n\nexport function getUsers() {\n  return userInstances;\n}\nexport function getPosts() {\n  return postInstances;\n}\nexport function getCommunities() {\n  return communityInstances;\n}\n\nexport async function setupTestData() {\n  await setupCommunities();\n  await setupUsers();\n  await setupMembers();\n  await setupPosts();\n  await setupVotes();\n}\n\nasync function setupPosts() {\n  let link1 = new Post(linkPost1);\n  await link1.save();\n  link1 = await link1.addPostData();\n\n  // cross-post link1 to crypto community\n  await link1.addPostData({ ...linkPost1, ...linkPost1.altCommunity });\n  link1.insertIntoFeed(linkPost1.communityId);\n\n  let link2 = new Post(linkPost2);\n  await link2.save();\n  link2 = await link2.addPostData();\n\n  let link3 = new Post(linkPost3);\n  await link3.save();\n  link3 = await link3.addPostData();\n\n  let link4 = new Post(linkPost4);\n  await link4.save();\n  link4 = await link4.addPostData();\n\n  let link5 = new Post(linkPost5);\n  await link5.save();\n  link5 = await link5.addPostData();\n\n  delete post1.link;\n  let postI1 = new Post(post1);\n  await postI1.save();\n  postI1 = await postI1.addPostData();\n\n  const addToFeed = [link1, link2, link3, link4, link5].map(async p => {\n    await p.upsertMetaPost(undefined, p.toObject());\n    return p.insertIntoFeed(p.communityId);\n  });\n\n  await Promise.all(addToFeed);\n\n  postInstances = { postI1, link1, link2, link3, link4, link5 };\n}\n\nasync function setupUsers() {\n  let users = allUsers.map(async _user => {\n    delete _user.relevance;\n    const user = new User(_user);\n    return user.save();\n  });\n  users = await Promise.all(users);\n  const alice = users.find(u => u.handle === 'alice');\n  const bob = users.find(u => u.handle === 'bob');\n  const carol = users.find(u => u.handle === 'carol');\n  return (userInstances = { alice, bob, carol });\n}\n\nasync function setupCommunities() {\n  let communities = allCommunities.map(async _community => {\n    const community = new Community(_community);\n    return community.save();\n  });\n  communities = await Promise.all(communities);\n  const relevant = communities.find(c => c.slug === 'relevant');\n  const crypto = communities.find(c => c.slug === 'crypto');\n  return (communityInstances = { relevant, crypto });\n}\n\nasync function setupMembers() {\n  const { relevant, crypto } = communityInstances;\n  const { alice, bob, carol } = userInstances;\n\n  await relevant.join(alice._id, 'admin');\n  await relevant.join(bob._id);\n  await relevant.join(carol._id);\n\n  await crypto.join(alice._id, 'admin');\n  await crypto.join(bob._id);\n}\n\nexport async function setupVotes() {\n  const { relevant, crypto } = communityInstances;\n  const { alice, bob, carol } = userInstances;\n  const votes = [];\n  votes[0] = new Invest({\n    investor: alice._id,\n    author: bob._id,\n    amount: 1,\n    ownPost: false,\n    communityId: relevant._id,\n    community: relevant.slug\n  });\n\n  votes[1] = new Invest({\n    investor: alice._id,\n    author: bob._id,\n    amount: 1,\n    ownPost: false,\n    communityId: crypto._id,\n    community: crypto.slug\n  });\n\n  votes[2] = new Invest({\n    investor: alice._id,\n    author: carol._id,\n    amount: 1,\n    ownPost: false,\n    communityId: relevant._id,\n    community: relevant.slug\n  });\n\n  votes[3] = new Invest({\n    investor: alice._id,\n    author: bob._id,\n    amount: 1,\n    ownPost: false,\n    communityId: crypto._id,\n    community: crypto.slug\n  });\n\n  return Promise.all(votes.map(v => v.save()));\n}\n"],"file":"seedData.js"}